<!DOCTYPE html>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Ch.7: Introduction to classes">

<title>Ch.7: Introduction to classes</title>







<!-- reveal.js: http://lab.hakim.se/reveal-js/ -->

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">
<!--
<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/beigesmall.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/solarized.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/serif.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/moon.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/sky.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/darkgray.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/cbc.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simula.css" id="theme">
-->

<!-- For syntax highlighting -->
<link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

<!-- If the query includes 'print-pdf', use the PDF print sheet -->
<script>
document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
</script>

<style type="text/css">
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .reveal .alert-text-small   { font-size: 80%;  }
    .reveal .alert-text-large   { font-size: 130%; }
    .reveal .alert-text-normal  { font-size: 90%;  }
    .reveal .alert {
             padding:8px 35px 8px 14px; margin-bottom:18px;
             text-shadow:0 1px 0 rgba(255,255,255,0.5);
             border:5px solid #bababa;
             -webkit-border-radius: 14px; -moz-border-radius: 14px;
             border-radius:14px
             background-position: 10px 10px;
             background-repeat: no-repeat;
             background-size: 38px;
             padding-left: 30px; /* 55px; if icon */
     }
     .reveal .alert-block {padding-top:14px; padding-bottom:14px}
     .reveal .alert-block > p, .alert-block > ul {margin-bottom:1em}
     /*.reveal .alert li {margin-top: 1em}*/
     .reveal .alert-block p+p {margin-top:5px}
     /*.reveal .alert-notice { background-image: url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_notice.png); }
     .reveal .alert-summary  { background-image:url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_summary.png); }
     .reveal .alert-warning { background-image: url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_warning.png); }
     .reveal .alert-question {background-image:url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_question.png); } */

</style>



<!-- Styles for table layout of slides -->
<style type="text/css">
td.padding {
  padding-top:20px;
  padding-bottom:20px;
  padding-right:50px;
  padding-left:50px;
}
</style>

</head>

<body>
<div class="reveal">

<!-- Any section element inside the <div class="slides"> container
     is displayed as a slide -->

<div class="slides">





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    



<section>
<!-- ------------------- main content ---------------------- -->



<center><h1 style="text-align: center;">Ch.7: Introduction to classes</h1></center>  <!-- document title -->

<p>
<!-- author(s): Hans Petter Langtangen -->

<center>
<b>Hans Petter Langtangen</b> [1, 2]
</center>

<p>&nbsp;<br>
<!-- institution(s) -->

<center>[1] <b>Simula Research Laboratory</b></center>
<center>[2] <b>University of Oslo, Dept. of Informatics</b></center>
<br>
<p>&nbsp;<br>
<center><h4>Aug 15, 2015</h4></center> <!-- date -->
<br>
</section>


<section>
<h1 id="___sec0">Basics of classes </h1>

<p>

<table border="0">
<tr>
<td class="padding">
<center><p><img src="fig-class/associations/classes1.jpg" align="bottom" width=500></p></center>
</td>
<td class="padding">
<center><p><img src="fig-class/associations/classes2.png" align="bottom" width=500></p></center>
</td>
</tr>
</table>
</section>


<section>
<h2 id="___sec1">Class = functions + data (variables) in one unit </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> A class packs together data (a collection of variables) and functions as <em>one single unit</em></li>

<p><li> As a programmer you can create a new class and thereby a new object type (like <code>float</code>, <code>list</code>, <code>file</code>, ...)</li>

<p><li> A class is much like a module: a collection of &quot;global&quot; variables and functions that belong together</li>

<p><li> There is only one instance of a module while a class can have many instances (copies)</li>

<p><li> Modern programming applies classes to a large extent</li>

<p><li> It will take some time to master the class concept</li>

<p><li> Let's learn by doing!</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec2">Representing a function by a class; background </h2>

<p>
Consider a function of \( t \) with a parameter \( v_0 \):

<p>&nbsp;<br>
$$ y(t; v_0)=v_0t - {1\over2}gt^2$$
<p>&nbsp;<br>

<p>
We need both \( v_0 \) and \( t \) to evaluate \( y \) (and \( g=9.81 \)), but
how should we implement this?

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Having \( t \) and \( v_0 \) as arguments:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">y</span>(t, v0):
    g <span style="color: #666666">=</span> <span style="color: #666666">9.81</span>
    <span style="color: #008000; font-weight: bold">return</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">-</span> <span style="color: #666666">0.5*</span>g<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>
</pre></div>

</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Having \( t \) as argument and \( v_0 \) as global variable:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">y</span>(t):
    g <span style="color: #666666">=</span> <span style="color: #666666">9.81</span>
    <span style="color: #008000; font-weight: bold">return</span> v0<span style="color: #666666">*</span>t <span style="color: #666666">-</span> <span style="color: #666666">0.5*</span>g<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>
</pre></div>
<p>
Motivation: \( y(t) \) is a function of \( t \) only
</div>

<p>
<!-- Because \( y(t) \) is a function of \( t \) only. With a class, with -->
<!-- have a function \( y(t) \) of \( t \) only, but it also contains the value of \( v_0 \). -->
</section>


<section>
<h2 id="___sec3">Representing a function by a class; idea </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>
 <p><li> With a class, <code>y(t)</code> can be a function of <code>t</code> only, but still have</li>
</ul>
<p>

  <code>v0</code> and <code>g</code> as parameters with given values.

<ul>
 <p><li> The class packs together a function <code>y(t)</code> and data (<code>v0</code>, <code>g</code>)</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec4">Representing a function by a class; technical overview </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> We make a class <code>Y</code> for \( y(t;v_0) \) with variables <code>v0</code> and <code>g</code>
    and a function <code>value(t)</code> for computing \( y(t;v_0) \)</li>

<p><li> Any class should also have a function <code>__init__</code> for initialization of the variables</li>
</ul>
</div>

<p>
<center><p><img src="fig-class/UML_class_Y.png" align="bottom" width=120></p></center>
</section>


<section>
<h2 id="___sec5">Representing a function by a class; the code </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Y</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, v0):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>v0 <span style="color: #666666">=</span> v0
        <span style="color: #008000">self</span><span style="color: #666666">.</span>g <span style="color: #666666">=</span> <span style="color: #666666">9.81</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">value</span>(<span style="color: #008000">self</span>, t):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>v0<span style="color: #666666">*</span>t <span style="color: #666666">-</span> <span style="color: #666666">0.5*</span><span style="color: #008000">self</span><span style="color: #666666">.</span>g<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>
</pre></div>
<p>
Usage:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">y <span style="color: #666666">=</span> Y(v0<span style="color: #666666">=3</span>)            <span style="color: #408080; font-style: italic"># create instance (object)</span>
v <span style="color: #666666">=</span> y<span style="color: #666666">.</span>value(<span style="color: #666666">0.1</span>)       <span style="color: #408080; font-style: italic"># compute function value</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec6">Representing a function by a class; the constructor </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
When we write

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">y <span style="color: #666666">=</span> Y(v0<span style="color: #666666">=3</span>)
</pre></div>
<p>
we create a new variable (instance) <code>y</code> of type <code>Y</code>.
<code>Y(3)</code> is a call to the <em>constructor</em>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, v0):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>v0 <span style="color: #666666">=</span> v0
        <span style="color: #008000">self</span><span style="color: #666666">.</span>g <span style="color: #666666">=</span> <span style="color: #666666">9.81</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec7">What is this <code>self</code> variable? Stay cool - it will be understood later as you get used to it </h2>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b></b>
<ul>
 <p><li class="fragment"> Think of <code>self</code> as <code>y</code>, i.e., the new variable to be created. <code>self.v0 = ...</code> means that we attach a variable <code>v0</code> to <code>self</code> (<code>y</code>).</li>
 <p><li class="fragment"> <code>Y(3)</code> means <code>Y.__init__(y, 3)</code>, i.e., set <code>self=y</code>, <code>v0=3</code></li>
 <p><li class="fragment"> Remember: <code>self</code> is always first parameter in a function, but never inserted in the call!</li>
 <p><li class="fragment"> After <code>y = Y(3)</code>, <code>y</code> has two variables <code>v0</code> and <code>g</code></li>
</ul>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="fragment" class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">print</span> y<span style="color: #666666">.</span>v0
<span style="color: #008000; font-weight: bold">print</span> y<span style="color: #666666">.</span>g
</pre></div>

</div>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<blockquote>
    <em>In mathematics you
    don't understand things. You just get used to them.</em>
    John von Neumann, mathematician, 1903-1957.
</blockquote>
</div>
</section>


<section>
<h2 id="___sec8">Representing a function by a class; the value method </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> Functions in classes are called <em>methods</em></li>

<p><li> Variables in classes are called <em>attributes</em></li>
</ul>
<p>

Here is the <code>value</code> method:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">value</span>(<span style="color: #008000">self</span>, t):
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>v0<span style="color: #666666">*</span>t <span style="color: #666666">-</span> <span style="color: #666666">0.5*</span><span style="color: #008000">self</span><span style="color: #666666">.</span>g<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>
</pre></div>
<p>
Example on a call:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">v <span style="color: #666666">=</span> y<span style="color: #666666">.</span>value(t<span style="color: #666666">=0.1</span>)
</pre></div>
<p>
<code>self</code> is left out in the call, but Python automatically inserts <code>y</code> as the <code>self</code> argument inside the <code>value</code> method. Think of the call as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">Y<span style="color: #666666">.</span>value(y, t<span style="color: #666666">=0.1</span>)
</pre></div>
<p>
Inside <code>value</code> things &quot;appear&quot; as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">return</span> y<span style="color: #666666">.</span>v0<span style="color: #666666">*</span>t <span style="color: #666666">-</span> <span style="color: #666666">0.5*</span>y<span style="color: #666666">.</span>g<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>
</pre></div>
<p>
<code>self</code> gives access to &quot;global variables&quot; in the class object.
</div>
</section>


<section>
<h2 id="___sec9">Representing a function by a class; summary </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> Class <code>Y</code> collects the attributes <code>v0</code> and <code>g</code> and the method <code>value</code> as one unit</li>

<p><li> <code>value(t)</code> is function of <code>t</code> only, but has automatically access to the parameters <code>v0</code> and <code>g</code> as <code>self.v0</code> and <code>self.g</code></li>

<p><li> The great advantage: we can send <code>y.value</code> as an ordinary function of <code>t</code> to any other function that expects a function <code>f(t)</code> of one variable</li>
</ul>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">make_table</span>(f, tstop, n):
    <span style="color: #008000; font-weight: bold">for</span> t <span style="color: #AA22FF; font-weight: bold">in</span> linspace(<span style="color: #666666">0</span>, tstop, n):
        <span style="color: #008000; font-weight: bold">print</span> t, f(t)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">g</span>(t):
    <span style="color: #008000; font-weight: bold">return</span> sin(t)<span style="color: #666666">*</span>exp(<span style="color: #666666">-</span>t)

table(g, <span style="color: #666666">2*</span>pi, <span style="color: #666666">101</span>)         <span style="color: #408080; font-style: italic"># send ordinary function</span>

y <span style="color: #666666">=</span> Y(<span style="color: #666666">6.5</span>)
table(y<span style="color: #666666">.</span>value, <span style="color: #666666">2*</span>pi, <span style="color: #666666">101</span>)   <span style="color: #408080; font-style: italic"># send class method</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec10">Representing a function by a class; the general case </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Given a function with \( n+1 \) parameters and one independent variable,

<p>&nbsp;<br>
$$ f(x; p_0,\ldots,p_n)$$
<p>&nbsp;<br>

it is wise to represent <code>f</code> by a class where
\( p_0,\ldots,p_n \) are attributes and where there is a method, say <code>value(self, x)</code>, for computing \( f(x) \)
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">MyFunc</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, p0, p1, p2, <span style="color: #666666">...</span>, pn):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>p0 <span style="color: #666666">=</span> p0
        <span style="color: #008000">self</span><span style="color: #666666">.</span>p1 <span style="color: #666666">=</span> p1
        <span style="color: #666666">...</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>pn <span style="color: #666666">=</span> pn

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">value</span>(<span style="color: #008000">self</span>, x):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">...</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec11">Class for a function with four parameters </h2>

<p>&nbsp;<br>
$$
v(r; \beta, \mu_0, n, R) = \left({\beta\over 2\mu_0}\right)^{{1\over n}}
{n \over n+1}\left( R^{1 + {1\over n}} - r^{1 + {1\over n}}\right)
$$
<p>&nbsp;<br>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">VelocityProfile</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, beta, mu0, n, R):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>beta, <span style="color: #008000">self</span><span style="color: #666666">.</span>mu0, <span style="color: #008000">self</span><span style="color: #666666">.</span>n, <span style="color: #008000">self</span><span style="color: #666666">.</span>R <span style="color: #666666">=</span> \
        beta, mu0, n, R

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">value</span>(<span style="color: #008000">self</span>, r):
        beta, mu0, n, R <span style="color: #666666">=</span> \
        <span style="color: #008000">self</span><span style="color: #666666">.</span>beta, <span style="color: #008000">self</span><span style="color: #666666">.</span>mu0, <span style="color: #008000">self</span><span style="color: #666666">.</span>n, <span style="color: #008000">self</span><span style="color: #666666">.</span>R
        n <span style="color: #666666">=</span> <span style="color: #008000">float</span>(n)  <span style="color: #408080; font-style: italic"># ensure float divisions</span>
        v <span style="color: #666666">=</span> (beta<span style="color: #666666">/</span>(<span style="color: #666666">2.0*</span>mu0))<span style="color: #666666">**</span>(<span style="color: #666666">1/</span>n)<span style="color: #666666">*</span>(n<span style="color: #666666">/</span>(n<span style="color: #666666">+1</span>))<span style="color: #666666">*</span>\
            (R<span style="color: #666666">**</span>(<span style="color: #666666">1+1/</span>n) <span style="color: #666666">-</span> r<span style="color: #666666">**</span>(<span style="color: #666666">1+1/</span>n))
        <span style="color: #008000; font-weight: bold">return</span> v

v <span style="color: #666666">=</span> VelocityProfile(R<span style="color: #666666">=1</span>, beta<span style="color: #666666">=0.06</span>, mu0<span style="color: #666666">=0.02</span>, n<span style="color: #666666">=0.1</span>)
<span style="color: #008000; font-weight: bold">print</span> v<span style="color: #666666">.</span>value(r<span style="color: #666666">=0.1</span>)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec12">Rough sketch of a general Python class </h2>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="fragment" class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">MyClass</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, p1, p2):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>attr1 <span style="color: #666666">=</span> p1
        <span style="color: #008000">self</span><span style="color: #666666">.</span>attr2 <span style="color: #666666">=</span> p2

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">method1</span>(<span style="color: #008000">self</span>, arg):
        <span style="color: #408080; font-style: italic"># can init new attribute outside constructor:</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>attr3 <span style="color: #666666">=</span> arg
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>attr1 <span style="color: #666666">+</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>attr2 <span style="color: #666666">+</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>attr3

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">method2</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;Hello!&#39;</span>

m <span style="color: #666666">=</span> MyClass(<span style="color: #666666">4</span>, <span style="color: #666666">10</span>)
<span style="color: #008000; font-weight: bold">print</span> m<span style="color: #666666">.</span>method1(<span style="color: #666666">-2</span>)
m<span style="color: #666666">.</span>method2()
</pre></div>

</div>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b></b>
<p>
It is common to have a constructor where attributes are initialized, but this is not a requirement - attributes can be defined whenever desired
</div>
</section>


<section>
<h2 id="___sec13">You can learn about other versions and views of class Y in the course book </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> The book features a section on a different version of class <code>Y</code> where there is no constructor (which is possible)</li>

<p><li> The book also features a section on how to implement classes without using classes</li>

<p><li> These sections may be clarifying - or confusing</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec14">But what is this self variable? I want to know now! </h2>

<p>
<div class="alert alert-block alert-warning alert-text-normal">
<b>Warning.</b>
<p>
You have two choices:

<ol>
<p><li> follow the detailed explanations of what <code>self </code> really is</li>
<p><li> postpone understanding <code>self</code> until you have much more
   experience with class programming (suddenly <code>self</code> becomes clear!)</li>
</ol>
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The syntax

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">y <span style="color: #666666">=</span> Y(<span style="color: #666666">3</span>)
</pre></div>
<p>
can be thought of as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">Y<span style="color: #666666">.</span>__init__(y, <span style="color: #666666">3</span>)   <span style="color: #408080; font-style: italic"># class prefix Y. is like a module prefix</span>
</pre></div>
<p>
Then

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000">self</span><span style="color: #666666">.</span>v0 <span style="color: #666666">=</span> v0
</pre></div>
<p>
is actually

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">y<span style="color: #666666">.</span>v0 <span style="color: #666666">=</span> <span style="color: #666666">3</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec15">How <code>self</code> works in the <code>value</code> method </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">v <span style="color: #666666">=</span> y<span style="color: #666666">.</span>value(<span style="color: #666666">2</span>)
</pre></div>
<p>
can alternatively be written as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">v <span style="color: #666666">=</span> Y<span style="color: #666666">.</span>value(y, <span style="color: #666666">2</span>)
</pre></div>
<p>
So, when we do <code>instance.method(arg1, arg2)</code>, <code>self</code> becomes
<code>instance</code> inside <code>method</code>.
</div>
</section>


<section>
<h2 id="___sec16">Working with multiple instances may help explain <code>self</code> </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<code>id(obj)</code>: print unique Python identifier of an object

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">SelfExplorer</span>:
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Class for computing a*x.&quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, a):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>a <span style="color: #666666">=</span> a
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;init: a=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">, id(self)=</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (<span style="color: #008000">self</span><span style="color: #666666">.</span>a, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>))

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">value</span>(<span style="color: #008000">self</span>, x):
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;value: a=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">, id(self)=</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (<span style="color: #008000">self</span><span style="color: #666666">.</span>a, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>))
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>a<span style="color: #666666">*</span>x
</pre></div>

</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> s1 <span style="color: #666666">=</span> SelfExplorer(<span style="color: #666666">1</span>)
init: a<span style="color: #666666">=1</span>, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>)<span style="color: #666666">=38085696</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">id</span>(s1)
<span style="color: #666666">38085696</span>

<span style="color: #666666">&gt;&gt;&gt;</span> s2 <span style="color: #666666">=</span> SelfExplorer(<span style="color: #666666">2</span>)
init: a<span style="color: #666666">=2</span>, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>)<span style="color: #666666">=38085192</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">id</span>(s2)
<span style="color: #666666">38085192</span>

<span style="color: #666666">&gt;&gt;&gt;</span> s1<span style="color: #666666">.</span>value(<span style="color: #666666">4</span>)
value: a<span style="color: #666666">=1</span>, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>)<span style="color: #666666">=38085696</span>
<span style="color: #666666">4</span>
<span style="color: #666666">&gt;&gt;&gt;</span> SelfExplorer<span style="color: #666666">.</span>value(s1, <span style="color: #666666">4</span>)
value: a<span style="color: #666666">=1</span>, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>)<span style="color: #666666">=38085696</span>
<span style="color: #666666">4</span>

<span style="color: #666666">&gt;&gt;&gt;</span> s2<span style="color: #666666">.</span>value(<span style="color: #666666">5</span>)
value: a<span style="color: #666666">=2</span>, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>)<span style="color: #666666">=38085192</span>
<span style="color: #666666">10</span>
<span style="color: #666666">&gt;&gt;&gt;</span> SelfExplorer<span style="color: #666666">.</span>value(s2, <span style="color: #666666">5</span>)
value: a<span style="color: #666666">=2</span>, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>)<span style="color: #666666">=38085192</span>
<span style="color: #666666">10</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec17">But what is this self variable? I want to know now! </h2>

<p>
<div class="alert alert-block alert-warning alert-text-normal">
<b>Warning.</b>
<p>
You have two choices:

<ol>
<p><li> follow the detailed explanations of what <code>self </code> really is</li>
<p><li> postpone understanding <code>self</code> until you have much more
   experience with class programming (suddenly <code>self</code> becomes clear!)</li>
</ol>
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The syntax

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">y <span style="color: #666666">=</span> Y(<span style="color: #666666">3</span>)
</pre></div>
<p>
can be thought of as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">Y<span style="color: #666666">.</span>__init__(y, <span style="color: #666666">3</span>)   <span style="color: #408080; font-style: italic"># class prefix Y. is like a module prefix</span>
</pre></div>
<p>
Then

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000">self</span><span style="color: #666666">.</span>v0 <span style="color: #666666">=</span> v0
</pre></div>
<p>
is actually

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">y<span style="color: #666666">.</span>v0 <span style="color: #666666">=</span> <span style="color: #666666">3</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec18">How <code>self</code> works in the <code>value</code> method </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">v <span style="color: #666666">=</span> y<span style="color: #666666">.</span>value(<span style="color: #666666">2</span>)
</pre></div>
<p>
can alternatively be written as

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">v <span style="color: #666666">=</span> Y<span style="color: #666666">.</span>value(y, <span style="color: #666666">2</span>)
</pre></div>
<p>
So, when we do <code>instance.method(arg1, arg2)</code>, <code>self</code> becomes
<code>instance</code> inside <code>method</code>.
</div>
</section>


<section>
<h2 id="___sec19">Working with multiple instances may help explain <code>self</code> </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<code>id(obj)</code>: print unique Python identifier of an object

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">SelfExplorer</span>:
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Class for computing a*x.&quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, a):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>a <span style="color: #666666">=</span> a
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;init: a=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">, id(self)=</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (<span style="color: #008000">self</span><span style="color: #666666">.</span>a, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>))

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">value</span>(<span style="color: #008000">self</span>, x):
        <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;value: a=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">, id(self)=</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (<span style="color: #008000">self</span><span style="color: #666666">.</span>a, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>))
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>a<span style="color: #666666">*</span>x
</pre></div>

</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> s1 <span style="color: #666666">=</span> SelfExplorer(<span style="color: #666666">1</span>)
init: a<span style="color: #666666">=1</span>, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>)<span style="color: #666666">=38085696</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">id</span>(s1)
<span style="color: #666666">38085696</span>

<span style="color: #666666">&gt;&gt;&gt;</span> s2 <span style="color: #666666">=</span> SelfExplorer(<span style="color: #666666">2</span>)
init: a<span style="color: #666666">=2</span>, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>)<span style="color: #666666">=38085192</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">id</span>(s2)
<span style="color: #666666">38085192</span>

<span style="color: #666666">&gt;&gt;&gt;</span> s1<span style="color: #666666">.</span>value(<span style="color: #666666">4</span>)
value: a<span style="color: #666666">=1</span>, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>)<span style="color: #666666">=38085696</span>
<span style="color: #666666">4</span>
<span style="color: #666666">&gt;&gt;&gt;</span> SelfExplorer<span style="color: #666666">.</span>value(s1, <span style="color: #666666">4</span>)
value: a<span style="color: #666666">=1</span>, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>)<span style="color: #666666">=38085696</span>
<span style="color: #666666">4</span>

<span style="color: #666666">&gt;&gt;&gt;</span> s2<span style="color: #666666">.</span>value(<span style="color: #666666">5</span>)
value: a<span style="color: #666666">=2</span>, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>)<span style="color: #666666">=38085192</span>
<span style="color: #666666">10</span>
<span style="color: #666666">&gt;&gt;&gt;</span> SelfExplorer<span style="color: #666666">.</span>value(s2, <span style="color: #666666">5</span>)
value: a<span style="color: #666666">=2</span>, <span style="color: #008000">id</span>(<span style="color: #008000">self</span>)<span style="color: #666666">=38085192</span>
<span style="color: #666666">10</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec20">Another class example: a bank account </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> Attributes: name of owner, account number, balance</li>

<p><li> Methods: deposit, withdraw, pretty print</li>
</ul>
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Account</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, name, account_number, initial_amount):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>name <span style="color: #666666">=</span> name
        <span style="color: #008000">self</span><span style="color: #666666">.</span>no <span style="color: #666666">=</span> account_number
        <span style="color: #008000">self</span><span style="color: #666666">.</span>balance <span style="color: #666666">=</span> initial_amount

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">deposit</span>(<span style="color: #008000">self</span>, amount):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>balance <span style="color: #666666">+=</span> amount

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">withdraw</span>(<span style="color: #008000">self</span>, amount):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>balance <span style="color: #666666">-=</span> amount

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">dump</span>(<span style="color: #008000">self</span>):
        s <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">, </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">, balance: </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> \
            (<span style="color: #008000">self</span><span style="color: #666666">.</span>name, <span style="color: #008000">self</span><span style="color: #666666">.</span>no, <span style="color: #008000">self</span><span style="color: #666666">.</span>balance)
        <span style="color: #008000; font-weight: bold">print</span> s
</pre></div>

</div>
</section>


<section>
<h2 id="___sec21">UML diagram of class Account </h2>

<p>
<center><p><img src="fig-class/UML_class_Account.png" align="bottom" width=120></p></center>
</section>


<section>
<h2 id="___sec22">Example on using class Account </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> a1 <span style="color: #666666">=</span> Account(<span style="color: #BA2121">&#39;John Olsson&#39;</span>, <span style="color: #BA2121">&#39;19371554951&#39;</span>, <span style="color: #666666">20000</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> a2 <span style="color: #666666">=</span> Account(<span style="color: #BA2121">&#39;Liz Olsson&#39;</span>,  <span style="color: #BA2121">&#39;19371564761&#39;</span>, <span style="color: #666666">20000</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> a1<span style="color: #666666">.</span>deposit(<span style="color: #666666">1000</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> a1<span style="color: #666666">.</span>withdraw(<span style="color: #666666">4000</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> a2<span style="color: #666666">.</span>withdraw(<span style="color: #666666">10500</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> a1<span style="color: #666666">.</span>withdraw(<span style="color: #666666">3500</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;a1&#39;s balance:&quot;</span>, a1<span style="color: #666666">.</span>balance
a1<span style="color: #BA2121">&#39;s balance: 13500</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a1<span style="color: #666666">.</span>dump()
John Olsson, <span style="color: #666666">19371554951</span>, balance: <span style="color: #666666">13500</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a2<span style="color: #666666">.</span>dump()
Liz Olsson, <span style="color: #666666">19371564761</span>, balance: <span style="color: #666666">9500</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec23">Use underscore in attribute names to avoid misuse </h2>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b>Possible, but not intended use:</b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="fragment" class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> a1<span style="color: #666666">.</span>name <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;Some other name&#39;</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a1<span style="color: #666666">.</span>balance <span style="color: #666666">=</span> <span style="color: #666666">100000</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a1<span style="color: #666666">.</span>no <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;19371564768&#39;</span>
</pre></div>

</div>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b>The assumptions on correct usage:</b>
<ul>

<p><li class="fragment"> The attributes should <em>not</em> be changed!</li>

<p><li class="fragment"> The <code>balance</code> attribute can be viewed</li>

<p><li class="fragment"> Changing <code>balance</code> is done through <code>withdraw</code> or <code>deposit</code></li>
</ul>
</div>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b>Remedy:</b>
<p>
Attributes and methods not intended for use outside the class can be marked as <em>protected</em> by prefixing the name with an underscore (e.g., <code>_name</code>). This is just a convention - and no technical way of avoiding attributes and methods to be accessed.
</div>
</section>


<section>
<h2 id="___sec24">Improved class with attribute protection (underscore) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">AccountP</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, name, account_number, initial_amount):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_name <span style="color: #666666">=</span> name
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_no <span style="color: #666666">=</span> account_number
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_balance <span style="color: #666666">=</span> initial_amount

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">deposit</span>(<span style="color: #008000">self</span>, amount):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_balance <span style="color: #666666">+=</span> amount

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">withdraw</span>(<span style="color: #008000">self</span>, amount):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>_balance <span style="color: #666666">-=</span> amount

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">get_balance</span>(<span style="color: #008000">self</span>):    <span style="color: #408080; font-style: italic"># NEW - read balance value</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>_balance

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">dump</span>(<span style="color: #008000">self</span>):
        s <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">, </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">, balance: </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> \
            (<span style="color: #008000">self</span><span style="color: #666666">.</span>_name, <span style="color: #008000">self</span><span style="color: #666666">.</span>_no, <span style="color: #008000">self</span><span style="color: #666666">.</span>_balance)
        <span style="color: #008000; font-weight: bold">print</span> s
</pre></div>

</div>
</section>


<section>
<h2 id="___sec25">Usage of improved class AccountP </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">a1 <span style="color: #666666">=</span> AccountP(<span style="color: #BA2121">&#39;John Olsson&#39;</span>, <span style="color: #BA2121">&#39;19371554951&#39;</span>, <span style="color: #666666">20000</span>)
a1<span style="color: #666666">.</span>withdraw(<span style="color: #666666">4000</span>)

<span style="color: #008000; font-weight: bold">print</span> a1<span style="color: #666666">.</span>_balance      <span style="color: #408080; font-style: italic"># it works, but a convention is broken</span>

<span style="color: #008000; font-weight: bold">print</span> a1<span style="color: #666666">.</span>get_balance() <span style="color: #408080; font-style: italic"># correct way of viewing the balance</span>

a1<span style="color: #666666">.</span>_no <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;19371554955&#39;</span> <span style="color: #408080; font-style: italic"># this is a &quot;serious crime&quot;!</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec26">Another example: a phone book </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> A phone book is a list of data about persons</li>

<p><li> Data about a person: name, mobile phone, office phone, private phone, email</li>

<p><li> Let us create a class for data about a person!</li>

<p><li> Methods:</li>

<ul>

<p><li> Constructor for initializing name, plus one or more other data</li>

<p><li> Add new mobile number</li>

<p><li> Add new office number</li>

<p><li> Add new private number</li>

<p><li> Add new email</li>

<p><li> Write out person data</li>
</ul>
<p>
</ul>
</div>
</section>


<section>
<h2 id="___sec27">UML diagram of class Person </h2>

<p>
<center><p><img src="fig-class/UML_class_Person.png" align="bottom" width=240></p></center>
</section>


<section>
<h2 id="___sec28">Basic code of class Person </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Person</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, name,
                 mobile_phone<span style="color: #666666">=</span><span style="color: #008000">None</span>, office_phone<span style="color: #666666">=</span><span style="color: #008000">None</span>,
                 private_phone<span style="color: #666666">=</span><span style="color: #008000">None</span>, email<span style="color: #666666">=</span><span style="color: #008000">None</span>):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>name <span style="color: #666666">=</span> name
        <span style="color: #008000">self</span><span style="color: #666666">.</span>mobile <span style="color: #666666">=</span> mobile_phone
        <span style="color: #008000">self</span><span style="color: #666666">.</span>office <span style="color: #666666">=</span> office_phone
        <span style="color: #008000">self</span><span style="color: #666666">.</span>private <span style="color: #666666">=</span> private_phone
        <span style="color: #008000">self</span><span style="color: #666666">.</span>email <span style="color: #666666">=</span> email

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">add_mobile_phone</span>(<span style="color: #008000">self</span>, number):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>mobile <span style="color: #666666">=</span> number

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">add_office_phone</span>(<span style="color: #008000">self</span>, number):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>office <span style="color: #666666">=</span> number

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">add_private_phone</span>(<span style="color: #008000">self</span>, number):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>private <span style="color: #666666">=</span> number

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">add_email</span>(<span style="color: #008000">self</span>, address):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>email <span style="color: #666666">=</span> address
</pre></div>

</div>
</section>


<section>
<h2 id="___sec29">Code of a dump method for printing all class contents </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Person</span>:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">dump</span>(<span style="color: #008000">self</span>):
        s <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>name <span style="color: #666666">+</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>mobile <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
            s <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;mobile phone:   </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>mobile
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>office <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
            s <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;office phone:   </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>office
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>private <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
            s <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;private phone:  </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>private
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>email <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
            s <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39;email address:  </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BB6622; font-weight: bold">\n</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>email
        <span style="color: #008000; font-weight: bold">print</span> s
</pre></div>

</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Usage:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">p1 <span style="color: #666666">=</span> Person(<span style="color: #BA2121">&#39;Hans Petter Langtangen&#39;</span>, email<span style="color: #666666">=</span><span style="color: #BA2121">&#39;hpl@simula.no&#39;</span>)
p1<span style="color: #666666">.</span>add_office_phone(<span style="color: #BA2121">&#39;67828283&#39;</span>),
p2 <span style="color: #666666">=</span> Person(<span style="color: #BA2121">&#39;Aslak Tveito&#39;</span>, office_phone<span style="color: #666666">=</span><span style="color: #BA2121">&#39;67828282&#39;</span>)
p2<span style="color: #666666">.</span>add_email(<span style="color: #BA2121">&#39;aslak@simula.no&#39;</span>)
phone_book <span style="color: #666666">=</span> [p1, p2]                           <span style="color: #408080; font-style: italic"># list</span>
phone_book <span style="color: #666666">=</span> {<span style="color: #BA2121">&#39;Langtangen&#39;</span>: p1, <span style="color: #BA2121">&#39;Tveito&#39;</span>: p2}   <span style="color: #408080; font-style: italic"># better</span>
<span style="color: #008000; font-weight: bold">for</span> p <span style="color: #AA22FF; font-weight: bold">in</span> phone_book:
    p<span style="color: #666666">.</span>dump()
</pre></div>

</div>
</section>


<section>
<h2 id="___sec30">Another example: a class for a circle </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> A circle is defined by its center point \( x_0 \), \( y_0 \) and its radius \( R \)</li>

<p><li> These data can be attributes in a class</li>

<p><li> Possible methods in the class: <code>area</code>, <code>circumference</code></li>

<p><li> The constructor initializes \( x_0 \), \( y_0 \) and \( R \)</li>
</ul>
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Circle</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, x0, y0, R):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>x0, <span style="color: #008000">self</span><span style="color: #666666">.</span>y0, <span style="color: #008000">self</span><span style="color: #666666">.</span>R <span style="color: #666666">=</span> x0, y0, R

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">area</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> pi<span style="color: #666666">*</span><span style="color: #008000">self</span><span style="color: #666666">.</span>R<span style="color: #666666">**2</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">circumference</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">2*</span>pi<span style="color: #666666">*</span><span style="color: #008000">self</span><span style="color: #666666">.</span>R
</pre></div>

</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> c <span style="color: #666666">=</span> Circle(<span style="color: #666666">2</span>, <span style="color: #666666">-1</span>, <span style="color: #666666">5</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;A circle with radius </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121"> at (</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">, </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">) has area </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> \
<span style="color: #666666">...</span>       (c<span style="color: #666666">.</span>R, c<span style="color: #666666">.</span>x0, c<span style="color: #666666">.</span>y0, c<span style="color: #666666">.</span>area())
A circle <span style="color: #008000; font-weight: bold">with</span> radius <span style="color: #666666">5</span> at (<span style="color: #666666">2</span>, <span style="color: #666666">-1</span>) has area <span style="color: #666666">78.5398</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec31">Test function for class Circle </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_Circle</span>():
    R <span style="color: #666666">=</span> <span style="color: #666666">2.5</span>
    c <span style="color: #666666">=</span> Circle(<span style="color: #666666">7.4</span>, <span style="color: #666666">-8.1</span>, R)

    <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> pi
    expected_area <span style="color: #666666">=</span> pi<span style="color: #666666">*</span>R<span style="color: #666666">**2</span>
    computed_area <span style="color: #666666">=</span> c<span style="color: #666666">.</span>area()
    diff <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(expected_area <span style="color: #666666">-</span> computed_area)
    tol <span style="color: #666666">=</span> <span style="color: #666666">1E-14</span>
    <span style="color: #008000; font-weight: bold">assert</span> diff <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;bug in Circle.area, diff=</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> diff

    expected_circumference <span style="color: #666666">=</span> <span style="color: #666666">2*</span>pi<span style="color: #666666">*</span>R
    computed_circumference <span style="color: #666666">=</span> c<span style="color: #666666">.</span>circumference()
    diff <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(expected_circumference <span style="color: #666666">-</span> computed_circumference)
    <span style="color: #008000; font-weight: bold">assert</span> diff <span style="color: #666666">&lt;</span> tol, <span style="color: #BA2121">&#39;bug in Circle.circumference, diff=</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> diff
</pre></div>

</div>
</section>


<section>
<h1 id="___sec32">Special methods </h1>

<p>

<table border="0">
<tr>
<td class="padding">
<center><p><img src="fig-class/associations/special_methods1.jpg" align="bottom" width=500></p></center>
</td>
<td class="padding">
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">MyClass</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, a, b):
    <span style="color: #666666">...</span>

p1 <span style="color: #666666">=</span> MyClass(<span style="color: #666666">2</span>, <span style="color: #666666">5</span>)
p2 <span style="color: #666666">=</span> MyClass(<span style="color: #666666">-1</span>, <span style="color: #666666">10</span>)

p3 <span style="color: #666666">=</span> p1 <span style="color: #666666">+</span> p2
p4 <span style="color: #666666">=</span> p1 <span style="color: #666666">-</span> p2
p5 <span style="color: #666666">=</span> p1<span style="color: #666666">*</span>p2
p6 <span style="color: #666666">=</span> p1<span style="color: #666666">**7</span> <span style="color: #666666">+</span> <span style="color: #666666">4*</span>p3
</pre></div>
<p>
</td>
</tr>
</table>
</section>


<section>
<h2 id="___sec33"><em>Special methods</em> allow nice syntax and are recognized by double leading and trailing underscores </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, <span style="color: #666666">...</span>)
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__call__</span>(<span style="color: #008000">self</span>, <span style="color: #666666">...</span>)
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__add__</span>(<span style="color: #008000">self</span>, other)

<span style="color: #408080; font-style: italic"># Python syntax</span>
y <span style="color: #666666">=</span> Y(<span style="color: #666666">4</span>)
<span style="color: #008000; font-weight: bold">print</span> y(<span style="color: #666666">2</span>)
z <span style="color: #666666">=</span> Y(<span style="color: #666666">6</span>)
<span style="color: #008000; font-weight: bold">print</span> y <span style="color: #666666">+</span> z

<span style="color: #408080; font-style: italic"># What&#39;s actually going on</span>
Y<span style="color: #666666">.</span>__init__(y, <span style="color: #666666">4</span>)
<span style="color: #008000; font-weight: bold">print</span> Y<span style="color: #666666">.</span>__call__(y, <span style="color: #666666">2</span>)
Y<span style="color: #666666">.</span>__init__(z, <span style="color: #666666">6</span>)
<span style="color: #008000; font-weight: bold">print</span> Y<span style="color: #666666">.</span>__add__(y, z)
</pre></div>
<p>
We shall learn about many more such <em>special methods</em>
</div>
</section>


<section>
<h2 id="___sec34">Example on a call special method </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Replace the <code>value</code> method by a <em>call</em> special method:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Y</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, v0):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>v0 <span style="color: #666666">=</span> v0
        <span style="color: #008000">self</span><span style="color: #666666">.</span>g <span style="color: #666666">=</span> <span style="color: #666666">9.81</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__call__</span>(<span style="color: #008000">self</span>, t):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>v0<span style="color: #666666">*</span>t <span style="color: #666666">-</span> <span style="color: #666666">0.5*</span><span style="color: #008000">self</span><span style="color: #666666">.</span>g<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>
</pre></div>
<p>
Now we can write

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">y <span style="color: #666666">=</span> Y(<span style="color: #666666">3</span>)
v <span style="color: #666666">=</span> y(<span style="color: #666666">0.1</span>) <span style="color: #408080; font-style: italic"># same as v = y.__call__(0.1) or Y.__call__(y, 0.1)</span>
</pre></div>
<p>
Note:

<ul>
 <p><li> The instance <code>y</code> behaves and looks as a function!</li>
 <p><li> The <code>value(t)</code> method does the same, but <code>__call__</code> allows nicer syntax for computing function values</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec35">Representing a function by a class revisited </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Given a function with \( n+1 \) parameters and one independent variable,

<p>&nbsp;<br>
$$ f(x; p_0,\ldots,p_n)$$
<p>&nbsp;<br>

it is wise to represent <code>f</code> by a class where \( p_0,\ldots,p_n \)
are attributes and <code>__call__(x)</code> computes \( f(x) \)
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">MyFunc</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, p0, p1, p2, <span style="color: #666666">...</span>, pn):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>p0 <span style="color: #666666">=</span> p0
        <span style="color: #008000">self</span><span style="color: #666666">.</span>p1 <span style="color: #666666">=</span> p1
        <span style="color: #666666">...</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>pn <span style="color: #666666">=</span> pn

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__call__</span>(<span style="color: #008000">self</span>, x):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">...</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec36">Can we automatically differentiate a function? </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Given some mathematical function in Python, say

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> x<span style="color: #666666">**3</span>
</pre></div>
<p>
can we make a class <code>Derivative</code> and write

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">dfdx <span style="color: #666666">=</span> Derivative(f)
</pre></div>
<p>
so that <code>dfdx</code> behaves as a function that computes the derivative of <code>f(x)</code>?

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">print</span> dfdx(<span style="color: #666666">2</span>)   <span style="color: #408080; font-style: italic"># computes 3*x**2 for x=2</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec37">Automagic differentiation; solution </h2>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b>Method.</b>
<p>
We use numerical differentiation &quot;behind the curtain&quot;:

<p>&nbsp;<br>
$$ f'(x) \approx {f(x+h)-f(x)\over h} $$
<p>&nbsp;<br>

for a small (yet moderate) \( h \), say \( h=10^{-5} \)
</div>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b>Implementation.</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="fragment" class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Derivative</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, f, h<span style="color: #666666">=1E-5</span>):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>f <span style="color: #666666">=</span> f
        <span style="color: #008000">self</span><span style="color: #666666">.</span>h <span style="color: #666666">=</span> <span style="color: #008000">float</span>(h)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__call__</span>(<span style="color: #008000">self</span>, x):
        f, h <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>f, <span style="color: #008000">self</span><span style="color: #666666">.</span>h      <span style="color: #408080; font-style: italic"># make short forms</span>
        <span style="color: #008000; font-weight: bold">return</span> (f(x<span style="color: #666666">+</span>h) <span style="color: #666666">-</span> f(x))<span style="color: #666666">/</span>h
</pre></div>

</div>
</section>


<section>
<h2 id="___sec38">Automagic differentiation; demo </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #666666">&gt;&gt;&gt;</span> df <span style="color: #666666">=</span> Derivative(sin)
<span style="color: #666666">&gt;&gt;&gt;</span> x <span style="color: #666666">=</span> pi
<span style="color: #666666">&gt;&gt;&gt;</span> df(x)
<span style="color: #666666">-1.000000082740371</span>
<span style="color: #666666">&gt;&gt;&gt;</span> cos(x)  <span style="color: #408080; font-style: italic"># exact</span>
<span style="color: #666666">-1.0</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">g</span>(t):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">return</span> t<span style="color: #666666">**3</span>
<span style="color: #666666">...</span>
<span style="color: #666666">&gt;&gt;&gt;</span> dg <span style="color: #666666">=</span> Derivative(g)
<span style="color: #666666">&gt;&gt;&gt;</span> t <span style="color: #666666">=</span> <span style="color: #666666">1</span>
<span style="color: #666666">&gt;&gt;&gt;</span> dg(t)  <span style="color: #408080; font-style: italic"># compare with 3 (exact)</span>
<span style="color: #666666">3.000000248221113</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec39">Automagic differentiation; useful in Newton's method </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Newton's method solves nonlinear equations \( f(x)=0 \), but the method requires \( f'(x) \)

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">Newton</span>(f, xstart, dfdx, epsilon<span style="color: #666666">=1E-6</span>):
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">return</span> x, no_of_iterations, f(x)
</pre></div>
<p>
Suppose \( f'(x) \) requires boring/lengthy derivation, then class <code>Derivative</code> is handy:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">100000*</span>(x <span style="color: #666666">-</span> <span style="color: #666666">0.9</span>)<span style="color: #666666">**2</span> <span style="color: #666666">*</span> (x <span style="color: #666666">-</span> <span style="color: #666666">1.1</span>)<span style="color: #666666">**3</span>
<span style="color: #666666">...</span>
<span style="color: #666666">&gt;&gt;&gt;</span> df <span style="color: #666666">=</span> Derivative(f)
<span style="color: #666666">&gt;&gt;&gt;</span> xstart <span style="color: #666666">=</span> <span style="color: #666666">1.01</span>
<span style="color: #666666">&gt;&gt;&gt;</span> Newton(f, xstart, df, epsilon<span style="color: #666666">=1E-5</span>)
(<span style="color: #666666">1.0987610068093443</span>, <span style="color: #666666">8</span>, <span style="color: #666666">-7.5139644257961411e-06</span>)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec40">Automagic differentiation; test function </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> How can we test class <code>Derivative</code>?</li>

<p><li> Method 1: compute \( (f(x+h)-f(x))/h \) by hand for some \( f \) and \( h \)</li>

<p><li> Method 2: utilize that linear functions are differentiated
    exactly by our numerical formula, regardless of \( h \)</li>
</ul>
<p>

Test function based on method 2:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_Derivative</span>():
    <span style="color: #408080; font-style: italic"># The formula is exact for linear functions, regardless of h</span>
    f <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: a<span style="color: #666666">*</span>x <span style="color: #666666">+</span> b
    a <span style="color: #666666">=</span> <span style="color: #666666">3.5</span>; b <span style="color: #666666">=</span> <span style="color: #666666">8</span>
    dfdx <span style="color: #666666">=</span> Derivative(f, h<span style="color: #666666">=0.5</span>)
    diff <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(dfdx(<span style="color: #666666">4.5</span>) <span style="color: #666666">-</span> a)
    <span style="color: #008000; font-weight: bold">assert</span> diff <span style="color: #666666">&lt;</span> <span style="color: #666666">1E-14</span>, <span style="color: #BA2121">&#39;bug in class Derivative, diff=</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> diff
</pre></div>

</div>
</section>


<section>
<h2 id="___sec41">Automagic differentiation; explanation of the test function </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Use of lambda functions:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">f <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: a<span style="color: #666666">*</span>x <span style="color: #666666">+</span> b
</pre></div>
<p>
is equivalent to

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> a<span style="color: #666666">*</span>x <span style="color: #666666">+</span> b
</pre></div>
<p>
Lambda functions are convenient for producing quick, short code
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Use of closure:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">f <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: a<span style="color: #666666">*</span>x <span style="color: #666666">+</span> b
a <span style="color: #666666">=</span> <span style="color: #666666">3.5</span>; b <span style="color: #666666">=</span> <span style="color: #666666">8</span>
dfdx <span style="color: #666666">=</span> Derivative(f, h<span style="color: #666666">=0.5</span>)
dfdx(<span style="color: #666666">4.5</span>)
</pre></div>
<p>
Looks straightforward...but

<ul>
 <p><li> How can <code>Derivative.__call__</code> know <code>a</code> and <code>b</code> when it calls
   our <code>f(x)</code> function?</li>
 <p><li> Local functions inside functions remember (have access to)
   <em>all</em> local variables in the function they are defined (!)</li>
 <p><li> <code>f</code> can access <code>a</code> and <code>b</code> in <code>test_Derivative</code> even when
   called from <code>__call__</code> in class `Derivative</li>
 <p><li> <code>f</code> is known as a <em>closure</em> in computer science</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec42">Automagic differentiation detour; sympy solution (exact differentiation via symbolic expressions) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
SymPy can perform exact, symbolic differentiation:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">g</span>(t):
<span style="color: #666666">...</span>     <span style="color: #008000; font-weight: bold">return</span> t<span style="color: #666666">**3</span>
<span style="color: #666666">...</span>
<span style="color: #666666">&gt;&gt;&gt;</span> t <span style="color: #666666">=</span> Symbol(<span style="color: #BA2121">&#39;t&#39;</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> dgdt <span style="color: #666666">=</span> diff(g(t), t)           <span style="color: #408080; font-style: italic"># compute g&#39;(t)</span>
<span style="color: #666666">&gt;&gt;&gt;</span> dgdt
<span style="color: #666666">3*</span>t<span style="color: #666666">**2</span>

<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #408080; font-style: italic"># Turn sympy expression dgdt into Python function dg(t)</span>
<span style="color: #666666">&gt;&gt;&gt;</span> dg <span style="color: #666666">=</span> lambdify([t], dgdt)
<span style="color: #666666">&gt;&gt;&gt;</span> dg(<span style="color: #666666">1</span>)
<span style="color: #666666">3</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec43">Automagic differentiation detour; class based on sympy </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">sp</span>

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Derivative_sympy</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, f):
        <span style="color: #408080; font-style: italic"># f: Python f(x)</span>
        x <span style="color: #666666">=</span> sp<span style="color: #666666">.</span>Symbol(<span style="color: #BA2121">&#39;x&#39;</span>)
        sympy_f <span style="color: #666666">=</span> f(x)
        sympy_dfdx <span style="color: #666666">=</span> sp<span style="color: #666666">.</span>diff(sympy_f, x)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>__call__ <span style="color: #666666">=</span> sp<span style="color: #666666">.</span>lambdify([x], sympy_dfdx)
</pre></div>

</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">g</span>(t):
<span style="color: #666666">...</span>    <span style="color: #008000; font-weight: bold">return</span> t<span style="color: #666666">**3</span>

<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">h</span>(y):
<span style="color: #666666">...</span>    <span style="color: #008000; font-weight: bold">return</span> sp<span style="color: #666666">.</span>sin(y)

<span style="color: #666666">&gt;&gt;&gt;</span> dg <span style="color: #666666">=</span> Derivative_sympy(g)
<span style="color: #666666">&gt;&gt;&gt;</span> dh <span style="color: #666666">=</span> Derivative_sympy(h)
<span style="color: #666666">&gt;&gt;&gt;</span> dg(<span style="color: #666666">1</span>)   <span style="color: #408080; font-style: italic"># 3*1**2 = 3</span>
<span style="color: #666666">3</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> pi
<span style="color: #666666">&gt;&gt;&gt;</span> dh(pi)  <span style="color: #408080; font-style: italic"># cos(pi) = -1</span>
<span style="color: #666666">-1.0</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec44">Automagic integration; problem setting </h2>

<p>
<center><p><img src="fig-class/integral_comic_strip.png" align="bottom" width=800></p></center>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Given a function \( f(x) \), we want to compute

<p>&nbsp;<br>
$$ F(x; a) = \int_a^x f(t)dt $$
<p>&nbsp;<br>
</div>
</section>


<section>
<h2 id="___sec45">Automagic integration; technique </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>&nbsp;<br>
$$ F(x; a) = \int_a^x f(t)dt $$
<p>&nbsp;<br>

<p>
Technique: Midpoint rule or Trapezoidal rule, here the latter:

<p>&nbsp;<br>
$$
\int_a^x f(t)dt = h\left({1\over2}f(a) + \sum_{i=1}^{n-1} f(a+ih) + {1\over2}f(x)\right)
$$
<p>&nbsp;<br>

<p>
Desired application code:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">f</span>(x):
    <span style="color: #008000; font-weight: bold">return</span> exp(<span style="color: #666666">-</span>x<span style="color: #666666">**2</span>)<span style="color: #666666">*</span>sin(<span style="color: #666666">10*</span>x)

a <span style="color: #666666">=</span> <span style="color: #666666">0</span>; n <span style="color: #666666">=</span> <span style="color: #666666">200</span>
F <span style="color: #666666">=</span> Integral(f, a, n)
x <span style="color: #666666">=</span> <span style="color: #666666">1.2</span>
<span style="color: #008000; font-weight: bold">print</span> F(x)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec46">Automagic integration; implementation </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">trapezoidal</span>(f, a, x, n):
    h <span style="color: #666666">=</span> (x<span style="color: #666666">-</span>a)<span style="color: #666666">/</span><span style="color: #008000">float</span>(n)
    I <span style="color: #666666">=</span> <span style="color: #666666">0.5*</span>f(a)
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, n):
        I <span style="color: #666666">+=</span> f(a <span style="color: #666666">+</span> i<span style="color: #666666">*</span>h)
    I <span style="color: #666666">+=</span> <span style="color: #666666">0.5*</span>f(x)
    I <span style="color: #666666">*=</span> h
    <span style="color: #008000; font-weight: bold">return</span> I
</pre></div>
<p>
Class <code>Integral</code> holds <code>f</code>, <code>a</code> and <code>n</code> as attributes and has a call special method for computing the integral:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Integral</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, f, a, n<span style="color: #666666">=100</span>):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>f, <span style="color: #008000">self</span><span style="color: #666666">.</span>a, <span style="color: #008000">self</span><span style="color: #666666">.</span>n <span style="color: #666666">=</span> f, a, n

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__call__</span>(<span style="color: #008000">self</span>, x):
        <span style="color: #008000; font-weight: bold">return</span> trapezoidal(<span style="color: #008000">self</span><span style="color: #666666">.</span>f, <span style="color: #008000">self</span><span style="color: #666666">.</span>a, x, <span style="color: #008000">self</span><span style="color: #666666">.</span>n)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec47">Automagic integration; test function </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> How can we test class <code>Integral</code>?</li>

<p><li> Method 1: compute by hand for some \( f \) and small \( n \)</li>

<p><li> Method 2: utilize that linear functions are integrated
    exactly by our numerical formula, regardless of \( n \)</li>
</ul>
<p>

Test function based on method 2:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_Integral</span>():
    f <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: <span style="color: #666666">2*</span>x <span style="color: #666666">+</span> <span style="color: #666666">5</span>
    F <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> x: x<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #666666">5*</span>x <span style="color: #666666">-</span> (a<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #666666">5*</span>a)
    a <span style="color: #666666">=</span> <span style="color: #666666">2</span>
    dfdx <span style="color: #666666">=</span> Integralf, a, n<span style="color: #666666">=4</span>)
    x <span style="color: #666666">=</span> <span style="color: #666666">6</span>
    diff <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(I(x) <span style="color: #666666">-</span> (F(x) <span style="color: #666666">-</span> F(a)))
    <span style="color: #008000; font-weight: bold">assert</span> diff <span style="color: #666666">&lt;</span> <span style="color: #666666">1E-15</span>, <span style="color: #BA2121">&#39;bug in class Integral, diff=</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> diff
</pre></div>

</div>
</section>


<section>
<h2 id="___sec48">Special method for printing </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> In Python, we can usually print an object <code>a</code> by <code>print a</code>,
    works for built-in types (strings, lists, floats, ...)</li>

<p><li> Python does not know how to print objects of a user-defined class,
    but if the class defines a method <code>__str__</code>, Python will use this method to convert an object to a string</li>
</ul>
<p>

Example:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Y</span>:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__call__</span>(<span style="color: #008000">self</span>, t):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>v0<span style="color: #666666">*</span>t <span style="color: #666666">-</span> <span style="color: #666666">0.5*</span><span style="color: #008000">self</span><span style="color: #666666">.</span>g<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__str__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39;v0*t - 0.5*g*t**2; v0=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>v0
</pre></div>
<p>
Demo:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> y <span style="color: #666666">=</span> Y(<span style="color: #666666">1.5</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> y(<span style="color: #666666">0.2</span>)
<span style="color: #666666">0.1038</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> y
v0<span style="color: #666666">*</span>t <span style="color: #666666">-</span> <span style="color: #666666">0.5*</span>g<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>; v0<span style="color: #666666">=1.5</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec49">Class for polynomials; functionality </h2>

<p>
A polynomial can be specified by a list of its coefficients. For example,
\( 1 - x^2 + 2x^3 \) is

<p>&nbsp;<br>
$$  1 + 0\cdot x - 1\cdot x^2 + 2\cdot x^3 $$
<p>&nbsp;<br>

<p>
and the coefficients can be stored as <code>[1, 0, -1, 2]</code>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Desired application code:</b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> p1 <span style="color: #666666">=</span> Polynomial([<span style="color: #666666">1</span>, <span style="color: #666666">-1</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> p1
<span style="color: #666666">1</span> <span style="color: #666666">-</span> x
<span style="color: #666666">&gt;&gt;&gt;</span> p2 <span style="color: #666666">=</span> Polynomial([<span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">-6</span>, <span style="color: #666666">-1</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> p3 <span style="color: #666666">=</span> p1 <span style="color: #666666">+</span> p2
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> p3<span style="color: #666666">.</span>coeff
[<span style="color: #666666">1</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">-6</span>, <span style="color: #666666">-1</span>]
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> p3
<span style="color: #666666">1</span> <span style="color: #666666">-</span> <span style="color: #666666">6*</span>x<span style="color: #666666">^4</span> <span style="color: #666666">-</span> x<span style="color: #666666">^5</span>
<span style="color: #666666">&gt;&gt;&gt;</span> p2<span style="color: #666666">.</span>differentiate()
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> p2
<span style="color: #666666">1</span> <span style="color: #666666">-</span> <span style="color: #666666">24*</span>x<span style="color: #666666">^3</span> <span style="color: #666666">-</span> <span style="color: #666666">5*</span>x<span style="color: #666666">^4</span>
</pre></div>
<p>
How can we make class <code>Polynomial</code>?
</div>
</section>


<section>
<h2 id="___sec50">Class Polynomial; basic code </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Polynomial</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, coefficients):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>coeff <span style="color: #666666">=</span> coefficients

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__call__</span>(<span style="color: #008000">self</span>, x):
        s <span style="color: #666666">=</span> <span style="color: #666666">0</span>
        <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>coeff)):
            s <span style="color: #666666">+=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>coeff[i]<span style="color: #666666">*</span>x<span style="color: #666666">**</span>i
        <span style="color: #008000; font-weight: bold">return</span> s
</pre></div>

</div>
</section>


<section>
<h2 id="___sec51">Class Polynomial; addition </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Polynomial</span>:
    <span style="color: #666666">...</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__add__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #408080; font-style: italic"># return self + other</span>

        <span style="color: #408080; font-style: italic"># start with the longest list and add in the other:</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">len</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>coeff) <span style="color: #666666">&gt;</span> <span style="color: #008000">len</span>(other<span style="color: #666666">.</span>coeff):
            coeffsum <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>coeff[:]  <span style="color: #408080; font-style: italic"># copy!</span>
            <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(other<span style="color: #666666">.</span>coeff)):
                coeffsum[i] <span style="color: #666666">+=</span> other<span style="color: #666666">.</span>coeff[i]
        <span style="color: #008000; font-weight: bold">else</span>:
            coeffsum <span style="color: #666666">=</span> other<span style="color: #666666">.</span>coeff[:] <span style="color: #408080; font-style: italic"># copy!</span>
            <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #008000">len</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>coeff)):
                coeffsum[i] <span style="color: #666666">+=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>coeff[i]
        <span style="color: #008000; font-weight: bold">return</span> Polynomial(coeffsum)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec52">Class Polynomial; multiplication </h2>

<p>

<div class="fragment alert alert-block alert-block alert-text-small">
<b>Mathematics:</b>
<p>
Multiplication of two general polynomials:

<p>&nbsp;<br>
$$ \left(\sum_{i=0}^Mc_ix^i\right)\left(\sum_{j=0}^N d_jx^j\right)
= \sum_{i=0}^M \sum_{j=0}^N c_id_j x^{i+j} $$
<p>&nbsp;<br>

<p>
The coeff. corresponding to power \( i+j \) is \( c_i\cdot d_j \). The
list <code>r</code> of coefficients of the result:
<code>r[i+j] = c[i]*d[j]</code> (<code>i</code> and <code>j</code> running from
0 to \( M \) and \( N \), resp.)
</div>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b>Implementation:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="fragment" class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Polynomial</span>:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__mul__</span>(<span style="color: #008000">self</span>, other):
        M <span style="color: #666666">=</span> <span style="color: #008000">len</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>coeff) <span style="color: #666666">-</span> <span style="color: #666666">1</span>
        N <span style="color: #666666">=</span> <span style="color: #008000">len</span>(other<span style="color: #666666">.</span>coeff) <span style="color: #666666">-</span> <span style="color: #666666">1</span>
        coeff <span style="color: #666666">=</span> [<span style="color: #666666">0</span>]<span style="color: #666666">*</span>(M<span style="color: #666666">+</span>N<span style="color: #666666">+1</span>)  <span style="color: #408080; font-style: italic"># or zeros(M+N+1)</span>
        <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">0</span>, M<span style="color: #666666">+1</span>):
            <span style="color: #008000; font-weight: bold">for</span> j <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">0</span>, N<span style="color: #666666">+1</span>):
                coeff[i<span style="color: #666666">+</span>j] <span style="color: #666666">+=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>coeff[i]<span style="color: #666666">*</span>other<span style="color: #666666">.</span>coeff[j]
        <span style="color: #008000; font-weight: bold">return</span> Polynomial(coeff)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec53">Class Polynomial; differentation </h2>

<p>
<div class="alert alert-block alert-block alert-text-small">
<b>Mathematics:</b>
<p>
Rule for differentiating a general polynomial:

<p>&nbsp;<br>
$$ {d\over dx}\sum_{i=0}^n c_ix^i = \sum_{i=1}^n ic_ix^{i-1}$$
<p>&nbsp;<br>

<p>
If <code>c</code> is the list of coefficients, the derivative has a list
of coefficients, <code>dc</code>, where <code>dc[i-1] = i*c[i]</code> for
<code>i</code> running from 1 to the largest index in <code>c</code>.
Note that <code>dc</code> has one element less than <code>c</code>.
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Implementation:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Polynomial</span>:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">differentiate</span>(<span style="color: #008000">self</span>):    <span style="color: #408080; font-style: italic"># change self</span>
        <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, <span style="color: #008000">len</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>coeff)):
            <span style="color: #008000">self</span><span style="color: #666666">.</span>coeff[i<span style="color: #666666">-1</span>] <span style="color: #666666">=</span> i<span style="color: #666666">*</span><span style="color: #008000">self</span><span style="color: #666666">.</span>coeff[i]
        <span style="color: #008000; font-weight: bold">del</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>coeff[<span style="color: #666666">-1</span>]

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">derivative</span>(<span style="color: #008000">self</span>):       <span style="color: #408080; font-style: italic"># return new polynomial</span>
        dpdx <span style="color: #666666">=</span> Polynomial(<span style="color: #008000">self</span><span style="color: #666666">.</span>coeff[:])  <span style="color: #408080; font-style: italic"># copy</span>
        dpdx<span style="color: #666666">.</span>differentiate()
        <span style="color: #008000; font-weight: bold">return</span> dpdx
</pre></div>

</div>
</section>


<section>
<h2 id="___sec54">Class Polynomial; pretty print </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Polynomial</span>:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__str__</span>(<span style="color: #008000">self</span>):
        s <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;&#39;</span>
        <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">0</span>, <span style="color: #008000">len</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>coeff)):
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>coeff[i] <span style="color: #666666">!=</span> <span style="color: #666666">0</span>:
                s <span style="color: #666666">+=</span> <span style="color: #BA2121">&#39; + </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">*x^</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (<span style="color: #008000">self</span><span style="color: #666666">.</span>coeff[i], i)
        <span style="color: #408080; font-style: italic"># fix layout (lots of special cases):</span>
        s <span style="color: #666666">=</span> s<span style="color: #666666">.</span>replace(<span style="color: #BA2121">&#39;+ -&#39;</span>, <span style="color: #BA2121">&#39;- &#39;</span>)
        s <span style="color: #666666">=</span> s<span style="color: #666666">.</span>replace(<span style="color: #BA2121">&#39; 1*&#39;</span>, <span style="color: #BA2121">&#39; &#39;</span>)
        s <span style="color: #666666">=</span> s<span style="color: #666666">.</span>replace(<span style="color: #BA2121">&#39;x^0&#39;</span>, <span style="color: #BA2121">&#39;1&#39;</span>)
        s <span style="color: #666666">=</span> s<span style="color: #666666">.</span>replace(<span style="color: #BA2121">&#39;x^1 &#39;</span>, <span style="color: #BA2121">&#39;x &#39;</span>)
        s <span style="color: #666666">=</span> s<span style="color: #666666">.</span>replace(<span style="color: #BA2121">&#39;x^1&#39;</span>, <span style="color: #BA2121">&#39;x&#39;</span>)
        <span style="color: #008000; font-weight: bold">if</span> s[<span style="color: #666666">0</span>:<span style="color: #666666">3</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39; + &#39;</span>:  <span style="color: #408080; font-style: italic"># remove initial +</span>
            s <span style="color: #666666">=</span> s[<span style="color: #666666">3</span>:]
        <span style="color: #008000; font-weight: bold">if</span> s[<span style="color: #666666">0</span>:<span style="color: #666666">3</span>] <span style="color: #666666">==</span> <span style="color: #BA2121">&#39; - &#39;</span>:  <span style="color: #408080; font-style: italic"># fix spaces for initial -</span>
            s <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;-&#39;</span> <span style="color: #666666">+</span> s[<span style="color: #666666">3</span>:]
        <span style="color: #008000; font-weight: bold">return</span> s
</pre></div>

</div>
</section>


<section>
<h2 id="___sec55">Class for polynomials; usage </h2>

<p>
Consider

<p>&nbsp;<br>
$$ p_1(x)= 1-x,\quad p_2(x)=x - 6x^4 - x^5 $$
<p>&nbsp;<br>

and their sum

<p>&nbsp;<br>
$$ p_3(x) = p_1(x) + p_2(x) = 1 -6x^4 - x^5 $$
<p>&nbsp;<br>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> p1 <span style="color: #666666">=</span> Polynomial([<span style="color: #666666">1</span>, <span style="color: #666666">-1</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> p1
<span style="color: #666666">1</span> <span style="color: #666666">-</span> x
<span style="color: #666666">&gt;&gt;&gt;</span> p2 <span style="color: #666666">=</span> Polynomial([<span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">-6</span>, <span style="color: #666666">-1</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> p3 <span style="color: #666666">=</span> p1 <span style="color: #666666">+</span> p2
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> p3<span style="color: #666666">.</span>coeff
[<span style="color: #666666">1</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">0</span>, <span style="color: #666666">-6</span>, <span style="color: #666666">-1</span>]
<span style="color: #666666">&gt;&gt;&gt;</span> p2<span style="color: #666666">.</span>differentiate()
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> p2
<span style="color: #666666">1</span> <span style="color: #666666">-</span> <span style="color: #666666">24*</span>x<span style="color: #666666">^3</span> <span style="color: #666666">-</span> <span style="color: #666666">5*</span>x<span style="color: #666666">^4</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec56">The programmer is in charge of defining special methods! </h2>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b></b>
<p>
How should, e.g., <code>__add__(self, other)</code> be defined? This is completely up to the programmer, depending on what is meaningful by <code>object1 + object2</code>.
</div>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b></b>
<p>
An anthropologist was asking a primitive tribesman about arithmetic.  When the anthropologist asked, <em>What does two and two make?</em> the tribesman replied, <em>Five.</em>  Asked to explain, the tribesman said, <em>If I have a rope with two knots, and another rope with two knots, and I join the ropes together, then I have five knots.</em>
</div>
</section>


<section>
<h2 id="___sec57">Special methods for arithmetic operations </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">c <span style="color: #666666">=</span> a <span style="color: #666666">+</span> b    <span style="color: #408080; font-style: italic">#  c = a.__add__(b)</span>

c <span style="color: #666666">=</span> a <span style="color: #666666">-</span> b    <span style="color: #408080; font-style: italic">#  c = a.__sub__(b)</span>

c <span style="color: #666666">=</span> a<span style="color: #666666">*</span>b      <span style="color: #408080; font-style: italic">#  c = a.__mul__(b)</span>

c <span style="color: #666666">=</span> a<span style="color: #666666">/</span>b      <span style="color: #408080; font-style: italic">#  c = a.__div__(b)</span>

c <span style="color: #666666">=</span> a<span style="color: #666666">**</span>e     <span style="color: #408080; font-style: italic">#  c = a.__pow__(e)</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec58">Special methods for comparisons </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">a <span style="color: #666666">==</span> b       <span style="color: #408080; font-style: italic">#  a.__eq__(b)</span>

a <span style="color: #666666">!=</span> b       <span style="color: #408080; font-style: italic">#  a.__ne__(b)</span>

a <span style="color: #666666">&lt;</span> b        <span style="color: #408080; font-style: italic">#  a.__lt__(b)</span>

a <span style="color: #666666">&lt;=</span> b       <span style="color: #408080; font-style: italic">#  a.__le__(b)</span>

a <span style="color: #666666">&gt;</span> b        <span style="color: #408080; font-style: italic">#  a.__gt__(b)</span>

a <span style="color: #666666">&gt;=</span> b       <span style="color: #408080; font-style: italic">#  a.__ge__(b)</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec59">Class for vectors in the plane </h2>

<p>
<div class="alert alert-block alert-block alert-text-small">
<b>Mathematical operations for vectors in the plane:</b>
<p>&nbsp;<br>
$$
\begin{align*}
(a,b) + (c,d) &= (a+c, b+d)\\
(a,b) - (c,d) &= (a-c, b-d)\\
(a,b)\cdot(c,d) &= ac + bd\\
(a,b) &= (c, d)\hbox{ if }a=c\hbox{ and }b=d
\end{align*}
$$
<p>&nbsp;<br>
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Desired application code:</b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> u <span style="color: #666666">=</span> Vec2D(<span style="color: #666666">0</span>,<span style="color: #666666">1</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> v <span style="color: #666666">=</span> Vec2D(<span style="color: #666666">1</span>,<span style="color: #666666">0</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> u <span style="color: #666666">+</span> v
(<span style="color: #666666">1</span>, <span style="color: #666666">1</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">=</span> u <span style="color: #666666">+</span> v
<span style="color: #666666">&gt;&gt;&gt;</span> w <span style="color: #666666">=</span> Vec2D(<span style="color: #666666">1</span>,<span style="color: #666666">1</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">==</span> w
<span style="color: #008000">True</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> u <span style="color: #666666">-</span> v
(<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> u<span style="color: #666666">*</span>v
<span style="color: #666666">0</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec60">Class for vectors; implementation </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Vec2D</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, x, y):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>x <span style="color: #666666">=</span> x;  <span style="color: #008000">self</span><span style="color: #666666">.</span>y <span style="color: #666666">=</span> y

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__add__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">return</span> Vec2D(<span style="color: #008000">self</span><span style="color: #666666">.</span>x<span style="color: #666666">+</span>other<span style="color: #666666">.</span>x, <span style="color: #008000">self</span><span style="color: #666666">.</span>y<span style="color: #666666">+</span>other<span style="color: #666666">.</span>y)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__sub__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">return</span> Vec2D(<span style="color: #008000">self</span><span style="color: #666666">.</span>x<span style="color: #666666">-</span>other<span style="color: #666666">.</span>x, <span style="color: #008000">self</span><span style="color: #666666">.</span>y<span style="color: #666666">-</span>other<span style="color: #666666">.</span>y)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__mul__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>x<span style="color: #666666">*</span>other<span style="color: #666666">.</span>x <span style="color: #666666">+</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>y<span style="color: #666666">*</span>other<span style="color: #666666">.</span>y

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__abs__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> math<span style="color: #666666">.</span>sqrt(<span style="color: #008000">self</span><span style="color: #666666">.</span>x<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>y<span style="color: #666666">**2</span>)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__eq__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>x <span style="color: #666666">==</span> other<span style="color: #666666">.</span>x <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>y <span style="color: #666666">==</span> other<span style="color: #666666">.</span>y

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__str__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39;(</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">, </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">)&#39;</span> <span style="color: #666666">%</span> (<span style="color: #008000">self</span><span style="color: #666666">.</span>x, <span style="color: #008000">self</span><span style="color: #666666">.</span>y)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__ne__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>__eq__(other)  <span style="color: #408080; font-style: italic"># reuse __eq__</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec61">The repr special method: <code>eval(repr(p))</code> creates <code>p</code> </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">MyClass</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, a, b):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>a, <span style="color: #008000">self</span><span style="color: #666666">.</span>b <span style="color: #666666">=</span> a, b

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__str__</span>(<span style="color: #008000">self</span>):
        <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Return string with pretty print.&quot;&quot;&quot;</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39;a=</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">, b=</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (<span style="color: #008000">self</span><span style="color: #666666">.</span>a, <span style="color: #008000">self</span><span style="color: #666666">.</span>b)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__repr__</span>(<span style="color: #008000">self</span>):
        <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Return string such that eval(s) recreates self.&quot;&quot;&quot;</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39;MyClass(</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">, </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">)&#39;</span> <span style="color: #666666">%</span> (<span style="color: #008000">self</span><span style="color: #666666">.</span>a, <span style="color: #008000">self</span><span style="color: #666666">.</span>b)
</pre></div>

</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> m <span style="color: #666666">=</span> MyClass(<span style="color: #666666">1</span>, <span style="color: #666666">5</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> m      <span style="color: #408080; font-style: italic"># calls m.__str__()</span>
a<span style="color: #666666">=1</span>, b<span style="color: #666666">=5</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">str</span>(m)       <span style="color: #408080; font-style: italic"># calls m.__str__()</span>
<span style="color: #BA2121">&#39;a=1, b=5&#39;</span>
<span style="color: #666666">&gt;&gt;&gt;</span> s <span style="color: #666666">=</span> <span style="color: #008000">repr</span>(m)  <span style="color: #408080; font-style: italic"># calls m.__repr__()</span>
<span style="color: #666666">&gt;&gt;&gt;</span> s
<span style="color: #BA2121">&#39;MyClass(1, 5)&#39;</span>
<span style="color: #666666">&gt;&gt;&gt;</span> m2 <span style="color: #666666">=</span> <span style="color: #008000">eval</span>(s) <span style="color: #408080; font-style: italic"># same as m2 = MyClass(1, 5)</span>
<span style="color: #666666">&gt;&gt;&gt;</span> m2           <span style="color: #408080; font-style: italic"># calls m.__repr__()</span>
<span style="color: #BA2121">&#39;MyClass(1, 5)&#39;</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec62">Class Y revisited with repr print method </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Y</span>:
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Class for function y(t; v0, g) = v0*t - 0.5*g*t**2.&quot;&quot;&quot;</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, v0):
        <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Store parameters.&quot;&quot;&quot;</span>
        <span style="color: #008000">self</span><span style="color: #666666">.</span>v0 <span style="color: #666666">=</span> v0
        <span style="color: #008000">self</span><span style="color: #666666">.</span>g <span style="color: #666666">=</span> <span style="color: #666666">9.81</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__call__</span>(<span style="color: #008000">self</span>, t):
        <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Evaluate function.&quot;&quot;&quot;</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>v0<span style="color: #666666">*</span>t <span style="color: #666666">-</span> <span style="color: #666666">0.5*</span><span style="color: #008000">self</span><span style="color: #666666">.</span>g<span style="color: #666666">*</span>t<span style="color: #666666">**2</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__str__</span>(<span style="color: #008000">self</span>):
        <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Pretty print.&quot;&quot;&quot;</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39;v0*t - 0.5*g*t**2; v0=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>v0

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__repr__</span>(<span style="color: #008000">self</span>):
        <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Print code for regenerating this instance.&quot;&quot;&quot;</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39;Y(</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">)&#39;</span> <span style="color: #666666">%</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>v0
</pre></div>

</div>
</section>


<section>
<h2 id="___sec63">Class for complex numbers; functionality </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Python already has a class <code>complex</code> for complex numbers, but implementing such a class is a good pedagogical example on class programming (especially with special methods).
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Usage:</b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> u <span style="color: #666666">=</span> Complex(<span style="color: #666666">2</span>,<span style="color: #666666">-1</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> v <span style="color: #666666">=</span> Complex(<span style="color: #666666">1</span>)     <span style="color: #408080; font-style: italic"># zero imaginary part</span>
<span style="color: #666666">&gt;&gt;&gt;</span> w <span style="color: #666666">=</span> u <span style="color: #666666">+</span> v
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> w
(<span style="color: #666666">3</span>, <span style="color: #666666">-1</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> w <span style="color: #666666">!=</span> u
<span style="color: #008000">True</span>
<span style="color: #666666">&gt;&gt;&gt;</span> u<span style="color: #666666">*</span>v
Complex(<span style="color: #666666">2</span>, <span style="color: #666666">-1</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> u <span style="color: #666666">&lt;</span> v
illegal operation <span style="color: #BA2121">&quot;&lt;&quot;</span> <span style="color: #008000; font-weight: bold">for</span> <span style="color: #008000">complex</span> numbers
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> w <span style="color: #666666">+</span> <span style="color: #666666">4</span>
(<span style="color: #666666">7</span>, <span style="color: #666666">-1</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> <span style="color: #666666">4</span> <span style="color: #666666">-</span> w
(<span style="color: #666666">1</span>, <span style="color: #666666">1</span>)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec64">Class for complex numbers; implementation (part 1) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Complex</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, real, imag<span style="color: #666666">=0.0</span>):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>real <span style="color: #666666">=</span> real
        <span style="color: #008000">self</span><span style="color: #666666">.</span>imag <span style="color: #666666">=</span> imag

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__add__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">return</span> Complex(<span style="color: #008000">self</span><span style="color: #666666">.</span>real <span style="color: #666666">+</span> other<span style="color: #666666">.</span>real,
                       <span style="color: #008000">self</span><span style="color: #666666">.</span>imag <span style="color: #666666">+</span> other<span style="color: #666666">.</span>imag)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__sub__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">return</span> Complex(<span style="color: #008000">self</span><span style="color: #666666">.</span>real <span style="color: #666666">-</span> other<span style="color: #666666">.</span>real,
                       <span style="color: #008000">self</span><span style="color: #666666">.</span>imag <span style="color: #666666">-</span> other<span style="color: #666666">.</span>imag)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__mul__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">return</span> Complex(<span style="color: #008000">self</span><span style="color: #666666">.</span>real<span style="color: #666666">*</span>other<span style="color: #666666">.</span>real <span style="color: #666666">-</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>imag<span style="color: #666666">*</span>other<span style="color: #666666">.</span>imag,
                       <span style="color: #008000">self</span><span style="color: #666666">.</span>imag<span style="color: #666666">*</span>other<span style="color: #666666">.</span>real <span style="color: #666666">+</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>real<span style="color: #666666">*</span>other<span style="color: #666666">.</span>imag)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__div__</span>(<span style="color: #008000">self</span>, other):
        ar, ai, br, bi <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>real, <span style="color: #008000">self</span><span style="color: #666666">.</span>imag, \
                         other<span style="color: #666666">.</span>real, other<span style="color: #666666">.</span>imag <span style="color: #408080; font-style: italic"># short forms</span>
        r <span style="color: #666666">=</span> <span style="color: #008000">float</span>(br<span style="color: #666666">**2</span> <span style="color: #666666">+</span> bi<span style="color: #666666">**2</span>)
        <span style="color: #008000; font-weight: bold">return</span> Complex((ar<span style="color: #666666">*</span>br<span style="color: #666666">+</span>ai<span style="color: #666666">*</span>bi)<span style="color: #666666">/</span>r, (ai<span style="color: #666666">*</span>br<span style="color: #666666">-</span>ar<span style="color: #666666">*</span>bi)<span style="color: #666666">/</span>r)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec65">Class for complex numbers; implementation (part 2) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__abs__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> sqrt(<span style="color: #008000">self</span><span style="color: #666666">.</span>real<span style="color: #666666">**2</span> <span style="color: #666666">+</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>imag<span style="color: #666666">**2</span>)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__neg__</span>(<span style="color: #008000">self</span>):   <span style="color: #408080; font-style: italic"># defines -c (c is Complex)</span>
        <span style="color: #008000; font-weight: bold">return</span> Complex(<span style="color: #666666">-</span><span style="color: #008000">self</span><span style="color: #666666">.</span>real, <span style="color: #666666">-</span><span style="color: #008000">self</span><span style="color: #666666">.</span>imag)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__eq__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>real <span style="color: #666666">==</span> other<span style="color: #666666">.</span>real <span style="color: #AA22FF; font-weight: bold">and</span> \
               <span style="color: #008000">self</span><span style="color: #666666">.</span>imag <span style="color: #666666">==</span> other<span style="color: #666666">.</span>imag

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__ne__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>__eq__(other)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__str__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39;(</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">, </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">)&#39;</span> <span style="color: #666666">%</span> (<span style="color: #008000">self</span><span style="color: #666666">.</span>real, <span style="color: #008000">self</span><span style="color: #666666">.</span>imag)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__repr__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39;Complex&#39;</span> <span style="color: #666666">+</span> <span style="color: #008000">str</span>(<span style="color: #008000">self</span>)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__pow__</span>(<span style="color: #008000">self</span>, power):
        <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #D2413A; font-weight: bold">NotImplementedError</span>(
          <span style="color: #BA2121">&#39;self**power is not yet impl. for Complex&#39;</span>)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec66">Refining the special methods for arithmetics </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Can we add a real number to a complex number?

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> u <span style="color: #666666">=</span> Complex(<span style="color: #666666">1</span>, <span style="color: #666666">2</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> w <span style="color: #666666">=</span> u <span style="color: #666666">+</span> <span style="color: #666666">4.5</span>
<span style="color: #666666">...</span>
<span style="color: #D2413A; font-weight: bold">AttributeError</span>: <span style="color: #BA2121">&#39;float&#39;</span> <span style="color: #008000">object</span> has no attribute <span style="color: #BA2121">&#39;real&#39;</span>
</pre></div>
<p>
Problem: we have assumed that <code>other</code> is <code>Complex</code>.
Remedy:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Complex</span>:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__add__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(other, (<span style="color: #008000">float</span>,<span style="color: #008000">int</span>)):
            other <span style="color: #666666">=</span> Complex(other)
        <span style="color: #008000; font-weight: bold">return</span> Complex(<span style="color: #008000">self</span><span style="color: #666666">.</span>real <span style="color: #666666">+</span> other<span style="color: #666666">.</span>real,
                       <span style="color: #008000">self</span><span style="color: #666666">.</span>imag <span style="color: #666666">+</span> other<span style="color: #666666">.</span>imag)

<span style="color: #408080; font-style: italic"># or</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__add__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(other, (<span style="color: #008000">float</span>,<span style="color: #008000">int</span>)):
            <span style="color: #008000; font-weight: bold">return</span> Complex(<span style="color: #008000">self</span><span style="color: #666666">.</span>real <span style="color: #666666">+</span> other, <span style="color: #008000">self</span><span style="color: #666666">.</span>imag)
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000; font-weight: bold">return</span> Complex(<span style="color: #008000">self</span><span style="color: #666666">.</span>real <span style="color: #666666">+</span> other<span style="color: #666666">.</span>real,
                           <span style="color: #008000">self</span><span style="color: #666666">.</span>imag <span style="color: #666666">+</span> other<span style="color: #666666">.</span>imag)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec67">Special methods for &quot;right&quot; operands; addition </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
What if we try this:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> u <span style="color: #666666">=</span> Complex(<span style="color: #666666">1</span>, <span style="color: #666666">2</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> w <span style="color: #666666">=</span> <span style="color: #666666">4.5</span> <span style="color: #666666">+</span> u
<span style="color: #666666">...</span>
<span style="color: #D2413A; font-weight: bold">TypeError</span>: unsupported operand <span style="color: #008000">type</span>(s) <span style="color: #008000; font-weight: bold">for</span> <span style="color: #666666">+</span>:
    <span style="color: #BA2121">&#39;float&#39;</span> <span style="color: #AA22FF; font-weight: bold">and</span> <span style="color: #BA2121">&#39;instance&#39;</span>
</pre></div>
<p>
Problem: Python's <code>float</code> objects cannot add a <code>Complex</code>.

<p>
Remedy: if a class has an <code>__radd__(self, other)</code> special method, Python applies this for <code>other + self</code>

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Complex</span>:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__radd__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Rturn other + self.&quot;&quot;&quot;</span>
        <span style="color: #408080; font-style: italic"># other + self = self + other:</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>__add__(other)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec68">Special methods for &quot;right&quot; operands; subtraction </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Right operands for subtraction is a bit more complicated since \( a-b \neq b-a \):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Complex</span>:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__sub__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(other, (<span style="color: #008000">float</span>,<span style="color: #008000">int</span>)):
            other <span style="color: #666666">=</span> Complex(other)
        <span style="color: #008000; font-weight: bold">return</span> Complex(<span style="color: #008000">self</span><span style="color: #666666">.</span>real <span style="color: #666666">-</span> other<span style="color: #666666">.</span>real,
                       <span style="color: #008000">self</span><span style="color: #666666">.</span>imag <span style="color: #666666">-</span> other<span style="color: #666666">.</span>imag)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__rsub__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(other, (<span style="color: #008000">float</span>,<span style="color: #008000">int</span>)):
            other <span style="color: #666666">=</span> Complex(other)
        <span style="color: #008000; font-weight: bold">return</span> other<span style="color: #666666">.</span>__sub__(<span style="color: #008000">self</span>)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec69">What's in a class? </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">A</span>:
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;A class for demo purposes.&quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, value):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>v <span style="color: #666666">=</span> value
</pre></div>
<p>
Any instance holds its attributes in the <code>self.__dict__</code> dictionary (Python automatically creates this dict)

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">=</span> A([<span style="color: #666666">1</span>,<span style="color: #666666">2</span>])
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> a<span style="color: #666666">.</span>__dict__  <span style="color: #408080; font-style: italic"># all attributes</span>
{<span style="color: #BA2121">&#39;v&#39;</span>: [<span style="color: #666666">1</span>, <span style="color: #666666">2</span>]}
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">dir</span>(a)            <span style="color: #408080; font-style: italic"># what&#39;s in object a?</span>
<span style="color: #BA2121">&#39;__doc__&#39;</span>, <span style="color: #BA2121">&#39;__init__&#39;</span>, <span style="color: #BA2121">&#39;__module__&#39;</span>, <span style="color: #BA2121">&#39;dump&#39;</span>, <span style="color: #BA2121">&#39;v&#39;</span>]
<span style="color: #666666">&gt;&gt;&gt;</span> a<span style="color: #666666">.</span>__doc__         <span style="color: #408080; font-style: italic"># programmer&#39;s documentation of A</span>
<span style="color: #BA2121">&#39;A class for demo purposes.&#39;</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec70">Ooops - we can add new attributes as we want! </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> a<span style="color: #666666">.</span>myvar <span style="color: #666666">=</span> <span style="color: #666666">10</span>            <span style="color: #408080; font-style: italic"># add new attribute (!)</span>
<span style="color: #666666">&gt;&gt;&gt;</span> a<span style="color: #666666">.</span>__dict__
{<span style="color: #BA2121">&#39;myvar&#39;</span>: <span style="color: #666666">10</span>, <span style="color: #BA2121">&#39;v&#39;</span>: [<span style="color: #666666">1</span>, <span style="color: #666666">2</span>]}
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">dir</span>(a)
[<span style="color: #BA2121">&#39;__doc__&#39;</span>, <span style="color: #BA2121">&#39;__init__&#39;</span>, <span style="color: #BA2121">&#39;__module__&#39;</span>, <span style="color: #BA2121">&#39;dump&#39;</span>, <span style="color: #BA2121">&#39;myvar&#39;</span>, <span style="color: #BA2121">&#39;v&#39;</span>]

<span style="color: #666666">&gt;&gt;&gt;</span> b <span style="color: #666666">=</span> A(<span style="color: #666666">-1</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> b<span style="color: #666666">.</span>__dict__              <span style="color: #408080; font-style: italic"># b has no myvar attribute</span>
{<span style="color: #BA2121">&#39;v&#39;</span>: <span style="color: #666666">-1</span>}
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">dir</span>(b)
[<span style="color: #BA2121">&#39;__doc__&#39;</span>, <span style="color: #BA2121">&#39;__init__&#39;</span>, <span style="color: #BA2121">&#39;__module__&#39;</span>, <span style="color: #BA2121">&#39;dump&#39;</span>, <span style="color: #BA2121">&#39;v&#39;</span>]
</pre></div>

</div>
</section>


<section>
<h2 id="___sec71">Summary of defining a class </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Example on a defining a class with attributes and methods:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">Gravity</span>:
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Gravity force between two objects.&quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, m, M):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>m <span style="color: #666666">=</span> m
        <span style="color: #008000">self</span><span style="color: #666666">.</span>M <span style="color: #666666">=</span> M
        <span style="color: #008000">self</span><span style="color: #666666">.</span>G <span style="color: #666666">=</span> <span style="color: #666666">6.67428E-11</span> <span style="color: #408080; font-style: italic"># gravity constant</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">force</span>(<span style="color: #008000">self</span>, r):
        G, m, M <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>G, <span style="color: #008000">self</span><span style="color: #666666">.</span>m, <span style="color: #008000">self</span><span style="color: #666666">.</span>M
        <span style="color: #008000; font-weight: bold">return</span> G<span style="color: #666666">*</span>m<span style="color: #666666">*</span>M<span style="color: #666666">/</span>r<span style="color: #666666">**2</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">visualize</span>(<span style="color: #008000">self</span>, r_start, r_stop, n<span style="color: #666666">=100</span>):
        <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">scitools.std</span> <span style="color: #008000; font-weight: bold">import</span> plot, linspace
        r <span style="color: #666666">=</span> linspace(r_start, r_stop, n)
        g <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>force(r)
        title<span style="color: #666666">=</span><span style="color: #BA2121">&#39;m=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">, M=</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (<span style="color: #008000">self</span><span style="color: #666666">.</span>m, <span style="color: #008000">self</span><span style="color: #666666">.</span>M)
        plot(r, g, title<span style="color: #666666">=</span>title)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec72">Summary of using a class </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Example on using the class:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">mass_moon <span style="color: #666666">=</span> <span style="color: #666666">7.35E+22</span>
mass_earth <span style="color: #666666">=</span> <span style="color: #666666">5.97E+24</span>

<span style="color: #408080; font-style: italic"># make instance of class Gravity:</span>
gravity <span style="color: #666666">=</span> Gravity(mass_moon, mass_earth)

r <span style="color: #666666">=</span> <span style="color: #666666">3.85E+8</span>  <span style="color: #408080; font-style: italic"># earth-moon distance in meters</span>
Fg <span style="color: #666666">=</span> gravity<span style="color: #666666">.</span>force(r)   <span style="color: #408080; font-style: italic"># call class method</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec73">Summary of special methods </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> <code>c = a + b</code> implies <code>c = a.__add__(b)</code></li>

<p><li> There are special methods for <code>a+b</code>, <code>a-b</code>, <code>a*b</code>, <code>a/b</code>, <code>a**b</code>, <code>-a</code>, <code>if a:</code>, <code>len(a)</code>, <code>str(a)</code> (pretty print), <code>repr(a)</code> (recreate <code>a</code> with <code>eval</code>), etc.</li>

<p><li> With special methods we can create new mathematical objects like vectors, polynomials and complex numbers and write &quot;mathematical code&quot; (arithmetics)</li>

<p><li> The call special method is particularly handy: <code>v = c(5)</code> means <code>v = c.__call__(5)</code></li>

<p><li> Functions with parameters should be represented by a class with the parameters as attributes and with a call special method for evaluating the function</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec74">Summarizing example: interval arithmetics for uncertainty quantification in formulas </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Uncertainty quantification:</b>
<p>
Consider measuring gravity \( g \) by dropping a ball from \( y=y_0 \) to \( y=0 \)
in time \( T \):

<p>&nbsp;<br>
$$ g = 2y_0T^{-2} $$
<p>&nbsp;<br>

<p>
What if \( y_0 \) and \( T \) are uncertain? Say \( y_0\in [0.99,1.01] \) m
and \( T\in [0.43, 0.47] \) s. What is the uncertainty in \( g \)?
</div>
</section>


<section>
<h2 id="___sec75">The uncertainty can be computed by interval arithmetics </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Interval arithmetics.</b>
<p>
Rules for computing with intervals, \( p=[a,b] \) and \( q=[c,d] \):

<ul>
 <p><li> \( p+q = [a + c, b + d] \)</li>
 <p><li> \( p-q = [a - d, b - c] \)</li>
 <p><li> \( pq =  [\min(ac, ad, bc, bd), \max(ac, ad, bc, bd)] \)</li>
 <p><li> \( p/q = [\min(a/c, a/d, b/c, b/d), \max(a/c, a/d, b/c, b/d)] \)
   (\( [c,d] \) cannot contain zero)</li>
</ul>
<p>

Obvious idea: make a class for interval arithmetics!
</div>
</section>


<section>
<h2 id="___sec76">Class for interval arithmetics </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">IntervalMath</span>:
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__init__</span>(<span style="color: #008000">self</span>, lower, upper):
        <span style="color: #008000">self</span><span style="color: #666666">.</span>lo <span style="color: #666666">=</span> <span style="color: #008000">float</span>(lower)
        <span style="color: #008000">self</span><span style="color: #666666">.</span>up <span style="color: #666666">=</span> <span style="color: #008000">float</span>(upper)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__add__</span>(<span style="color: #008000">self</span>, other):
        a, b, c, d <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>lo, <span style="color: #008000">self</span><span style="color: #666666">.</span>up, other<span style="color: #666666">.</span>lo, other<span style="color: #666666">.</span>up
        <span style="color: #008000; font-weight: bold">return</span> IntervalMath(a <span style="color: #666666">+</span> c, b <span style="color: #666666">+</span> d)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__sub__</span>(<span style="color: #008000">self</span>, other):
        a, b, c, d <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>lo, <span style="color: #008000">self</span><span style="color: #666666">.</span>up, other<span style="color: #666666">.</span>lo, other<span style="color: #666666">.</span>up
        <span style="color: #008000; font-weight: bold">return</span> IntervalMath(a <span style="color: #666666">-</span> d, b <span style="color: #666666">-</span> c)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__mul__</span>(<span style="color: #008000">self</span>, other):
        a, b, c, d <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>lo, <span style="color: #008000">self</span><span style="color: #666666">.</span>up, other<span style="color: #666666">.</span>lo, other<span style="color: #666666">.</span>up
        <span style="color: #008000; font-weight: bold">return</span> IntervalMath(<span style="color: #008000">min</span>(a<span style="color: #666666">*</span>c, a<span style="color: #666666">*</span>d, b<span style="color: #666666">*</span>c, b<span style="color: #666666">*</span>d),
                            <span style="color: #008000">max</span>(a<span style="color: #666666">*</span>c, a<span style="color: #666666">*</span>d, b<span style="color: #666666">*</span>c, b<span style="color: #666666">*</span>d))

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__div__</span>(<span style="color: #008000">self</span>, other):
        a, b, c, d <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>lo, <span style="color: #008000">self</span><span style="color: #666666">.</span>up, other<span style="color: #666666">.</span>lo, other<span style="color: #666666">.</span>up
        <span style="color: #008000; font-weight: bold">if</span> c<span style="color: #666666">*</span>d <span style="color: #666666">&lt;=</span> <span style="color: #666666">0</span>: <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">None</span>
        <span style="color: #008000; font-weight: bold">return</span> IntervalMath(<span style="color: #008000">min</span>(a<span style="color: #666666">/</span>c, a<span style="color: #666666">/</span>d, b<span style="color: #666666">/</span>c, b<span style="color: #666666">/</span>d),
                            <span style="color: #008000">max</span>(a<span style="color: #666666">/</span>c, a<span style="color: #666666">/</span>d, b<span style="color: #666666">/</span>c, b<span style="color: #666666">/</span>d))
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__str__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39;[</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">, </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">]&#39;</span> <span style="color: #666666">%</span> (<span style="color: #008000">self</span><span style="color: #666666">.</span>lo, <span style="color: #008000">self</span><span style="color: #666666">.</span>up)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec77">Demo of the new class for interval arithmetics </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Code:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">I <span style="color: #666666">=</span> IntervalMath   <span style="color: #408080; font-style: italic"># abbreviate</span>
a <span style="color: #666666">=</span> I(<span style="color: #666666">-3</span>,<span style="color: #666666">-2</span>)
b <span style="color: #666666">=</span> I(<span style="color: #666666">4</span>,<span style="color: #666666">5</span>)

expr <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;a+b&#39;</span>, <span style="color: #BA2121">&#39;a-b&#39;</span>, <span style="color: #BA2121">&#39;a*b&#39;</span>, <span style="color: #BA2121">&#39;a/b&#39;</span>   <span style="color: #408080; font-style: italic"># test expressions</span>
<span style="color: #008000; font-weight: bold">for</span> e <span style="color: #AA22FF; font-weight: bold">in</span> expr:
    <span style="color: #008000; font-weight: bold">print</span> e, <span style="color: #BA2121">&#39;=&#39;</span>, <span style="color: #008000">eval</span>(e)
</pre></div>

</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Output:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">a<span style="color: #666666">+</span>b <span style="color: #666666">=</span> [<span style="color: #666666">1</span>, <span style="color: #666666">3</span>]
a<span style="color: #666666">-</span>b <span style="color: #666666">=</span> [<span style="color: #666666">-8</span>, <span style="color: #666666">-6</span>]
a<span style="color: #666666">*</span>b <span style="color: #666666">=</span> [<span style="color: #666666">-15</span>, <span style="color: #666666">-8</span>]
a<span style="color: #666666">/</span>b <span style="color: #666666">=</span> [<span style="color: #666666">-0.75</span>, <span style="color: #666666">-0.4</span>]
</pre></div>

</div>
</section>


<section>
<h2 id="___sec78">Shortcomings of the class </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
This code

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">a <span style="color: #666666">=</span> I(<span style="color: #666666">4</span>,<span style="color: #666666">5</span>)
q <span style="color: #666666">=</span> <span style="color: #666666">2</span>
b <span style="color: #666666">=</span> a<span style="color: #666666">*</span>q
</pre></div>
<p>
leads to

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%">  File &quot;IntervalMath.py&quot;, line 15, in __mul__
    a, b, c, d = self.lo, self.up, other.lo, other.up
AttributeError: &#39;float&#39; object has no attribute &#39;lo&#39;
</pre></div>
<p>
Problem: <code>IntervalMath</code> times <code>int</code> is not defined.

<p>
Remedy: (cf. class <code>Complex</code>)

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">IntervalArithmetics</span>:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__mul__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(other, (<span style="color: #008000">int</span>, <span style="color: #008000">float</span>)):      <span style="color: #408080; font-style: italic"># NEW</span>
            other <span style="color: #666666">=</span> IntervalMath(other, other)   <span style="color: #408080; font-style: italic"># NEW</span>
        a, b, c, d <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>lo, <span style="color: #008000">self</span><span style="color: #666666">.</span>up, other<span style="color: #666666">.</span>lo, other<span style="color: #666666">.</span>up
        <span style="color: #008000; font-weight: bold">return</span> IntervalMath(<span style="color: #008000">min</span>(a<span style="color: #666666">*</span>c, a<span style="color: #666666">*</span>d, b<span style="color: #666666">*</span>c, b<span style="color: #666666">*</span>d),
                            <span style="color: #008000">max</span>(a<span style="color: #666666">*</span>c, a<span style="color: #666666">*</span>d, b<span style="color: #666666">*</span>c, b<span style="color: #666666">*</span>d))
</pre></div>
<p>
(with similar adjustments of other special methods)
</div>
</section>


<section>
<h2 id="___sec79">More shortcomings of the class </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Try to compute <code>g = 2*y0*T**(-2)</code>:
multiplication of <code>int</code> (2) and
<code>IntervalMath</code> (<code>y0</code>),
and power operation <code>T**(-2)</code> are not defined
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">IntervalArithmetics</span>:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__rmul__</span>(<span style="color: #008000">self</span>, other):
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(other, (<span style="color: #008000">int</span>, <span style="color: #008000">float</span>)):
            other <span style="color: #666666">=</span> IntervalMath(other, other)
        <span style="color: #008000; font-weight: bold">return</span> other<span style="color: #666666">*</span><span style="color: #008000">self</span>

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__pow__</span>(<span style="color: #008000">self</span>, exponent):
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">isinstance</span>(exponent, <span style="color: #008000">int</span>):
            p <span style="color: #666666">=</span> <span style="color: #666666">1</span>
            <span style="color: #008000; font-weight: bold">if</span> exponent <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>:
                <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(exponent):
                    p <span style="color: #666666">=</span> p<span style="color: #666666">*</span><span style="color: #008000">self</span>
            <span style="color: #008000; font-weight: bold">elif</span> exponent <span style="color: #666666">&lt;</span> <span style="color: #666666">0</span>:
                <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">-</span>exponent):
                    p <span style="color: #666666">=</span> p<span style="color: #666666">*</span><span style="color: #008000">self</span>
                p <span style="color: #666666">=</span> <span style="color: #666666">1/</span>p
            <span style="color: #008000; font-weight: bold">else</span>:   <span style="color: #408080; font-style: italic"># exponent == 0</span>
                p <span style="color: #666666">=</span> IntervalMath(<span style="color: #666666">1</span>, <span style="color: #666666">1</span>)
            <span style="color: #008000; font-weight: bold">return</span> p
        <span style="color: #008000; font-weight: bold">else</span>:
            <span style="color: #008000; font-weight: bold">raise</span> <span style="color: #D2413A; font-weight: bold">TypeError</span>(<span style="color: #BA2121">&#39;exponent must int&#39;</span>)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec80">Adding more functionality to the class: rounding </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
&quot;Rounding&quot; to the midpoint value:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> a <span style="color: #666666">=</span> IntervalMath(<span style="color: #666666">5</span>,<span style="color: #666666">7</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000">float</span>(a)
<span style="color: #666666">6</span>
</pre></div>
<p>
is achieved by

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">IntervalArithmetics</span>:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__float__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0.5*</span>(<span style="color: #008000">self</span><span style="color: #666666">.</span>lo <span style="color: #666666">+</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>up)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec81">Adding more functionality to the class: repr and str methods </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">IntervalArithmetics</span>:
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__str__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39;[</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">, </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">]&#39;</span> <span style="color: #666666">%</span> (<span style="color: #008000">self</span><span style="color: #666666">.</span>lo, <span style="color: #008000">self</span><span style="color: #666666">.</span>up)

    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">__repr__</span>(<span style="color: #008000">self</span>):
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">(</span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">, </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">)&#39;</span> <span style="color: #666666">%</span> \
          (<span style="color: #008000">self</span><span style="color: #666666">.</span>__class__<span style="color: #666666">.</span>__name__, <span style="color: #008000">self</span><span style="color: #666666">.</span>lo, <span style="color: #008000">self</span><span style="color: #666666">.</span>up)
</pre></div>

</div>
</section>


<section>
<h2 id="___sec82">Demonstrating the class: \( g=2y_0T^{-2} \) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> g <span style="color: #666666">=</span> <span style="color: #666666">9.81</span>
<span style="color: #666666">&gt;&gt;&gt;</span> y_0 <span style="color: #666666">=</span> I(<span style="color: #666666">0.99</span>, <span style="color: #666666">1.01</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> Tm <span style="color: #666666">=</span> <span style="color: #666666">0.45</span>                 <span style="color: #408080; font-style: italic"># mean T</span>
<span style="color: #666666">&gt;&gt;&gt;</span> T <span style="color: #666666">=</span> I(Tm<span style="color: #666666">*0.95</span>, Tm<span style="color: #666666">*1.05</span>)   <span style="color: #408080; font-style: italic"># 10% uncertainty</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> T
[<span style="color: #666666">0.4275</span>, <span style="color: #666666">0.4725</span>]
<span style="color: #666666">&gt;&gt;&gt;</span> g <span style="color: #666666">=</span> <span style="color: #666666">2*</span>y_0<span style="color: #666666">*</span>T<span style="color: #666666">**</span>(<span style="color: #666666">-2</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> g
IntervalMath(<span style="color: #666666">8.86873</span>, <span style="color: #666666">11.053</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #408080; font-style: italic"># computing with mean values:</span>
<span style="color: #666666">&gt;&gt;&gt;</span> T <span style="color: #666666">=</span> <span style="color: #008000">float</span>(T)
<span style="color: #666666">&gt;&gt;&gt;</span> y <span style="color: #666666">=</span> <span style="color: #666666">1</span>
<span style="color: #666666">&gt;&gt;&gt;</span> g <span style="color: #666666">=</span> <span style="color: #666666">2*</span>y_0<span style="color: #666666">*</span>T<span style="color: #666666">**</span>(<span style="color: #666666">-2</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%.2f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> g
<span style="color: #666666">9.88</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec83">Demonstrating the class: volume of a sphere </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="font-size: 80%; line-height: 125%"><span style="color: #666666">&gt;&gt;&gt;</span> R <span style="color: #666666">=</span> I(<span style="color: #666666">6*0.9</span>, <span style="color: #666666">6*1.1</span>)   <span style="color: #408080; font-style: italic"># 20 % error</span>
<span style="color: #666666">&gt;&gt;&gt;</span> V <span style="color: #666666">=</span> (<span style="color: #666666">4./3</span>)<span style="color: #666666">*</span>pi<span style="color: #666666">*</span>R<span style="color: #666666">**3</span>
<span style="color: #666666">&gt;&gt;&gt;</span> V
IntervalMath(<span style="color: #666666">659.584</span>, <span style="color: #666666">1204.26</span>)
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> V
[<span style="color: #666666">659.584</span>, <span style="color: #666666">1204.26</span>]
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> <span style="color: #008000">float</span>(V)
<span style="color: #666666">931.922044761</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #408080; font-style: italic"># compute with mean values:</span>
<span style="color: #666666">&gt;&gt;&gt;</span> R <span style="color: #666666">=</span> <span style="color: #008000">float</span>(R)
<span style="color: #666666">&gt;&gt;&gt;</span> V <span style="color: #666666">=</span> (<span style="color: #666666">4./3</span>)<span style="color: #666666">*</span>pi<span style="color: #666666">*</span>R<span style="color: #666666">**3</span>
<span style="color: #666666">&gt;&gt;&gt;</span> <span style="color: #008000; font-weight: bold">print</span> V
<span style="color: #666666">904.778684234</span>
</pre></div>

</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
20% uncertainty in \( R \) gives almost 60% uncertainty in \( V \)
</div>
</section>



</div> <!-- class="slides" -->
</div> <!-- class="reveal" -->

<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.min.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

    // Display navigation controls in the bottom right corner
    controls: true,

    // Display progress bar (below the horiz. slider)
    progress: true,

    // Display the page number of the current slide
    slideNumber: true,

    // Push each slide change to the browser history
    history: false,

    // Enable keyboard shortcuts for navigation
    keyboard: true,

    // Enable the slide overview mode
    overview: true,

    // Vertical centering of slides
    //center: true,
    center: false,

    // Enables touch navigation on devices with touch input
    touch: true,

    // Loop the presentation
    loop: false,

    // Change the presentation direction to be RTL
    rtl: false,

    // Turns fragments on and off globally
    fragments: true,

    // Flags if the presentation is running in an embedded mode,
    // i.e. contained within a limited portion of the screen
    embedded: false,

    // Number of milliseconds between automatically proceeding to the
    // next slide, disabled when set to 0, this value can be overwritten
    // by using a data-autoslide attribute on your slides
    autoSlide: 0,

    // Stop auto-sliding after user input
    autoSlideStoppable: true,

    // Enable slide navigation via mouse wheel
    mouseWheel: false,

    // Hides the address bar on mobile devices
    hideAddressBar: true,

    // Opens links in an iframe preview overlay
    previewLinks: false,

    // Transition style
    transition: 'default', // default/cube/page/concave/zoom/linear/fade/none

    // Transition speed
    transitionSpeed: 'default', // default/fast/slow

    // Transition style for full page slide backgrounds
    backgroundTransition: 'default', // default/none/slide/concave/convex/zoom

    // Number of slides away from the current that are visible
    viewDistance: 3,

    // Parallax background image
    //parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

    // Parallax background size
    //parallaxBackgroundSize: '' // CSS syntax, e.g. "2100px 900px"

    theme: Reveal.getQueryHash().theme, // available themes are in reveal.js/css/theme
    transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/none

});

Reveal.initialize({
    dependencies: [
        // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
        { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },

        // Interpret Markdown in <section> elements
        { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },

        // Syntax highlight for <code> elements
        { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },

        // Zoom in and out with Alt+click
        { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },

        // Speaker notes
        { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },

        // Remote control your reveal.js presentation using a touch device
        //{ src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } },

        // MathJax
        //{ src: 'reveal.js/plugin/math/math.js', async: true }
    ]
});

Reveal.initialize({

    // The "normal" size of the presentation, aspect ratio will be preserved
    // when the presentation is scaled to fit different resolutions. Can be
    // specified using percentage units.
    width: 1170,  // original: 960,
    height: 700,

    // Factor of the display size that should remain empty around the content
    margin: 0.1,

    // Bounds for smallest/largest possible scale to apply to content
    minScale: 0.2,
    maxScale: 1.0

});
</script>

<!-- begin footer logo
<div style="position: absolute; bottom: 0px; left: 0; margin-left: 0px">
<img src="somelogo.png">
</div>
     end footer logo -->



</body>
</html>
