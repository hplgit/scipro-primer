<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Ch.5: Array computing and curve plotting">

<title>Ch.5: Array computing and curve plotting</title>


<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
code { padding: 0px; background-color: inherit; }
pre {
  border: 0pt solid #93a1a1;
  box-shadow: none;
}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [(u'Goal: learn to visualize functions', 2, None, '___sec0'),
              (u'We need to learn about a new object: array',
               2,
               None,
               '___sec1'),
              (u'The minimal need-to-know about vectors', 2, None, '___sec2'),
              (u'The minimal need-to-know about arrays', 2, None, '___sec3'),
              (u'Storing (x,y) points on a curve in lists',
               2,
               None,
               '___sec4'),
              (u'Make arrays directly (instead of lists)',
               2,
               None,
               '___sec5'),
              (u'Arrays are not as flexible as list, but computational much more efficient',
               2,
               None,
               '___sec6'),
              (u'We can work with entire arrays at once - instead of one element at a time',
               2,
               None,
               '___sec7'),
              (u'Operating on entire arrays at once is called *vectorization*',
               2,
               None,
               '___sec8'),
              (u'A function `f(x)` written for a number `x` usually works for array `x` too',
               2,
               None,
               '___sec9'),
              (u'Array arithmetics is broken down to a series of unary/binary array operations',
               2,
               None,
               '___sec10'),
              (u'Very important application: vectorized code for computing points along a curve',
               2,
               None,
               '___sec11'),
              (u'New term: vectorization', 2, None, '___sec12'),
              (u'Plotting the curve of a function: the very basics',
               2,
               None,
               '___sec13'),
              (u'A plot should have labels on axis and a title',
               2,
               None,
               '___sec14'),
              (u'The code that makes the last plot', 2, None, '___sec15'),
              (u'SciTools vs. NumPy and Matplotlib', 2, None, '___sec16'),
              (u"Easyviz (imported from `scitools.std`) allows a more compact ``Pythonic'' syntax for plotting curves",
               2,
               None,
               '___sec17'),
              (u'Plotting several curves in one plot', 2, None, '___sec18'),
              (u'Alternative, more compact plot command',
               2,
               None,
               '___sec19'),
              (u'The resulting plot with two curves', 2, None, '___sec20'),
              (u'Controlling line styles', 2, None, '___sec21'),
              (u'Quick plotting with minimal typing', 2, None, '___sec22'),
              (u'Plot function given on the command line',
               2,
               None,
               '___sec23'),
              (u'Solution', 2, None, '___sec24'),
              (u"Let's make a movie/animation", 2, None, '___sec25'),
              (u'The Gaussian/bell function', 2, None, '___sec26'),
              (u'Movies are made from a (large) set of individual plots',
               2,
               None,
               '___sec27'),
              (u'The complete code for making the animation',
               2,
               None,
               '___sec28'),
              (u'How to combine plot files to a movie (video file)',
               2,
               None,
               '___sec29'),
              (u'Make and play animated GIF file', 2, None, '___sec30'),
              (u'Making MP4, Ogg, WebM, or Flash videos',
               2,
               None,
               '___sec31'),
              (u'How to play movie files in general (with vlc)',
               2,
               None,
               '___sec32'),
              (u'HTML PNG file player', 2, None, '___sec33'),
              (u'It is possible to plot curves in pure text (!)',
               2,
               None,
               '___sec34'),
              (u"Let's try to plot a discontinuous function",
               2,
               None,
               '___sec35'),
              (u'Plotting the Heaviside function: first try',
               2,
               None,
               '___sec36'),
              (u'`if x < 0` does not work if `x` is array',
               2,
               None,
               '___sec37'),
              (u'`if x < 0` does not work if `x` is array',
               2,
               None,
               '___sec38'),
              (u'`if x < 0` does not work if `x` is array',
               2,
               None,
               '___sec39'),
              (u'Back to plotting the Heaviside function',
               2,
               None,
               '___sec40'),
              (u'How to make the function look discontinuous in the plot?',
               2,
               None,
               '___sec41'),
              (u'The final plot of the discontinuous Heaviside function',
               2,
               None,
               '___sec42'),
              (u'Removing the vertical jump from the plot',
               2,
               None,
               '___sec43'),
              (u'Some functions are challenging to visualize',
               2,
               None,
               '___sec44'),
              (u'Plot based on 10 points', 2, None, '___sec45'),
              (u'Plot based on 1000 points', 2, None, '___sec46'),
              (u'Assignment of an array does not copy the elements!',
               2,
               None,
               '___sec47'),
              (u'In-place array arithmetics', 2, None, '___sec48'),
              (u'In-place array arithmetics can save memory demands',
               2,
               None,
               '___sec49'),
              (u'In-place arithmetics only saves memory, no significant speed-up',
               2,
               None,
               '___sec50'),
              (u'Useful array operations', 2, None, '___sec51'),
              (u'Example: vectorizing a constant function',
               2,
               None,
               '___sec52'),
              (u'Generalized array indexing', 2, None, '___sec53'),
              (u'Generalized array indexing with boolean expressions',
               2,
               None,
               '___sec54'),
              (u'Two-dimensional arrays; math intro', 2, None, '___sec55'),
              (u'Two-dimensional arrays; Python code', 2, None, '___sec56'),
              (u'From nested list to two-dimensional array',
               2,
               None,
               '___sec57'),
              (u'How to loop over two-dimensional arrays',
               2,
               None,
               '___sec58'),
              (u'How to take slices of two-dimensional arrays',
               2,
               None,
               '___sec59'),
              (u'Time for a question', 2, None, '___sec60'),
              (u'Summary of vectors and arrays', 2, None, '___sec61'),
              (u'Summary of plotting $y=f(x)$ curves', 2, None, '___sec62'),
              (u'Alternativ plotting of $y=f(x)$ curves',
               2,
               None,
               '___sec63'),
              (u'Summary of making animations', 2, None, '___sec64'),
              (u'Array functionality', 2, None, '___sec65'),
              (u'Summarizing example: animating a function (part 1)',
               2,
               None,
               '___sec66'),
              (u'Summarizing example: animating a function (part 2)',
               2,
               None,
               '___sec67')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- ------------------- main content ---------------------- -->



<center><h1>Ch.5: Array computing and curve plotting</h1></center>  <!-- document title -->

<p>
<!-- author(s): Hans Petter Langtangen -->

<center>
<b>Hans Petter Langtangen</b> [1, 2]
</center>

<p>
<!-- institution(s) -->

<center>[1] <b>Simula Research Laboratory</b></center>
<center>[2] <b>University of Oslo, Dept. of Informatics</b></center>
<br>
<p>
<center><h4>Aug 15, 2015</h4></center> <!-- date -->
<br>
<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec0">Goal: learn to visualize functions </h2>

<p>
<center><p><img src="fig-plot/comic_plot.png" align="bottom" width=600></p></center>

<p>
<!-- FIGURE: [fig-plot/plot2a_pylab.png, width=600 frac=0.9] -->

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec1">We need to learn about a new object: array </h2>

<p>
<!-- !bpop -->
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <li> Curves \( y=f(x) \) are visualized by drawing straight lines between points along the curve</li>
  <li> Meed to store the coordinates of the points along the curve in lists or <em>arrays</em> <code>x</code> and <code>y</code></li>
  <li> Arrays \( \approx \) lists, but computationally much more efficient</li>
  <li> To compute the <code>y</code> coordinates (in an array) we need to learn about <em>array computations</em> or <em>vectorization</em></li>
  <li> Array computations are useful for much more than plotting curves!</li>
</ul>
</div>

<!-- !epop -->

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec2">The minimal need-to-know about vectors </h2>

<p>
<!-- !bpop -->
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <li> Vectors are known from high school mathematics, e.g., <br />
    point \( (x,y) \) in the plane, point \( (x,y,z) \) in space</li>
  <li> In general, a vector \( v \) is an \( n \)-tuple of numbers:<br />
    \( v=(v_0,\ldots,v_{n-1}) \)</li>
  <li> Vectors can be represented by lists: \( v_i \) is stored as <code>v[i]</code>,<br />
    but we shall use arrays instead</li>
</ul>
</div>

<!-- !epop -->

<p>
<!-- !bpop -->
<div class="alert alert-block alert-block alert-text-small">
<b></b>
<p>
Vectors and arrays are key concepts in this chapter. It takes separate math courses to understand what vectors and arrays really are, but in this course we only need a small subset of the complete story. A learning strategy may be to just start using vectors/arrays in programs and later, if necessary, go back to the more mathematical details in the first part of Ch. 5.
</div>

<!-- !epop -->

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec3">The minimal need-to-know about arrays </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Arrays are a generalization of vectors where we can have multiple indices: \( A_{i,j} \), \( A_{i,j,k} \)

<p>
Example: table of numbers, one index for the row, one for the column

$$
\left\lbrack\begin{array}{cccc}
0 & 12 & -1 & 5\\
-1 & -1 & -1 & 0\\
11 & 5 & 5 & -2
\end{array}\right\rbrack
\hspace{1cm}
A =
\left\lbrack\begin{array}{ccc}
A_{0,0} & \cdots &  A_{0,n-1}\\
\vdots & \ddots &  \vdots\\
A_{m-1,0} & \cdots & A_{m-1,n-1}
\end{array}\right\rbrack
$$
</div>


<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <li> The no of indices in an array is the <em>rank</em> or <em>number of dimensions</em></li>
  <li> Vector = one-dimensional array, or rank 1 array</li>
  <li> In Python code, we use Numerical Python arrays instead of nested lists to represent mathematical arrays (because this is computationally more efficient)</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec4">Storing (x,y) points on a curve in lists </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Collect points on a function curve \( y=f(x) \) in lists:</b>
<p>

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; <span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">f</span>(x):
...     <span style="color: #8B008B; font-weight: bold">return</span> x**<span style="color: #B452CD">3</span>
...
&gt;&gt;&gt; n = <span style="color: #B452CD">5</span>                 <span style="color: #228B22"># no of points</span>
&gt;&gt;&gt; dx = <span style="color: #B452CD">1.0</span>/(n-<span style="color: #B452CD">1</span>)        <span style="color: #228B22"># x spacing in [0,1]</span>
&gt;&gt;&gt; xlist = [i*dx <span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> <span style="color: #658b00">range</span>(n)]
&gt;&gt;&gt; ylist = [f(x) <span style="color: #8B008B; font-weight: bold">for</span> x <span style="color: #8B008B">in</span> xlist]

&gt;&gt;&gt; pairs = [[x, y] <span style="color: #8B008B; font-weight: bold">for</span> x, y <span style="color: #8B008B">in</span> <span style="color: #658b00">zip</span>(xlist, ylist)]
</pre></div>

</div>


<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Turn lists into Numerical Python (NumPy) arrays:</b>
<p>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; <span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">np</span>        <span style="color: #228B22"># module for arrays</span>
&gt;&gt;&gt; x = np.array(xlist)      <span style="color: #228B22"># turn list xlist into array</span>
&gt;&gt;&gt; y = np.array(ylist)
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec5">Make arrays directly (instead of lists) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>The pro drops lists and makes NumPy arrays directly:</b>
<p>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; n = <span style="color: #B452CD">5</span>                     <span style="color: #228B22"># number of points</span>
&gt;&gt;&gt; x = np.linspace(<span style="color: #B452CD">0</span>, <span style="color: #B452CD">1</span>, n) <span style="color: #228B22"># n points in [0, 1]</span>
&gt;&gt;&gt; y = np.zeros(n)          <span style="color: #228B22"># n zeros (float data type)</span>
&gt;&gt;&gt; <span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> <span style="color: #658b00">xrange</span>(n):
...     y[i] = f(x[i])
...
</pre></div>
<p>
Note:

<ul>
  <li> <code>xrange</code> is like <code>range</code> but faster
    (esp. for large <code>n</code> - <code>xrange</code> does not explicitly build
    a list of integers, <code>xrange</code> just lets you loop over the values)</li>
  <li> Entire arrays must be made by <code>numpy</code> (<code>np</code>) functions</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec6">Arrays are not as flexible as list, but computational much more efficient </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <li> List elements can be <em>any</em> Python objects</li>
  <li> Array elements can only be of <em>one object type</em></li>
  <li> Arrays are very efficient to store in memory and compute with<br />
    if the element type is <code>float</code>, <code>int</code>, or <code>complex</code></li>
  <li> Rule: use arrays for sequences of numbers!</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec7">We can work with entire arrays at once - instead of one element at a time </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Compute the sine of an array:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">math</span> <span style="color: #8B008B; font-weight: bold">import</span> sin

<span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> <span style="color: #658b00">xrange</span>(<span style="color: #658b00">len</span>(x)):
    y[i] = sin(x[i])
</pre></div>
<p>
However, if <code>x</code> is array, <code>y</code> can be computed by

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">y = np.sin(x)                  <span style="color: #228B22"># x: array, y: array</span>
</pre></div>
<p>
The loop is now inside <code>np.sin</code> and implemented in very efficient C code.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec8">Operating on entire arrays at once is called <em>vectorization</em> </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Vectorization gives:</b>
<p>

<ul>
  <li> shorter, more readable code, closer to the mathematics</li>
  <li> much faster code</li>
</ul>
</div>


<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Use <code>%timeit</code> in IPython to measure the speed-up for \( y=\sin x e^{-x} \):</b>
<p>
<p>

<!-- code=ipy (!bc ipy) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #555555">In [1]: </span>n = <span style="color: #B452CD">100000</span>

<span style="color: #555555">In [2]: </span><span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">np</span>

<span style="color: #555555">In [3]: </span>x = np.linspace(<span style="color: #B452CD">0</span>, <span style="color: #B452CD">2</span>*np.pi, n+<span style="color: #B452CD">1</span>)

<span style="color: #555555">In [4]: </span>y = np.zeros(<span style="color: #658b00">len</span>(x))

<span style="color: #555555">In [5]: </span>%<span style="color: #8B008B; font-weight: bold">timeit</span> for i in xrange(len(x)): \
<span style="color: #888888">        y[i] = np.sin(x[i])*np.exp(-x[i])</span>
<span style="color: #888888">1 loops, best of 3: 247 ms per loop</span>

<span style="color: #555555">In [6]: </span>%<span style="color: #8B008B; font-weight: bold">timeit</span> y = np.sin(x)*np.exp(-x)
<span style="color: #888888">100 loops, best of 3: 4.77 ms per loop</span>

<span style="color: #555555">In [7]: </span><span style="color: #B452CD">247</span>/<span style="color: #B452CD">4.77</span>
<span style="color: #000080; font-weight: bold">Out[7]: </span><span style="color: #888888">51.781970649895186  # vectorization: 50x speed-up!</span>
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec9">A function <code>f(x)</code> written for a number <code>x</code> usually works for array <code>x</code> too </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">import</span> sin, exp, linspace

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">f</span>(x):
    <span style="color: #8B008B; font-weight: bold">return</span> x**<span style="color: #B452CD">3</span> + sin(x)*exp(-<span style="color: #B452CD">3</span>*x)

x = <span style="color: #B452CD">1.2</span>                     <span style="color: #228B22"># float object</span>
y = f(x)                    <span style="color: #228B22"># y is float</span>

x = linspace(<span style="color: #B452CD">0</span>, <span style="color: #B452CD">3</span>, <span style="color: #B452CD">10001</span>)   <span style="color: #228B22"># 10000 intervals in [0,3]</span>
y = f(x)                    <span style="color: #228B22"># y is array</span>
</pre></div>

</div>


<p>
<div class="alert alert-block alert-notice alert-text-normal">
<b>Note: <code>math</code> is for numbers and <code>numpy</code> for arrays.</b>
<p>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; <span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">math</span>, <span style="color: #008b45; text-decoration: underline">numpy</span>
&gt;&gt;&gt; x = numpy.linspace(<span style="color: #B452CD">0</span>, <span style="color: #B452CD">1</span>, <span style="color: #B452CD">11</span>)
&gt;&gt;&gt; math.sin(x[<span style="color: #B452CD">3</span>])
<span style="color: #B452CD">0.2955202066613396</span>
&gt;&gt;&gt; math.sin(x)
...
<span style="color: #008b45; font-weight: bold">TypeError</span>: only length-<span style="color: #B452CD">1</span> arrays can be converted to Python scalars
&gt;&gt;&gt; numpy.sin(x)
array([ <span style="color: #B452CD">0.</span>     ,  <span style="color: #B452CD">0.09983</span>,  <span style="color: #B452CD">0.19866</span>,  <span style="color: #B452CD">0.29552</span>,  <span style="color: #B452CD">0.38941</span>,
        <span style="color: #B452CD">0.47942</span>,  <span style="color: #B452CD">0.56464</span>,  <span style="color: #B452CD">0.64421</span>,  <span style="color: #B452CD">0.71735</span>,  <span style="color: #B452CD">0.78332</span>,
        <span style="color: #B452CD">0.84147</span>])
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec10">Array arithmetics is broken down to a series of unary/binary array operations </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <li> Consider <code>y = f(x)</code>, where <code>f</code> returns <code>x**3 + sin(x)*exp(-3*x)</code></li>
 <li> <code>f(x)</code> leads to the following set of vectorized sub-computations:</li>

<ol>
  <li> <code>r1 = x**3</code> <br />
     <code>for i in range(len(x)): r1[i] = x[i]**3</code> <br />
     (but with loop in C)</li>
  <li> <code>r2 = sin(x)</code> (computed elementwise in C)</li>
  <li> <code>r3 = -3*x</code></li>
  <li> <code>r4 = exp(r3)</code></li>
  <li> <code>r5 = r3*r4</code></li>
  <li> <code>r6 = r1 + r5</code></li>
  <li> <code>y = r6</code></li>
</ol>

 <li> Note: this is the same set of operations as you would do with a calculator
   when <code>x</code> is a number</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec11">Very important application: vectorized code for computing points along a curve </h2>

$$ f(x) = x^2e^{-\frac{1}{2}x}\sin(x-\frac{1}{3}\pi),\quad x\in [0, 4\pi]$$

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Vectorized computation of \( n+1 \) points along the curve.</b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">import</span> *

n = <span style="color: #B452CD">100</span>
x = linspace(<span style="color: #B452CD">0</span>, <span style="color: #B452CD">4</span>*pi, n+<span style="color: #B452CD">1</span>)
y = <span style="color: #B452CD">2.5</span> + x**<span style="color: #B452CD">2</span>*exp(-<span style="color: #B452CD">0.5</span>*x)*sin(x-pi/<span style="color: #B452CD">3</span>)
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec12">New term: vectorization </h2>

<p>
<!-- !bpop -->
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <li> <em>Scalar</em>: a number</li>
  <li> <em>Vector</em> or <em>array</em>: sequence of numbers (vector in mathematics)</li>
  <li> We speak about scalar computations (one number at a time) versus
    vectorized computations (operations on entire arrays, no Python loops)</li>
</ul>
</div>


<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <li> <em>Vectorized functions</em> can operate on arrays (vectors)</li>
  <li> <em>Vectorization</em> is the process of turning a non-vectorized algorithm with (Python) loops into a vectorized version without (Python) loops</li>
  <li> Mathematical functions in Python without <code>if</code> tests automatically work for both scalar and vector (array) arguments (i.e., no vectorization is needed by the programmer)</li>
</ul>
</div>

<!-- !epop -->

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec13">Plotting the curve of a function: the very basics </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Plot the curve of \( y(t) = t^2e^{-t^2} \):</b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">scitools.std</span> <span style="color: #8B008B; font-weight: bold">import</span> *  <span style="color: #228B22"># import numpy and plotting</span>

<span style="color: #228B22"># Make points along the curve</span>
t = linspace(<span style="color: #B452CD">0</span>, <span style="color: #B452CD">3</span>, <span style="color: #B452CD">51</span>)      <span style="color: #228B22"># 50 intervals in [0, 3]</span>
y = t**<span style="color: #B452CD">2</span>*exp(-t**<span style="color: #B452CD">2</span>)         <span style="color: #228B22"># vectorized expression</span>

plot(t, y)           <span style="color: #228B22"># make plot on the screen</span>
savefig(<span style="color: #CD5555">&#39;fig.pdf&#39;</span>)   <span style="color: #228B22"># make PDF image for reports</span>
savefig(<span style="color: #CD5555">&#39;fig.png&#39;</span>)   <span style="color: #228B22"># make PNG image for web pages</span>
</pre></div>

</div>


<p>
<center><p><img src="fig-plot/plot1a_pylab.png" align="bottom" width=300></p></center>

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec14">A plot should have labels on axis and a title </h2>

<p>
<center><p><img src="fig-plot/plot1c_pylab.png" align="bottom" width=600></p></center>

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec15">The code that makes the last plot </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">scitools.std</span> <span style="color: #8B008B; font-weight: bold">import</span> *  <span style="color: #228B22"># import numpy and plotting</span>

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">f</span>(t):
    <span style="color: #8B008B; font-weight: bold">return</span> t**<span style="color: #B452CD">2</span>*exp(-t**<span style="color: #B452CD">2</span>)

t = linspace(<span style="color: #B452CD">0</span>, <span style="color: #B452CD">3</span>, <span style="color: #B452CD">51</span>)    <span style="color: #228B22"># t coordinates</span>
y = f(t)                  <span style="color: #228B22"># corresponding y values</span>

plot(t, y)

xlabel(<span style="color: #CD5555">&#39;t&#39;</span>)               <span style="color: #228B22"># label on the x axis</span>
ylabel(<span style="color: #CD5555">&#39;y&#39;</span>)               <span style="color: #228B22"># label on the y axix</span>
legend(<span style="color: #CD5555">&#39;t^2*exp(-t^2)&#39;</span>)   <span style="color: #228B22"># mark the curve</span>
axis([<span style="color: #B452CD">0</span>, <span style="color: #B452CD">3</span>, -<span style="color: #B452CD">0.05</span>, <span style="color: #B452CD">0.6</span>])  <span style="color: #228B22"># [tmin, tmax, ymin, ymax]</span>
title(<span style="color: #CD5555">&#39;My First Easyviz Demo&#39;</span>)
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec16">SciTools vs. NumPy and Matplotlib </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <li> SciTools is a Python package with lots of useful tools for mathematical computations, developed here in Oslo (Langtangen, Ring, Wilbers, Bredesen, ...)</li>
  <li> Easyviz is a subpackage of SciTools (<code>scitools.easyviz</code>) doing plotting with Matlab-like syntax</li>
  <li> Easyviz can use many plotting engine to produce a plot: Matplotlib, Gnuplot, Grace, Matlab, VTK, OpenDx, ... but the syntax remains the same</li>
  <li> Matplotlib is the standard plotting package in the Python community - Easyviz can use the same syntax as Matplotlib</li>
</ul>

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">scitools.std</span> <span style="color: #8B008B; font-weight: bold">import</span> *

<span style="color: #228B22"># is basically equivalent to</span>

<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">import</span> *
<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #8B008B; font-weight: bold">import</span> *
</pre></div>
<p>
Note: SciTools (by default) adds markers to the lines, Matplotlib does not
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec17">Easyviz (imported from <code>scitools.std</code>) allows a more compact &quot;Pythonic&quot; syntax for plotting curves </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Use keyword arguments instead of separate function calls:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">plot(t, y,
     xlabel=<span style="color: #CD5555">&#39;t&#39;</span>,
     ylabel=<span style="color: #CD5555">&#39;y&#39;</span>,
     legend=<span style="color: #CD5555">&#39;t^2*exp(-t^2)&#39;</span>,
     axis=[<span style="color: #B452CD">0</span>, <span style="color: #B452CD">3</span>, -<span style="color: #B452CD">0.05</span>, <span style="color: #B452CD">0.6</span>],
     title=<span style="color: #CD5555">&#39;My First Easyviz Demo&#39;</span>,
     savefig=<span style="color: #CD5555">&#39;tmp1.png&#39;</span>,
     show=<span style="color: #658b00">True</span>)   <span style="color: #228B22"># display on the screen (default)</span>
</pre></div>
<p>
(This cannot be done with Matplotlib.)
</div>


<p>
<center><p><img src="fig-plot/plot1c_pylab.png" align="bottom" width=300></p></center>

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec18">Plotting several curves in one plot </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Plot \( t^2e^{-t^2} \) and \( t^4e^{-t^2} \) in the same plot:</b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">scitools.std</span> <span style="color: #8B008B; font-weight: bold">import</span> *   <span style="color: #228B22"># curve plotting + array computing</span>

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">f1</span>(t):
    <span style="color: #8B008B; font-weight: bold">return</span> t**<span style="color: #B452CD">2</span>*exp(-t**<span style="color: #B452CD">2</span>)

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">f2</span>(t):
    <span style="color: #8B008B; font-weight: bold">return</span> t**<span style="color: #B452CD">2</span>*f1(t)

t = linspace(<span style="color: #B452CD">0</span>, <span style="color: #B452CD">3</span>, <span style="color: #B452CD">51</span>)
y1 = f1(t)
y2 = f2(t)

plot(t, y1)
hold(<span style="color: #CD5555">&#39;on&#39;</span>)   <span style="color: #228B22"># continue plotting in the same plot</span>
plot(t, y2)

xlabel(<span style="color: #CD5555">&#39;t&#39;</span>)
ylabel(<span style="color: #CD5555">&#39;y&#39;</span>)
legend(<span style="color: #CD5555">&#39;t^2*exp(-t^2)&#39;</span>, <span style="color: #CD5555">&#39;t^4*exp(-t^2)&#39;</span>)
title(<span style="color: #CD5555">&#39;Plotting two curves in the same plot&#39;</span>)
savefig(<span style="color: #CD5555">&#39;tmp2.png&#39;</span>)
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec19">Alternative, more compact plot command </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">plot(t, y1, t, y2,
     xlabel=<span style="color: #CD5555">&#39;t&#39;</span>, ylabel=<span style="color: #CD5555">&#39;y&#39;</span>,
     legend=(<span style="color: #CD5555">&#39;t^2*exp(-t^2)&#39;</span>, <span style="color: #CD5555">&#39;t^4*exp(-t^2)&#39;</span>),
     title=<span style="color: #CD5555">&#39;Plotting two curves in the same plot&#39;</span>,
     savefig=<span style="color: #CD5555">&#39;tmp2.pdf&#39;</span>)

<span style="color: #228B22"># equivalent to</span>
plot(t, y1)
hold(<span style="color: #CD5555">&#39;on&#39;</span>)
plot(t, y2)

xlabel(<span style="color: #CD5555">&#39;t&#39;</span>)
ylabel(<span style="color: #CD5555">&#39;y&#39;</span>)
legend(<span style="color: #CD5555">&#39;t^2*exp(-t^2)&#39;</span>, <span style="color: #CD5555">&#39;t^4*exp(-t^2)&#39;</span>)
title(<span style="color: #CD5555">&#39;Plotting two curves in the same plot&#39;</span>)
savefig(<span style="color: #CD5555">&#39;tmp2.pdf&#39;</span>)
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec20">The resulting plot with two curves </h2>

<p>
<center><p><img src="fig-plot/plot2a_pylab.png" align="bottom" width=600></p></center>

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec21">Controlling line styles </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
When plotting multiple curves in the same plot, the different lines (normally) look different. We can control the line type and color, if desired:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">plot(t, y1, <span style="color: #CD5555">&#39;r-&#39;</span>)   <span style="color: #228B22"># red (r) line (-)</span>
hold(<span style="color: #CD5555">&#39;on&#39;</span>)
plot(t, y2, <span style="color: #CD5555">&#39;bo&#39;</span>)   <span style="color: #228B22"># blue (b) circles (o)</span>

<span style="color: #228B22"># or</span>
plot(t, y1, <span style="color: #CD5555">&#39;r-&#39;</span>, t, y2, <span style="color: #CD5555">&#39;bo&#39;</span>)
</pre></div>
<p>
Documentation of colors and line styles: see the book, <a href="http://hplgit.github.no/primer.html/doc/pub/plot/plot-bootstrap.html" target="_blank">Ch. 5</a>, or

<p>

<!-- code=text (!bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">Unix&gt; pydoc scitools.easyviz
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec22">Quick plotting with minimal typing </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>A lazy pro would do this:</b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">t = linspace(<span style="color: #B452CD">0</span>, <span style="color: #B452CD">3</span>, <span style="color: #B452CD">51</span>)
plot(t, t**<span style="color: #B452CD">2</span>*exp(-t**<span style="color: #B452CD">2</span>), t, t**<span style="color: #B452CD">4</span>*exp(-t**<span style="color: #B452CD">2</span>))
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec23">Plot function given on the command line </h2>

<p>
<div class="alert alert-block alert-question alert-text-normal">
<b>Task: plot function given on the command line.</b>
<p>
<p>

<!-- code=text (!bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">Terminal&gt; python plotf.py expression xmin xmax
Terminal&gt; python plotf.py &quot;exp(-0.2*x)*sin(2*pi*x)&quot; 0 4*pi
</pre></div>
<p>
Should plot \( e^{-0.2x}\sin (2\pi x) \), \( x\in [0,4\pi] \).
<code>plotf.py</code> should work for &quot;any&quot; mathematical expression.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec24">Solution </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Complete program:</b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">scitools.std</span> <span style="color: #8B008B; font-weight: bold">import</span> *
<span style="color: #228B22"># or alternatively</span>
<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">import</span> *
<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #8B008B; font-weight: bold">import</span> *

formula = sys.argv[<span style="color: #B452CD">1</span>]
xmin = <span style="color: #658b00">eval</span>(sys.argv[<span style="color: #B452CD">2</span>])
xmax = <span style="color: #658b00">eval</span>(sys.argv[<span style="color: #B452CD">3</span>])

x = linspace(xmin, xmax, <span style="color: #B452CD">101</span>)
y = <span style="color: #658b00">eval</span>(formula)
plot(x, y, title=formula)
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec25">Let's make a movie/animation </h2>

<p>
<center><p><img src="fig-plot/plot4_thick.png" align="bottom" width=600></p></center>

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec26">The Gaussian/bell function </h2>

<p>
<!-- !bslidecell 00 -->
$$ f(x; m, s) = {1\over\sqrt{2\pi}}{1\over s}\exp{\left[-{1\over2}\left({x-m\over s}\right)^2\right]} $$

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <li> \( m \) is the location of the peak</li>
  <li> \( s \) is a measure of the width of the function</li>
  <li> Make a movie (animation) of how \( f(x;m,s) \) changes shape as \( s \) goes from 2 to 0.2</li>
</ul>
</div>

<!-- !eslidecell -->

<p>
<!-- !bslidecell 01 -->
<center><p><img src="fig-plot/plot4_thick.png" align="bottom" width=300></p></center>
<!-- !eslidecell -->

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec27">Movies are made from a (large) set of individual plots </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <li> Goal: make a movie showing how \( f(x) \) varies in shape as \( s \) decreases</li>
  <li> Idea: put many plots (for different \( s \) values) together<br />
    (exactly as a cartoon movie)</li>
  <li> How to program: loop over \( s \) values, call <code>plot</code> for each \( s \) and make hardcopy, combine all hardcopies to a movie</li>
  <li> Very important: fix the \( y \) axis! Otherwise, the \( y \) axis always adapts to the peak of the function and the visual impression gets completely wrong</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec28">The complete code for making the animation </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">scitools.std</span> <span style="color: #8B008B; font-weight: bold">import</span> *
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">time</span>

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">f</span>(x, m, s):
    <span style="color: #8B008B; font-weight: bold">return</span> (<span style="color: #B452CD">1.0</span>/(sqrt(<span style="color: #B452CD">2</span>*pi)*s))*exp(-<span style="color: #B452CD">0.5</span>*((x-m)/s)**<span style="color: #B452CD">2</span>)

m = <span style="color: #B452CD">0</span>;  s_start = <span style="color: #B452CD">2</span>;  s_stop = <span style="color: #B452CD">0.2</span>
s_values = linspace(s_start, s_stop, <span style="color: #B452CD">30</span>)

x = linspace(m -<span style="color: #B452CD">3</span>*s_start, m + <span style="color: #B452CD">3</span>*s_start, <span style="color: #B452CD">1000</span>)
<span style="color: #228B22"># f is max for x=m (smaller s gives larger max value)</span>
max_f = f(m, m, s_stop)

<span style="color: #228B22"># Show the movie on the screen</span>
<span style="color: #228B22"># and make hardcopies of frames simultaneously</span>
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">time</span>
frame_counter = <span style="color: #B452CD">0</span>

<span style="color: #8B008B; font-weight: bold">for</span> s <span style="color: #8B008B">in</span> s_values:
    y = f(x, m, s)
    plot(x, y, axis=[x[<span style="color: #B452CD">0</span>], x[-<span style="color: #B452CD">1</span>], -<span style="color: #B452CD">0.1</span>, max_f],
         xlabel=<span style="color: #CD5555">&#39;x&#39;</span>, ylabel=<span style="color: #CD5555">&#39;f&#39;</span>, legend=<span style="color: #CD5555">&#39;s=%4.2f&#39;</span> % s,
         savefig=<span style="color: #CD5555">&#39;tmp_%04d.png&#39;</span> % frame_counter)
    frame_counter += <span style="color: #B452CD">1</span>
    <span style="color: #228B22">#time.sleep(0.2)  # pause to control movie speed</span>
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec29">How to combine plot files to a movie (video file) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We now have a lot of files:

<p>

<!-- code=text typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">tmp_0000.png  tmp_0001.png  tmp_0002.png ...
</pre></div>
<p>
We use some program to combine these files to a video file:

<ul>
 <li> <code>convert</code> for animted GIF format (if just a few plot files)</li>
 <li> <code>ffmpeg</code> (or <code>avconv</code>) for MP4, WebM, Ogg, and Flash formats</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec30">Make and play animated GIF file </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Tool: <code>convert</code> from the ImageMagick software suite.

<p>
Unix command:

<p>

<!-- code=text (!bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">Terminal&gt; convert -delay 50 tmp_*.png movie.gif
</pre></div>
<p>
Delay: 50/100 s, i.e., 0.5 s between each frame.

<p>
Play animated GIF file with <code>animate</code> from ImageMagick:

<p>

<!-- code=text (!bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">Terminal&gt; animate movie.gif
</pre></div>
<p>
or insert this HTML code in some file <code>tmp.html</code> loaded into a browser:

<p>

<!-- code=html (!bc htmlcod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">&lt;img</span> <span style="color: #658b00">src=</span><span style="color: #CD5555">&quot;movie.gif&quot;</span><span style="color: #8B008B; font-weight: bold">&gt;</span>
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec31">Making MP4, Ogg, WebM, or Flash videos </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Tool: <code>ffmpeg</code> or <code>avconv</code>

<p>

<!-- code=text (!bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">Terminal&gt; ffmpeg -r 5 -i tmp_%04d.png -vcodec flv movie.flv
</pre></div>
<p>
where

<ul>
  <li> <code>-r 5</code> specifies 5 frames per second</li>
  <li> <code>-i tmp_%04d.png</code> specifies filenames <br />
    (<code>tmp_0000.png</code>, <code>tmp_0001.png</code>, ...)</li>
</ul>

Different formats apply different codecs (<code>-vcodec</code>) and
video filenamet extensions:

<p>
<!-- Add vertical space -->
<br />

<p>
<table border="1">
<thead>
<tr><th align="center">Format</th> <th align="center">           Codec and filename           </th> </tr>
</thead>
<tbody>
<tr><td align="left">   Flash     </td> <td align="left">   <code>-vcodec flv movie.flv</code>          </td> </tr>
<tr><td align="left">   MP4       </td> <td align="left">   <code>-vcodec libx264 movie.mp4</code>      </td> </tr>
<tr><td align="left">   Webm      </td> <td align="left">   <code>-vcodec libvpx movie.webm</code>      </td> </tr>
<tr><td align="left">   Ogg       </td> <td align="left">   <code>-vcodec libtheora movie.ogg</code>    </td> </tr>
</tbody>
</table>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec32">How to play movie files in general (with vlc) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=text (!bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">Terminal&gt; vlc movie.flv
Terminal&gt; vlc movie.ogg
Terminal&gt; vlc movie.webm
Terminal&gt; vlc movie.mp4
</pre></div>
<p>
Other players (on Linux) are <code>mplayer</code>, <code>totem</code>, ...
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec33">HTML PNG file player </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=text (!bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">Terminal&gt; scitools movie output_file=mymovie.html fps=4 tmp_*.png
</pre></div>
<p>
makes a player of <code>tmp_*.png</code> files in a file <code>mymovie.html</code>
(load into a web browser)
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec34">It is possible to plot curves in pure text (!) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <li> Plots are stored in image files of type PDF and PNG</li>
  <li> Sometimes you want a plot to be included in your program,<br />
    e.g., to prove that the curve looks right in a compulsory exercise where only the program (and not a nicely typeset report) is submitted</li>
  <li> <code>scitools.aplotter</code> can then be used for drawing primitive curves in pure text (ASCII) format</li>
</ul>

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; <span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">scitools.aplotter</span> <span style="color: #8B008B; font-weight: bold">import</span> plot
&gt;&gt;&gt; <span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">import</span> linspace, exp, cos, pi
&gt;&gt;&gt; x = linspace(-<span style="color: #B452CD">2</span>, <span style="color: #B452CD">2</span>, <span style="color: #B452CD">81</span>)
&gt;&gt;&gt; y = exp(-<span style="color: #B452CD">0.5</span>*x**<span style="color: #B452CD">2</span>)*cos(pi*x)
&gt;&gt;&gt; plot(x, y)
</pre></div>
<p>
Try these statements out!
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec35">Let's try to plot a discontinuous function </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The Heaviside function is frequently used in science and engineering:

$$ H(x) = \left\lbrace\begin{array}{ll}
0, & x < 0\\
1, & x\geq 0
\end{array}\right.
$$

<p>
Python implementation:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">H</span>(x):
    <span style="color: #8B008B; font-weight: bold">return</span> (<span style="color: #B452CD">0</span> <span style="color: #8B008B; font-weight: bold">if</span> x &lt; <span style="color: #B452CD">0</span> <span style="color: #8B008B; font-weight: bold">else</span> <span style="color: #B452CD">1</span>)
</pre></div>

</div>


<p>
<center><p><img src="fig-plot/Heaviside3.png" align="bottom" width=300></p></center>

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec36">Plotting the Heaviside function: first try </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Standard approach:</b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">x = linspace(-<span style="color: #B452CD">10</span>, <span style="color: #B452CD">10</span>, <span style="color: #B452CD">5</span>)  <span style="color: #228B22"># few points (simple curve)</span>
y = H(x)
plot(x, y)
</pre></div>
<p>
First problem: <code>ValueError</code> error in <code>H(x)</code> from <code>if x &lt; 0</code>

<p>
Let us debug in an interactive shell:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; x = linspace(-<span style="color: #B452CD">10</span>,<span style="color: #B452CD">10</span>,<span style="color: #B452CD">5</span>)
&gt;&gt;&gt; x
array([-<span style="color: #B452CD">10.</span>,  -<span style="color: #B452CD">5.</span>,   <span style="color: #B452CD">0.</span>,   <span style="color: #B452CD">5.</span>,  <span style="color: #B452CD">10.</span>])
&gt;&gt;&gt; b = x &lt; <span style="color: #B452CD">0</span>
&gt;&gt;&gt; b
array([ <span style="color: #658b00">True</span>,  <span style="color: #658b00">True</span>, <span style="color: #658b00">False</span>, <span style="color: #658b00">False</span>, <span style="color: #658b00">False</span>], dtype=<span style="color: #658b00">bool</span>)
&gt;&gt;&gt; <span style="color: #658b00">bool</span>(b)  <span style="color: #228B22"># evaluate b in a boolean context</span>
...
<span style="color: #008b45; font-weight: bold">ValueError</span>: The truth value of an array <span style="color: #8B008B; font-weight: bold">with</span> more than
one element <span style="color: #8B008B">is</span> ambiguous. Use a.any() <span style="color: #8B008B">or</span> a.all()
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec37"><code>if x &lt; 0</code> does not work if <code>x</code> is array </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Remedy 1: use a loop over <code>x</code> values.</b>
<p>

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">H_loop</span>(x):
    r = zeros(<span style="color: #658b00">len</span>(x))  <span style="color: #228B22"># or r = x.copy()</span>
    <span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> <span style="color: #658b00">xrange</span>(<span style="color: #658b00">len</span>(x)):
        r[i] = H(x[i])
    <span style="color: #8B008B; font-weight: bold">return</span> r

n = <span style="color: #B452CD">5</span>
x = linspace(-<span style="color: #B452CD">5</span>, <span style="color: #B452CD">5</span>, n+<span style="color: #B452CD">1</span>)
y = H_loop(x)
</pre></div>
<p>
Downside: much to write, slow code if <code>n</code> is large
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec38"><code>if x &lt; 0</code> does not work if <code>x</code> is array </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Remedy 2: use <code>vectorize</code>.</b>
<p>

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">import</span> vectorize

<span style="color: #228B22"># Automatic vectorization of function H</span>
Hv = vectorize(H)
<span style="color: #228B22"># Hv(x) works with array x</span>
</pre></div>
<p>
Downside: The resulting function is as slow as Remedy 1
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec39"><code>if x &lt; 0</code> does not work if <code>x</code> is array </h2>

<p>
<!-- !bpop -->
<div class="alert alert-block alert-block alert-text-normal">
<b>Remedy 3: code the <code>if</code> test differently.</b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">Hv</span>(x):
    <span style="color: #8B008B; font-weight: bold">return</span> where(x &lt; <span style="color: #B452CD">0</span>, <span style="color: #B452CD">0.0</span>, <span style="color: #B452CD">1.0</span>)
</pre></div>

</div>

<!-- !epop -->

<p>
<!-- !bpop -->
<div class="alert alert-block alert-block alert-text-normal">
<b>More generally:</b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">f</span>(x):
    <span style="color: #8B008B; font-weight: bold">if</span> condition:
        x = &lt;expression1&gt;
    <span style="color: #8B008B; font-weight: bold">else</span>:
        x = &lt;expression2&gt;
    <span style="color: #8B008B; font-weight: bold">return</span> x

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">f_vectorized</span>(x):
<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">f_vectorized</span>(x):
    x1 = &lt;expression1&gt;
    x2 = &lt;expression2&gt;
    r = np.where(condition, x1, x2)
    <span style="color: #8B008B; font-weight: bold">return</span> r
</pre></div>

</div>

<!-- !epop -->

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec40">Back to plotting the Heaviside function </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
With a vectorized <code>Hv(x)</code> function we can plot in the standard way

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">x = linspace(-<span style="color: #B452CD">10</span>, <span style="color: #B452CD">10</span>, <span style="color: #B452CD">5</span>)   <span style="color: #228B22"># linspace(-10, 10, 50)</span>
y = Hv(x)
plot(x, y, axis=[x[<span style="color: #B452CD">0</span>], x[-<span style="color: #B452CD">1</span>], -<span style="color: #B452CD">0.1</span>, <span style="color: #B452CD">1.1</span>])
</pre></div>

</div>


<p>
<center><p><img src="fig-plot/Heaviside2.png" align="bottom" width=300></p></center>

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec41">How to make the function look discontinuous in the plot? </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <li> Newbie: use a lot of \( x \) points; the curve gets steeper</li>
  <li> Pro: plot just two horizontal line segments<br />
    one from \( x=-10 \) to \( x=0 \), \( y=0 \); and one from \( x=0 \) to \( x=10 \), \( y=1 \)</li>
</ul>

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">plot([-<span style="color: #B452CD">10</span>, <span style="color: #B452CD">0</span>, <span style="color: #B452CD">0</span>, <span style="color: #B452CD">10</span>], [<span style="color: #B452CD">0</span>, <span style="color: #B452CD">0</span>, <span style="color: #B452CD">1</span>, <span style="color: #B452CD">1</span>],
     axis=[x[<span style="color: #B452CD">0</span>], x[-<span style="color: #B452CD">1</span>], -<span style="color: #B452CD">0.1</span>, <span style="color: #B452CD">1.1</span>])
</pre></div>
<p>
Draws straight lines between \( (-10,0) \), \( (0,0) \), \( (0,1) \), \( (10, 1) \)
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec42">The final plot of the discontinuous Heaviside function </h2>

<p>
<center><p><img src="fig-plot/Heaviside.png" align="bottom" width=600></p></center>

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec43">Removing the vertical jump from the plot </h2>

<p>
<div class="alert alert-block alert-question alert-text-normal">
<b>Question.</b>
<p>
Some will argue and say that at high school they would draw \( H(x) \) as two horizontal lines <em>without</em> the vertical line at \( x=0 \), illustrating the jump.
How can we plot such a curve?
</div>


<p>
<!-- Plot two curves, each corresponding to x < 0 and x > 0 -->

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec44">Some functions are challenging to visualize </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Plot \( f(x) = \sin (1/x) \).</b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">f</span>(x):
    <span style="color: #8B008B; font-weight: bold">return</span> sin(<span style="color: #B452CD">1.0</span>/x)

x1 = linspace(-<span style="color: #B452CD">1</span>, <span style="color: #B452CD">1</span>, <span style="color: #B452CD">10</span>)    <span style="color: #228B22"># use 10 points</span>
x2 = linspace(-<span style="color: #B452CD">1</span>, <span style="color: #B452CD">1</span>, <span style="color: #B452CD">1000</span>)  <span style="color: #228B22"># use 1000 points</span>
plot(x1, f(x1), label=<span style="color: #CD5555">&#39;%d points&#39;</span> % <span style="color: #658b00">len</span>(x))
plot(x2, f(x2), label=<span style="color: #CD5555">&#39;%d points&#39;</span> % <span style="color: #658b00">len</span>(x))
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec45">Plot based on 10 points </h2>

<p>
<center><p><img src="fig-plot/sin1overx1.png" align="bottom" width=480></p></center>

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec46">Plot based on 1000 points </h2>

<p>
<center><p><img src="fig-plot/sin1overx2.png" align="bottom" width=480></p></center>

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec47">Assignment of an array does not copy the elements! </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">a = x
a[-<span style="color: #B452CD">1</span>] = <span style="color: #B452CD">1000</span>
</pre></div>
<p>
Is <code>x[-1]</code> also changed to 1000?<br />
Yes, because <code>a</code> refers to the same array as <code>x</code>.

<p>
Avoid changing <code>x</code> by letting <code>a</code> be a copy of <code>x</code>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">a = x.copy()
</pre></div>
<p>
The same yields slices:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">a = x[r:]      <span style="color: #228B22"># a refers to a part of the x array</span>
a[-<span style="color: #B452CD">1</span>] = <span style="color: #B452CD">1000</span>   <span style="color: #228B22"># changes x[-1]!</span>
a = x[r:].copy()
a[-<span style="color: #B452CD">1</span>] = <span style="color: #B452CD">1000</span>   <span style="color: #228B22"># does not change x[-1]</span>
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec48">In-place array arithmetics </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The two following statements are mathematically equivalent:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">a = a + b    <span style="color: #228B22"># a and b are arrays</span>
a += b
</pre></div>
<p>
However,

<ul>
  <li> <code>a = a + b</code> is computed as (extra array needed)</li>

<ol>
   <li> <code>r1 = a + b</code></li>
   <li> <code>a = r1</code></li>
</ol>

  <li> <code>a += b</code> is computed as <code>a[i] += b[i]</code> for <code>i</code> in all indices (i.e., not extra array)</li>
  <li> <code>a += b</code> is an <em>in-place</em> addition, because we change each element <em>in</em> <code>a</code>, rather than letting the name <code>a</code> refer to a new array, the result of <code>a+b</code></li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec49">In-place array arithmetics can save memory demands </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Consider

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">a = (<span style="color: #B452CD">3</span>*x**<span style="color: #B452CD">4</span> + <span style="color: #B452CD">2</span>*x + <span style="color: #B452CD">4</span>)/(x + <span style="color: #B452CD">1</span>)
</pre></div>
<p>
Here are the actual computations in the computer:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">r1 = x**<span style="color: #B452CD">4</span>;  r2 = <span style="color: #B452CD">3</span>*r1;  r3 = <span style="color: #B452CD">2</span>*x;  r4 = r1 + r3
r5 = r4 + <span style="color: #B452CD">4</span>;  r6 = x + <span style="color: #B452CD">1</span>; r7 = r5/r6; a = r7
</pre></div>
<p>
With in-place arithmetics we can save four extra arrays,
though at the cost of much less readable code:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">a = x.copy()
a **= <span style="color: #B452CD">4</span>
a *= <span style="color: #B452CD">3</span>
a += <span style="color: #B452CD">2</span>*x
a += <span style="color: #B452CD">4</span>
a /= x + <span style="color: #B452CD">1</span>
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec50">In-place arithmetics only saves memory, no significant speed-up </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Let's use IPython to measure the computational time:

<p>

<!-- code=ipy (!bc ipy) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #555555">In [1]: </span><span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">expression</span>(x):
<span style="color: #555555">   ...: </span>    <span style="color: #8B008B; font-weight: bold">return</span> (<span style="color: #B452CD">3</span>*x**<span style="color: #B452CD">4</span> + <span style="color: #B452CD">2</span>*x + <span style="color: #B452CD">4</span>)/(x + <span style="color: #B452CD">1</span>)
<span style="color: #555555">   ...:</span>

<span style="color: #555555">In [2]: </span><span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">expression_inplace</span>(x):
<span style="color: #555555">   ...: </span>    a = x.copy()
<span style="color: #555555">   ...: </span>    a **= <span style="color: #B452CD">4</span>
<span style="color: #555555">   ...: </span>    a *= <span style="color: #B452CD">3</span>
<span style="color: #555555">   ...: </span>    a += <span style="color: #B452CD">2</span>*x
<span style="color: #555555">   ...: </span>    a += <span style="color: #B452CD">4</span>
<span style="color: #555555">   ...: </span>    a /= x + <span style="color: #B452CD">1</span>
<span style="color: #555555">   ...: </span>    <span style="color: #8B008B; font-weight: bold">return</span> a
<span style="color: #555555">   ...:</span>

<span style="color: #555555">In [3]: </span><span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">np</span>

<span style="color: #555555">In [4]: </span>x = np.linspace(<span style="color: #B452CD">0</span>, <span style="color: #B452CD">1</span>, <span style="color: #B452CD">10000000</span>)

<span style="color: #555555">In [5]: </span>%<span style="color: #8B008B; font-weight: bold">timeit</span>  expression(x)
<span style="color: #888888">1 loops, best of 3: 771 ms per loop</span>

<span style="color: #555555">In [6]: </span>%<span style="color: #8B008B; font-weight: bold">timeit</span>  expression_inplace(x)
<span style="color: #888888">1 loops, best of 3: 728 ms per loop</span>
</pre></div>
<p>
Only 5% speed-up, so use <code>+=</code>, <code>-=</code>, etc. when arrays are large and
you need to save memory
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec51">Useful array operations </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Make a new array with same size as another array:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">import</span> *

<span style="color: #228B22"># x is numpy array</span>
a = x.copy()

<span style="color: #228B22"># or</span>
a = zeros(x.shape, x.dtype)

<span style="color: #228B22"># or</span>
a = zeros_like(x)  <span style="color: #228B22"># zeros and same size as x</span>
</pre></div>
<p>
Make sure a list or array is an array:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">a = asarray(a)
b = asarray(somearray, dtype=<span style="color: #658b00">float</span>)  <span style="color: #228B22"># specify data type</span>
</pre></div>
<p>
Test if an object is an array:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; <span style="color: #658b00">type</span>(a)
&lt;<span style="color: #658b00">type</span> <span style="color: #CD5555">&#39;numpy.ndarray&#39;</span>&gt;
&gt;&gt;&gt; <span style="color: #658b00">isinstance</span>(a, ndarray)
<span style="color: #658b00">True</span>
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec52">Example: vectorizing a constant function </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">f</span>(x):
    <span style="color: #8B008B; font-weight: bold">return</span> <span style="color: #B452CD">2</span>
</pre></div>
<p>
Vectorized version must return array of 2's:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">fv</span>(x):
    <span style="color: #8B008B; font-weight: bold">return</span> zeros(x.shape, x.dtype) + <span style="color: #B452CD">2</span>
</pre></div>
<p>
New version valid both for scalar and array <code>x</code>:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">f</span>(x):
    <span style="color: #8B008B; font-weight: bold">if</span> <span style="color: #658b00">isinstance</span>(x, (<span style="color: #658b00">float</span>, <span style="color: #658b00">int</span>)):
        <span style="color: #8B008B; font-weight: bold">return</span> <span style="color: #B452CD">2</span>
    <span style="color: #8B008B; font-weight: bold">elif</span> <span style="color: #658b00">isinstance</span>(x, ndarray):
        <span style="color: #8B008B; font-weight: bold">return</span> zeros(x.shape, x.dtype) + <span style="color: #B452CD">2</span>
    <span style="color: #8B008B; font-weight: bold">else</span>:
        <span style="color: #8B008B; font-weight: bold">raise</span> <span style="color: #008b45; font-weight: bold">TypeError</span>(
           <span style="color: #CD5555">&#39;x must be int/float/ndarray, not %s&#39;</span> % <span style="color: #658b00">type</span>(x))
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec53">Generalized array indexing </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Recall slicing: <code>a[f:t:i]</code>, where the slice <code>f:t:i</code> implies a set of indices
(from, to, increment).

<p>
Any integer list or array can be used to indicate a set of indices:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; a = linspace(<span style="color: #B452CD">1</span>, <span style="color: #B452CD">8</span>, <span style="color: #B452CD">8</span>)
&gt;&gt;&gt; a
array([ <span style="color: #B452CD">1.</span>,  <span style="color: #B452CD">2.</span>,  <span style="color: #B452CD">3.</span>,  <span style="color: #B452CD">4.</span>,  <span style="color: #B452CD">5.</span>,  <span style="color: #B452CD">6.</span>,  <span style="color: #B452CD">7.</span>,  <span style="color: #B452CD">8.</span>])
&gt;&gt;&gt; a[[<span style="color: #B452CD">1</span>,<span style="color: #B452CD">6</span>,<span style="color: #B452CD">7</span>]] = <span style="color: #B452CD">10</span>
&gt;&gt;&gt; a
array([  <span style="color: #B452CD">1.</span>,  <span style="color: #B452CD">10.</span>,   <span style="color: #B452CD">3.</span>,   <span style="color: #B452CD">4.</span>,   <span style="color: #B452CD">5.</span>,   <span style="color: #B452CD">6.</span>,  <span style="color: #B452CD">10.</span>,  <span style="color: #B452CD">10.</span>])
&gt;&gt;&gt; a[<span style="color: #658b00">range</span>(<span style="color: #B452CD">2</span>,<span style="color: #B452CD">8</span>,<span style="color: #B452CD">3</span>)] = -<span style="color: #B452CD">2</span>   <span style="color: #228B22"># same as a[2:8:3] = -2</span>
&gt;&gt;&gt; a
array([  <span style="color: #B452CD">1.</span>,  <span style="color: #B452CD">10.</span>,  -<span style="color: #B452CD">2.</span>,   <span style="color: #B452CD">4.</span>,   <span style="color: #B452CD">5.</span>,  -<span style="color: #B452CD">2.</span>,  <span style="color: #B452CD">10.</span>,  <span style="color: #B452CD">10.</span>])
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec54">Generalized array indexing with boolean expressions </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; a &lt; <span style="color: #B452CD">0</span>
[<span style="color: #658b00">False</span>, <span style="color: #658b00">False</span>, <span style="color: #658b00">True</span>, <span style="color: #658b00">False</span>, <span style="color: #658b00">False</span>, <span style="color: #658b00">True</span>, <span style="color: #658b00">False</span>, <span style="color: #658b00">False</span>]

&gt;&gt;&gt; a[a &lt; <span style="color: #B452CD">0</span>]           <span style="color: #228B22"># pick out all negative elements</span>
array([-<span style="color: #B452CD">2.</span>, -<span style="color: #B452CD">2.</span>])

&gt;&gt;&gt; a[a &lt; <span style="color: #B452CD">0</span>] = a.max() <span style="color: #228B22"># if a[i]&lt;10, set a[i]=10</span>
&gt;&gt;&gt; a
array([  <span style="color: #B452CD">1.</span>,  <span style="color: #B452CD">10.</span>,  <span style="color: #B452CD">10.</span>,   <span style="color: #B452CD">4.</span>,   <span style="color: #B452CD">5.</span>,  <span style="color: #B452CD">10.</span>,  <span style="color: #B452CD">10.</span>,  <span style="color: #B452CD">10.</span>])
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec55">Two-dimensional arrays; math intro </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
When we have a table of numbers,

$$
\left\lbrack\begin{array}{cccc}
0 & 12 & -1 & 5\\
-1 & -1 & -1 & 0\\
11 & 5 & 5 & -2
\end{array}\right\rbrack
$$

(called <em>matrix</em> by mathematicians) it is natural to use a two-dimensional array \( A_{i,j} \) with one index for the rows and one for the columns:

$$
A =
\left\lbrack\begin{array}{ccc}
A_{0,0} & \cdots &  A_{0,n-1}\\
\vdots & \ddots &  \vdots\\
A_{m-1,0} & \cdots & A_{m-1,n-1}
\end{array}\right\rbrack
$$
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec56">Two-dimensional arrays; Python code </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Making and filling a two-dimensional NumPy array goes like this:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">A = zeros((<span style="color: #B452CD">3</span>,<span style="color: #B452CD">4</span>))   <span style="color: #228B22"># 3x4 table of numbers</span>
A[<span style="color: #B452CD">0</span>,<span style="color: #B452CD">0</span>] = -<span style="color: #B452CD">1</span>
A[<span style="color: #B452CD">1</span>,<span style="color: #B452CD">0</span>] =  <span style="color: #B452CD">1</span>
A[<span style="color: #B452CD">2</span>,<span style="color: #B452CD">0</span>] = <span style="color: #B452CD">10</span>
A[<span style="color: #B452CD">0</span>,<span style="color: #B452CD">1</span>] = -<span style="color: #B452CD">5</span>
...
A[<span style="color: #B452CD">2</span>,<span style="color: #B452CD">3</span>] = -<span style="color: #B452CD">100</span>

<span style="color: #228B22"># can also write (as for nested lists)</span>
A[<span style="color: #B452CD">2</span>][<span style="color: #B452CD">3</span>] = -<span style="color: #B452CD">100</span>
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec57">From nested list to two-dimensional array </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Let us make a table of numbers in a nested list:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; Cdegrees = [-<span style="color: #B452CD">30</span> + i*<span style="color: #B452CD">10</span> <span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> <span style="color: #658b00">range</span>(<span style="color: #B452CD">3</span>)]
&gt;&gt;&gt; Fdegrees = [<span style="color: #B452CD">9.</span>/<span style="color: #B452CD">5</span>*C + <span style="color: #B452CD">32</span> <span style="color: #8B008B; font-weight: bold">for</span> C <span style="color: #8B008B">in</span> Cdegrees]
&gt;&gt;&gt; table = [[C, F] <span style="color: #8B008B; font-weight: bold">for</span> C, F <span style="color: #8B008B">in</span> <span style="color: #658b00">zip</span>(Cdegrees, Fdegrees)]
&gt;&gt;&gt; <span style="color: #8B008B; font-weight: bold">print</span> table
[[-<span style="color: #B452CD">30</span>, -<span style="color: #B452CD">22.0</span>], [-<span style="color: #B452CD">20</span>, -<span style="color: #B452CD">4.0</span>], [-<span style="color: #B452CD">10</span>, <span style="color: #B452CD">14.0</span>]]
</pre></div>
<p>
Turn into NumPy array:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; table2 = array(table)
&gt;&gt;&gt; <span style="color: #8B008B; font-weight: bold">print</span> table2
[[-<span style="color: #B452CD">30.</span> -<span style="color: #B452CD">22.</span>]
 [-<span style="color: #B452CD">20.</span>  -<span style="color: #B452CD">4.</span>]
 [-<span style="color: #B452CD">10.</span>  <span style="color: #B452CD">14.</span>]]
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec58">How to loop over two-dimensional arrays </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; table2.shape   <span style="color: #228B22"># see the number of elements in each dir.</span>
(<span style="color: #B452CD">3</span>, <span style="color: #B452CD">2</span>)             <span style="color: #228B22"># 3 rows, 2 columns</span>
</pre></div>
<p>
A for loop over all array elements:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; <span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> <span style="color: #658b00">range</span>(table2.shape[<span style="color: #B452CD">0</span>]):
...     <span style="color: #8B008B; font-weight: bold">for</span> j <span style="color: #8B008B">in</span> <span style="color: #658b00">range</span>(table2.shape[<span style="color: #B452CD">1</span>]):
...         <span style="color: #8B008B; font-weight: bold">print</span> <span style="color: #CD5555">&#39;table2[%d,%d] = %g&#39;</span> % (i, j, table2[i,j])
...
table2[<span style="color: #B452CD">0</span>,<span style="color: #B452CD">0</span>] = -<span style="color: #B452CD">30</span>
table2[<span style="color: #B452CD">0</span>,<span style="color: #B452CD">1</span>] = -<span style="color: #B452CD">22</span>
...
table2[<span style="color: #B452CD">2</span>,<span style="color: #B452CD">1</span>] = <span style="color: #B452CD">14</span>
</pre></div>
<p>
Alternative single loop over all elements:

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; <span style="color: #8B008B; font-weight: bold">for</span> index_tuple, value <span style="color: #8B008B">in</span> np.ndenumerate(table2):
...     <span style="color: #8B008B; font-weight: bold">print</span> <span style="color: #CD5555">&#39;index %s has value %g&#39;</span> % \
...           (index_tuple, table2[index_tuple])
...
index (<span style="color: #B452CD">0</span>,<span style="color: #B452CD">0</span>) has value -<span style="color: #B452CD">30</span>
index (<span style="color: #B452CD">0</span>,<span style="color: #B452CD">1</span>) has value -<span style="color: #B452CD">22</span>
...
index (<span style="color: #B452CD">2</span>,<span style="color: #B452CD">1</span>) has value <span style="color: #B452CD">14</span>
&gt;&gt;&gt; <span style="color: #658b00">type</span>(index_tuple)
&lt;<span style="color: #658b00">type</span> <span style="color: #CD5555">&#39;tuple&#39;</span>&gt;
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec59">How to take slices of two-dimensional arrays </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Rule: can use slices <code>start:stop:inc</code> for each index

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">table2[<span style="color: #B452CD">0</span>:table2.shape[<span style="color: #B452CD">0</span>], <span style="color: #B452CD">1</span>]  <span style="color: #228B22"># 2nd column (index 1)</span>
array([-<span style="color: #B452CD">22.</span>,  -<span style="color: #B452CD">4.</span>,  <span style="color: #B452CD">14.</span>])

&gt;&gt;&gt; table2[<span style="color: #B452CD">0</span>:, <span style="color: #B452CD">1</span>]             <span style="color: #228B22"># same</span>
array([-<span style="color: #B452CD">22.</span>,  -<span style="color: #B452CD">4.</span>,  <span style="color: #B452CD">14.</span>])

&gt;&gt;&gt; table2[:, <span style="color: #B452CD">1</span>]              <span style="color: #228B22"># same</span>
array([-<span style="color: #B452CD">22.</span>,  -<span style="color: #B452CD">4.</span>,  <span style="color: #B452CD">14.</span>])

&gt;&gt;&gt; t = linspace(<span style="color: #B452CD">1</span>, <span style="color: #B452CD">30</span>, <span style="color: #B452CD">30</span>).reshape(<span style="color: #B452CD">5</span>, <span style="color: #B452CD">6</span>)
&gt;&gt;&gt; t[<span style="color: #B452CD">1</span>:-<span style="color: #B452CD">1</span>:<span style="color: #B452CD">2</span>, <span style="color: #B452CD">2</span>:]
array([[  <span style="color: #B452CD">9.</span>,  <span style="color: #B452CD">10.</span>,  <span style="color: #B452CD">11.</span>,  <span style="color: #B452CD">12.</span>],
       [ <span style="color: #B452CD">21.</span>,  <span style="color: #B452CD">22.</span>,  <span style="color: #B452CD">23.</span>,  <span style="color: #B452CD">24.</span>]])
&gt;&gt;&gt; t
array([[  <span style="color: #B452CD">1.</span>,   <span style="color: #B452CD">2.</span>,   <span style="color: #B452CD">3.</span>,   <span style="color: #B452CD">4.</span>,   <span style="color: #B452CD">5.</span>,   <span style="color: #B452CD">6.</span>],
       [  <span style="color: #B452CD">7.</span>,   <span style="color: #B452CD">8.</span>,   <span style="color: #B452CD">9.</span>,  <span style="color: #B452CD">10.</span>,  <span style="color: #B452CD">11.</span>,  <span style="color: #B452CD">12.</span>],
       [ <span style="color: #B452CD">13.</span>,  <span style="color: #B452CD">14.</span>,  <span style="color: #B452CD">15.</span>,  <span style="color: #B452CD">16.</span>,  <span style="color: #B452CD">17.</span>,  <span style="color: #B452CD">18.</span>],
       [ <span style="color: #B452CD">19.</span>,  <span style="color: #B452CD">20.</span>,  <span style="color: #B452CD">21.</span>,  <span style="color: #B452CD">22.</span>,  <span style="color: #B452CD">23.</span>,  <span style="color: #B452CD">24.</span>],
       [ <span style="color: #B452CD">25.</span>,  <span style="color: #B452CD">26.</span>,  <span style="color: #B452CD">27.</span>,  <span style="color: #B452CD">28.</span>,  <span style="color: #B452CD">29.</span>,  <span style="color: #B452CD">30.</span>]])
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec60">Time for a question </h2>

<p>
<!-- !bpop -->
<div class="alert alert-block alert-block alert-text-normal">
<b>Problem:</b>
<p>
Given

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">&gt;&gt;&gt; t
array([[  <span style="color: #B452CD">1.</span>,   <span style="color: #B452CD">2.</span>,   <span style="color: #B452CD">3.</span>,   <span style="color: #B452CD">4.</span>,   <span style="color: #B452CD">5.</span>,   <span style="color: #B452CD">6.</span>],
       [  <span style="color: #B452CD">7.</span>,   <span style="color: #B452CD">8.</span>,   <span style="color: #B452CD">9.</span>,  <span style="color: #B452CD">10.</span>,  <span style="color: #B452CD">11.</span>,  <span style="color: #B452CD">12.</span>],
       [ <span style="color: #B452CD">13.</span>,  <span style="color: #B452CD">14.</span>,  <span style="color: #B452CD">15.</span>,  <span style="color: #B452CD">16.</span>,  <span style="color: #B452CD">17.</span>,  <span style="color: #B452CD">18.</span>],
       [ <span style="color: #B452CD">19.</span>,  <span style="color: #B452CD">20.</span>,  <span style="color: #B452CD">21.</span>,  <span style="color: #B452CD">22.</span>,  <span style="color: #B452CD">23.</span>,  <span style="color: #B452CD">24.</span>],
       [ <span style="color: #B452CD">25.</span>,  <span style="color: #B452CD">26.</span>,  <span style="color: #B452CD">27.</span>,  <span style="color: #B452CD">28.</span>,  <span style="color: #B452CD">29.</span>,  <span style="color: #B452CD">30.</span>]])
</pre></div>
<p>
What will <code>t[1:-1:2, 2:]</code> be?
</div>

<!-- !epop -->

<p>
<!-- !bpop -->
<div class="alert alert-block alert-block alert-text-normal">
<b>Solution:</b>
<p>
Slice <code>1:-1:2</code> for first index results in

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">[  <span style="color: #B452CD">7.</span>,   <span style="color: #B452CD">8.</span>,   <span style="color: #B452CD">9.</span>,  <span style="color: #B452CD">10.</span>,  <span style="color: #B452CD">11.</span>,  <span style="color: #B452CD">12.</span>]
[ <span style="color: #B452CD">19.</span>,  <span style="color: #B452CD">20.</span>,  <span style="color: #B452CD">21.</span>,  <span style="color: #B452CD">22.</span>,  <span style="color: #B452CD">23.</span>,  <span style="color: #B452CD">24.</span>]
</pre></div>
<p>
Slice <code>2:</code> for the second index then gives

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">[  <span style="color: #B452CD">9.</span>,  <span style="color: #B452CD">10.</span>,  <span style="color: #B452CD">11.</span>,  <span style="color: #B452CD">12.</span>]
[ <span style="color: #B452CD">21.</span>,  <span style="color: #B452CD">22.</span>,  <span style="color: #B452CD">23.</span>,  <span style="color: #B452CD">24.</span>]
</pre></div>

</div>

<!-- !epop -->

<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec61">Summary of vectors and arrays </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
  <li> Vector/array computing: apply a mathematical expression to every element in the vector/array (no loops in Python)</li>
  <li> Ex: <code>sin(x**4)*exp(-x**2)</code>, <code>x</code> can be array or scalar<br />
    for array the <code>i</code>'th element becomes <code>sin(x[i]**4)*exp(-x[i]**2)</code></li>
  <li> Vectorization: make scalar mathematical computation valid for vectors/arrays</li>
  <li> Pure mathematical expressions require no extra vectorization</li>
  <li> Mathematical formulas involving <code>if</code> tests require manual work for vectorization:</li>
</ul>

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">scalar_result = expression1 <span style="color: #8B008B; font-weight: bold">if</span> condition <span style="color: #8B008B; font-weight: bold">else</span> expression2
vector_result = where(condition, expression1, expression2)
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec62">Summary of plotting \( y=f(x) \) curves </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Curve plotting (unified syntax for Matplotlib and SciTools):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #8B008B; font-weight: bold">import</span> *
<span style="color: #228B22">#from scitools.std import *</span>


plot(x, y)         <span style="color: #228B22"># simplest command</span>

plot(t1, y1, <span style="color: #CD5555">&#39;r&#39;</span>,  <span style="color: #228B22"># curve 1, red line</span>
     t2, y2, <span style="color: #CD5555">&#39;b&#39;</span>,  <span style="color: #228B22"># curve 2, blue line</span>
     t3, y3, <span style="color: #CD5555">&#39;o&#39;</span>)  <span style="color: #228B22"># curve 3, circles at data points</span>
axis([t1[<span style="color: #B452CD">0</span>], t1[-<span style="color: #B452CD">1</span>], -<span style="color: #B452CD">1.1</span>, <span style="color: #B452CD">1.1</span>])
legend([<span style="color: #CD5555">&#39;model 1&#39;</span>, <span style="color: #CD5555">&#39;model 2&#39;</span>, <span style="color: #CD5555">&#39;measurements&#39;</span>])
xlabel(<span style="color: #CD5555">&#39;time&#39;</span>);  ylabel(<span style="color: #CD5555">&#39;force&#39;</span>)
savefig(<span style="color: #CD5555">&#39;myframe_%04d.png&#39;</span> % plot_counter)
</pre></div>
<p>
Note: straight lines are drawn between each data point
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec63">Alternativ plotting of \( y=f(x) \) curves </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Single SciTools <code>plot</code> command with keyword arguments:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">scitools.std</span> <span style="color: #8B008B; font-weight: bold">import</span> *

plot(t1, y1, <span style="color: #CD5555">&#39;r&#39;</span>,  <span style="color: #228B22"># curve 1, red line</span>
     t2, y2, <span style="color: #CD5555">&#39;b&#39;</span>,  <span style="color: #228B22"># curve 2, blue line</span>
     t3, y3, <span style="color: #CD5555">&#39;o&#39;</span>,  <span style="color: #228B22"># curve 3, circles at data points</span>
     axis=[t1[<span style="color: #B452CD">0</span>], t1[-<span style="color: #B452CD">1</span>], -<span style="color: #B452CD">1.1</span>, <span style="color: #B452CD">1.1</span>],
     legend=(<span style="color: #CD5555">&#39;model 1&#39;</span>, <span style="color: #CD5555">&#39;model 2&#39;</span>, <span style="color: #CD5555">&#39;measurements&#39;</span>),
     xlabel=<span style="color: #CD5555">&#39;time&#39;</span>, ylabel=<span style="color: #CD5555">&#39;force&#39;</span>,
     savefig=<span style="color: #CD5555">&#39;myframe_%04d.png&#39;</span> % plot_counter)
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec64">Summary of making animations </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
 <li> Make a hardcopy of each plot frame (PNG or PDF format)</li>
 <li> Use <code>avconv</code> or <code>ffmpeg</code> to make movie</li>
</ul>

<p>

<!-- code=text (!bc sys) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%">Terminal&gt; avconv -r 5 -i tmp_%04d.png -vcodec flv movie.flv
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec65">Array functionality </h2>

<p>
<table border="1">
<thead>
<tr><th align="center">            Construction            </th> <th align="center">                                     Meaning                                     </th> </tr>
</thead>
<tbody>
<tr><td align="left">   <code>array(ld)</code>                  </td> <td align="left">   copy list data <code>ld</code> to a <code>numpy</code> array                         </td> </tr>
<tr><td align="left">   <code>asarray(d)</code>                 </td> <td align="left">   make array of data <code>d</code> (no data copy if already array)                    </td> </tr>
<tr><td align="left">   <code>zeros(n)</code>                   </td> <td align="left">   make a <code>float</code> vector/array of length <code>n</code>, with zeros          </td> </tr>
<tr><td align="left">   <code>zeros(n, int)</code>              </td> <td align="left">   make an <code>int</code> vector/array of length <code>n</code> with zeros            </td> </tr>
<tr><td align="left">   <code>zeros((m,n))</code>               </td> <td align="left">   make a two-dimensional <code>float</code> array with shape (<code>m</code>,`n`)      </td> </tr>
<tr><td align="left">   <code>zeros_like(x)</code>              </td> <td align="left">   make array of same shape and element type as <code>x</code>                          </td> </tr>
<tr><td align="left">   <code>linspace(a,b,m)</code>            </td> <td align="left">   uniform sequence of <code>m</code> numbers in \( [a,b] \)                            </td> </tr>
<tr><td align="left">   <code>a.shape</code>                    </td> <td align="left">   tuple containing <code>a</code>'s shape                                              </td> </tr>
<tr><td align="left">   <code>a.size</code>                     </td> <td align="left">   total no of elements in <code>a</code>                                               </td> </tr>
<tr><td align="left">   <code>len(a)</code>                     </td> <td align="left">   length of a one-dim. array <code>a</code> (same as <code>a.shape[0]</code>)          </td> </tr>
<tr><td align="left">   <code>a.dtype</code>                    </td> <td align="left">   the type of elements in <code>a</code>                                               </td> </tr>
<tr><td align="left">   <code>a.reshape(3,2)</code>             </td> <td align="left">   return <code>a</code> reshaped as \( 3\times 2 \) array                              </td> </tr>
<tr><td align="left">   <code>a[i]</code>                       </td> <td align="left">   vector indexing                                                                      </td> </tr>
<tr><td align="left">   <code>a[i,j]</code>                     </td> <td align="left">   two-dim. array indexing                                                              </td> </tr>
<tr><td align="left">   <code>a[1:k]</code>                     </td> <td align="left">   slice: reference data with indices <code>1</code>,\ldots,`k-1`                       </td> </tr>
<tr><td align="left">   <code>a[1:8:3]</code>                   </td> <td align="left">   slice: reference data with indices <code>1</code>, <code>4</code>,\ldots,`7`         </td> </tr>
<tr><td align="left">   <code>b = a.copy()</code>               </td> <td align="left">   copy an array                                                                        </td> </tr>
<tr><td align="left">   <code>sin(a), exp(a), ...</code>        </td> <td align="left">   <code>numpy</code> functions applicable to arrays                                    </td> </tr>
<tr><td align="left">   <code>c = concatenate((a, b))</code>    </td> <td align="left">   <code>c</code> contains <code>a</code> with <code>b</code> appended                  </td> </tr>
<tr><td align="left">   <code>c = where(cond, a1, a2)</code>    </td> <td align="left">   <code>c[i] = a1[i]</code> if <code>cond[i]</code>, else <code>c[i] = a2[i]</code>    </td> </tr>
<tr><td align="left">   <code>isinstance(a, ndarray)</code>     </td> <td align="left">   is <code>True</code> if <code>a</code> is an array                                   </td> </tr>
</tbody>
</table>
<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec66">Summarizing example: animating a function (part 1) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Goal: visualize the temperature in the ground as a function of
depth (\( z \)) and time (\( t \)), displayed as a movie in time:

$$ T(z,t) = T_0 + Ae^{-az}\cos (\omega t - az),\quad a =\sqrt{\omega\over 2k} $$

<p>
First we make a <em>general</em> animation function for an \( f(x,t) \):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">scitools.std</span> <span style="color: #8B008B; font-weight: bold">import</span> plot  <span style="color: #228B22"># convenient for animations</span>

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">animate</span>(tmax, dt, x, function, ymin, ymax, t0=<span style="color: #B452CD">0</span>,
            xlabel=<span style="color: #CD5555">&#39;x&#39;</span>, ylabel=<span style="color: #CD5555">&#39;y&#39;</span>, filename=<span style="color: #CD5555">&#39;tmp_&#39;</span>):
    t = t0
    counter = <span style="color: #B452CD">0</span>
    <span style="color: #8B008B; font-weight: bold">while</span> t &lt;= tmax:
        y = function(x, t)
        plot(x, y,
             axis=[x[<span style="color: #B452CD">0</span>], x[-<span style="color: #B452CD">1</span>], ymin, ymax],
             title=<span style="color: #CD5555">&#39;time=%g&#39;</span> % t,
             xlabel=xlabel, ylabel=ylabel,
             savefig=filename + <span style="color: #CD5555">&#39;%04d.png&#39;</span> % counter)
        t += dt
        counter += <span style="color: #B452CD">1</span>
</pre></div>
<p>
Then we call this function with our special \( T(z,t) \) function
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br>

<h2 id="___sec67">Summarizing example: animating a function (part 2) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="highlight" style="background: #eee8d5"><pre style="line-height: 125%"><span style="color: #228B22"># remove old plot files:</span>
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">glob</span>, <span style="color: #008b45; text-decoration: underline">os</span>
<span style="color: #8B008B; font-weight: bold">for</span> filename <span style="color: #8B008B">in</span> glob.glob(<span style="color: #CD5555">&#39;tmp_*.png&#39;</span>): os.remove(filename)

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">T</span>(z, t):
    <span style="color: #228B22"># T0, A, k, and omega are global variables</span>
    a = sqrt(omega/(<span style="color: #B452CD">2</span>*k))
    <span style="color: #8B008B; font-weight: bold">return</span> T0 + A*exp(-a*z)*cos(omega*t - a*z)

k = <span style="color: #B452CD">1E-6</span>     <span style="color: #228B22"># heat conduction coefficient (in m*m/s)</span>
P = <span style="color: #B452CD">24</span>*<span style="color: #B452CD">60</span>*<span style="color: #B452CD">60.</span><span style="color: #228B22"># oscillation period of 24 h (in seconds)</span>
omega = <span style="color: #B452CD">2</span>*pi/P
dt = P/<span style="color: #B452CD">24</span>    <span style="color: #228B22"># time lag: 1 h</span>
tmax = <span style="color: #B452CD">3</span>*P   <span style="color: #228B22"># 3 day/night simulation</span>
T0 = <span style="color: #B452CD">10</span>      <span style="color: #228B22"># mean surface temperature in Celsius</span>
A = <span style="color: #B452CD">10</span>       <span style="color: #228B22"># amplitude of the temperature variations (in C)</span>
a = sqrt(omega/(<span style="color: #B452CD">2</span>*k))
D = -(<span style="color: #B452CD">1</span>/a)*log(<span style="color: #B452CD">0.001</span>) <span style="color: #228B22"># max depth</span>
n = <span style="color: #B452CD">501</span>      <span style="color: #228B22"># no of points in the z direction</span>

z = linspace(<span style="color: #B452CD">0</span>, D, n)
animate(tmax, dt, z, T, T0-A, T0+A, <span style="color: #B452CD">0</span>, <span style="color: #CD5555">&#39;z&#39;</span>, <span style="color: #CD5555">&#39;T&#39;</span>)
</pre></div>
<p>
Must combine hardcopy files (like <code>tmp_0034.png</code>) to make video formats
</div>


<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

