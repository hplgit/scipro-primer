<!DOCTYPE html>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="App. A: Sequences and difference equations">

<title>App. A: Sequences and difference equations</title>







<!-- reveal.js: http://lab.hakim.se/reveal-js/ -->

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/darkgray.css" id="theme">
<!--
<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/beigesmall.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/solarized.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/serif.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/moon.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/sky.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/darkgray.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/cbc.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simula.css" id="theme">
-->

<!-- For syntax highlighting -->
<link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

<!-- If the query includes 'print-pdf', use the PDF print sheet -->
<script>
document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
</script>

<style type="text/css">
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
    hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .reveal .alert-text-small   { font-size: 80%;  }
    .reveal .alert-text-large   { font-size: 130%; }
    .reveal .alert-text-normal  { font-size: 90%;  }
    .reveal .alert {
             padding:8px 35px 8px 14px; margin-bottom:18px;
             text-shadow:0 1px 0 rgba(255,255,255,0.5);
             border:5px solid #bababa;
             -webkit-border-radius: 14px; -moz-border-radius: 14px;
             border-radius:14px
             background-position: 10px 10px;
             background-repeat: no-repeat;
             background-size: 38px;
             padding-left: 30px; /* 55px; if icon */
     }
     .reveal .alert-block {padding-top:14px; padding-bottom:14px}
     .reveal .alert-block > p, .alert-block > ul {margin-bottom:1em}
     /*.reveal .alert li {margin-top: 1em}*/
     .reveal .alert-block p+p {margin-top:5px}
     /*.reveal .alert-notice { background-image: url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_notice.png); }
     .reveal .alert-summary  { background-image:url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_summary.png); }
     .reveal .alert-warning { background-image: url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_warning.png); }
     .reveal .alert-question {background-image:url(http://hplgit.github.io/doconce/bundled/html_images/small_gray_question.png); } */

</style>



<!-- Styles for table layout of slides -->
<style type="text/css">
td.padding {
  padding-top:20px;
  padding-bottom:20px;
  padding-right:50px;
  padding-left:50px;
}
</style>

</head>

<body>
<div class="reveal">

<!-- Any section element inside the <div class="slides"> container
     is displayed as a slide -->

<div class="slides">





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    



<section>
<!-- ------------------- main content ---------------------- -->



<center><h1 style="text-align: center;">App. A: Sequences and difference equations</h1></center>  <!-- document title -->

<p>
<!-- author(s): Hans Petter Langtangen -->

<center>
<b>Hans Petter Langtangen</b> [1, 2]
</center>

<p>&nbsp;<br>
<!-- institution(s) -->

<center>[1] <b>Simula Research Laboratory</b></center>
<center>[2] <b>University of Oslo, Dept. of Informatics</b></center>
<br>
<p>&nbsp;<br>
<center><h4>Aug 15, 2015</h4></center> <!-- date -->
<br>
</section>


<section>
<h2 id="___sec0">Sequences </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
<em>Sequences</em> is a central topic in mathematics:

<p>&nbsp;<br>
$$ x_0,\ x_1,\ x_2,\ \ldots,\ x_n,\ldots, $$
<p>&nbsp;<br>

<p>
Example: all odd numbers

<p>&nbsp;<br>
$$ 1, 3, 5, 7, \ldots, 2n+1,\ldots $$
<p>&nbsp;<br>

<p>
For this sequence we have a formula for the \( n \)-th term:

<p>&nbsp;<br>
$$ x_n = 2n+1 $$
<p>&nbsp;<br>

and we can write the sequence more compactly as

<p>&nbsp;<br>
$$ (x_n)_{n=0}^\infty,\quad x_n = 2n+1$$
<p>&nbsp;<br>
</div>
</section>


<section>
<h2 id="___sec1">Other examples of sequences </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>&nbsp;<br>
$$ 1,\ 4,\ 9,\ 16,\ 25,\ \ldots\quad (x_n)_{n=0}^\infty,\ x_n=n^2$$
<p>&nbsp;<br>

<p>&nbsp;<br>
$$ 1,\ {1\over 2},\ {1\over3},\ {1\over4},\ \ldots\quad (x_n)_{n=0}^\infty,\ x_n={1\over {n+1}}$$
<p>&nbsp;<br>

<p>&nbsp;<br>
$$ 1,\ 1,\ 2,\ 6,\ 24,\ \ldots\quad (x_n)_{n=0}^\infty,\ x_n=n!$$
<p>&nbsp;<br>

<p>&nbsp;<br>
$$ 1,\ 1+x,\ 1+x+{1\over2}x^2,\ 1+x+{1\over2}x^2+{1\over6}x^3,\ \ldots\quad (x_n)_{n=0}^\infty,\ x_n=\sum_{j=0}^n {x^j\over j!}$$
<p>&nbsp;<br>
</div>
</section>


<section>
<h2 id="___sec2">Finite and infinite sequences </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> Infinite sequences have an infinite number of terms (\( n\rightarrow\infty \))</li>

<p><li> In mathematics, infinite sequences are widely used</li>

<p><li> In real-life applications, sequences are usually finite: \( (x_n)_{n=0}^N \)</li>

<p><li> Example: number of approved exercises every week in INF1100<br />
    \( x_0, x_1, x_2, \ldots, x_{15} \)</li>

<p><li> Example: the annual value of a loan<br />
    \( x_0, x_1, \ldots, x_{20} \)</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec3">Difference equations </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> For sequences occuring in modeling of real-world phenomena, there is seldom a formula for the \( n \)-th term</li>

<p><li> However, we can often set up one or more equations governing the sequence</li>

<p><li> Such equations are called difference equations</li>

<p><li> With a computer it is then very easy to generate the sequence by solving the difference equations</li>

<p><li> Difference equations have lots of applications and are very easy to solve on a computer, but often complicated or impossible to solve for \( x_n \) (as a formula) by pen and paper!</li>

<p><li> The programs require only loops and arrays</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec4">Modeling interest rates </h2>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b>Problem:</b>
<p>
Put \( x_0 \) money in a bank at year 0. What is the value after \( N \) years if the interest rate is \( p \) percent per year?
</div>

<p>

<div class="fragment alert alert-block alert-block alert-text-normal">
<b>Solution:</b>
<p>
The fundamental information relates the value at year \( n \), \( x_n \), to the value of the previous year, \( x_{n-1} \):

<p>&nbsp;<br>
$$ x_{n} = x_{n-1} + {p\over 100}x_{n-1} $$
<p>&nbsp;<br>

<p>
How to solve for \( x_n \)? Start with \( x_0 \), compute \( x_1 \), \( x_2 \), ...
</div>
</section>


<section>
<h2 id="___sec5">Simulating the difference equation for interest rates </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>What does it mean to simulate?</b>
<p>
Solve math equations by repeating a simple procedure (relation) many times (boring, but well suited for a computer!)
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Program for \( x_{n} = x_{n-1} + (p/100)x_{n-1} \):</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">from</span> <span style="color: #447fcf; text-decoration: underline">scitools.std</span> <span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #d0d0d0">*</span>
<span style="color: #d0d0d0">x0</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">100</span>                      <span style="color: #999999; font-style: italic"># initial amount</span>
<span style="color: #d0d0d0">p</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">5</span>                         <span style="color: #999999; font-style: italic"># interest rate</span>
<span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">4</span>                         <span style="color: #999999; font-style: italic"># number of years</span>
<span style="color: #d0d0d0">index_set</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">range</span><span style="color: #d0d0d0">(N+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">x</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">zeros(</span><span style="color: #24909d">len</span><span style="color: #d0d0d0">(index_set))</span>

<span style="color: #999999; font-style: italic"># Solution:</span>
<span style="color: #d0d0d0">x[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x0</span>
<span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">n</span> <span style="color: #6ab825; font-weight: bold">in</span> <span style="color: #d0d0d0">index_set[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">:]:</span>
    <span style="color: #d0d0d0">x[n]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">(p/</span><span style="color: #3677a9">100.0</span><span style="color: #d0d0d0">)*x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span>
<span style="color: #6ab825; font-weight: bold">print</span> <span style="color: #d0d0d0">x</span>
<span style="color: #d0d0d0">plot(index_set,</span> <span style="color: #d0d0d0">x,</span> <span style="color: #ed9d13">&#39;ro&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">xlabel=</span><span style="color: #ed9d13">&#39;years&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">ylabel=</span><span style="color: #ed9d13">&#39;amount&#39;</span><span style="color: #d0d0d0">)</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec6">We do not need to store the entire sequence, but it is convenient for programming and later plotting </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> Previous program stores all the \( x_n \) values in a NumPy array</li>

<p><li> To compute \( x_n \), we only need one previous value, \( x_{n-1} \)</li>
</ul>
<p>

Thus, we could only store the two last values in memory:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">x_old</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x0</span>
<span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">n</span> <span style="color: #6ab825; font-weight: bold">in</span> <span style="color: #d0d0d0">index_set[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">:]:</span>
    <span style="color: #d0d0d0">x_new</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x_old</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">(p/</span><span style="color: #3677a9">100.</span><span style="color: #d0d0d0">)*x_old</span>
    <span style="color: #d0d0d0">x_old</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x_new</span>  <span style="color: #999999; font-style: italic"># x_new becomes x_old at next step</span>
</pre></div>
<p>
However, programming with an array <code>x[n]</code> is simpler, safer, and enables plotting the sequence, so we will continue to use arrays in the examples
</div>
</section>


<section>
<h2 id="___sec7">Daily interest rate </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> A more relevant model is to add the interest every day</li>

<p><li> The interest rate per day is \( r=p/D \) if \( p \) is the annual interest rate and \( D \) is the number of days in a year</li>

<p><li> A common model in business applies \( D=360 \), but \( n \) counts exact (all) days</li>
</ul>
<p>

Just a minor change in the model:

<p>&nbsp;<br>
$$x_{n} = x_{n-1} + {r\over 100}x_{n-1}$$
<p>&nbsp;<br>

<p>
How can we find the number of days between two dates?

<p>

<!-- code=python (!bc pyshell) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">&gt;&gt;&gt;</span> <span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">datetime</span>
<span style="color: #d0d0d0">&gt;&gt;&gt;</span> <span style="color: #d0d0d0">date1</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">datetime.date(</span><span style="color: #3677a9">2007</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">8</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">3</span><span style="color: #d0d0d0">)</span>  <span style="color: #999999; font-style: italic"># Aug 3, 2007</span>
<span style="color: #d0d0d0">&gt;&gt;&gt;</span> <span style="color: #d0d0d0">date2</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">datetime.date(</span><span style="color: #3677a9">2008</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">8</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">4</span><span style="color: #d0d0d0">)</span>  <span style="color: #999999; font-style: italic"># Aug 4, 2008</span>
<span style="color: #d0d0d0">&gt;&gt;&gt;</span> <span style="color: #d0d0d0">diff</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">date2</span> <span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">date1</span>
<span style="color: #d0d0d0">&gt;&gt;&gt;</span> <span style="color: #6ab825; font-weight: bold">print</span> <span style="color: #d0d0d0">diff.days</span>
<span style="color: #3677a9">367</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec8">Program for daily interest rate </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">from</span> <span style="color: #447fcf; text-decoration: underline">scitools.std</span> <span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #d0d0d0">*</span>
<span style="color: #d0d0d0">x0</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">100</span>                           <span style="color: #999999; font-style: italic"># initial amount</span>
<span style="color: #d0d0d0">p</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">5</span>                              <span style="color: #999999; font-style: italic"># annual interest rate</span>
<span style="color: #d0d0d0">r</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">p/</span><span style="color: #3677a9">360.0</span>                        <span style="color: #999999; font-style: italic"># daily interest rate</span>
<span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">datetime</span>
<span style="color: #d0d0d0">date1</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">datetime.date(</span><span style="color: #3677a9">2007</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">8</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">3</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">date2</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">datetime.date(</span><span style="color: #3677a9">2011</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">8</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">3</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">diff</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">date2</span> <span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">date1</span>
<span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">diff.days</span>
<span style="color: #d0d0d0">index_set</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">range</span><span style="color: #d0d0d0">(N+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">x</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">zeros(</span><span style="color: #24909d">len</span><span style="color: #d0d0d0">(index_set))</span>

<span style="color: #999999; font-style: italic"># Solution:</span>
<span style="color: #d0d0d0">x[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x0</span>
<span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">n</span> <span style="color: #6ab825; font-weight: bold">in</span> <span style="color: #d0d0d0">index_set[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">:]:</span>
    <span style="color: #d0d0d0">x[n]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">(r/</span><span style="color: #3677a9">100.0</span><span style="color: #d0d0d0">)*x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span>
<span style="color: #6ab825; font-weight: bold">print</span> <span style="color: #d0d0d0">x</span>
<span style="color: #d0d0d0">plot(index_set,</span> <span style="color: #d0d0d0">x,</span> <span style="color: #ed9d13">&#39;ro&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">xlabel=</span><span style="color: #ed9d13">&#39;days&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">ylabel=</span><span style="color: #ed9d13">&#39;amount&#39;</span><span style="color: #d0d0d0">)</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec9">But the annual interest rate may change quite often... </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Varying \( p \) means \( p_n \):</b>
<ul>

<p><li> Could not be handled in school (cannot apply \( x_n =x_0(1+\frac{p}{100})^n \))</li>

<p><li> A varying \( p \) causes no problems in the program:
    just fill an array <code>p</code> with correct interest rate for day <code>n</code></li>
</ul>
<p>

Modified program:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">p</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">zeros(</span><span style="color: #24909d">len</span><span style="color: #d0d0d0">(index_set))</span>
<span style="color: #999999; font-style: italic"># fill p[n] for n in index_set (might be non-trivial...)</span>

<span style="color: #d0d0d0">r</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">p/</span><span style="color: #3677a9">360.0</span>                      <span style="color: #999999; font-style: italic"># daily interest rate</span>
<span style="color: #d0d0d0">x</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">zeros(</span><span style="color: #24909d">len</span><span style="color: #d0d0d0">(index_set))</span>

<span style="color: #d0d0d0">x[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x0</span>
<span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">n</span> <span style="color: #6ab825; font-weight: bold">in</span> <span style="color: #d0d0d0">index_set[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">:]:</span>
    <span style="color: #d0d0d0">x[n]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">(r[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]/</span><span style="color: #3677a9">100.0</span><span style="color: #d0d0d0">)*x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec10">Payback of a loan </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> A loan \( L \) is paid back with a fixed amount \( L/N \) every month over \( N \) months + the interest rate of the loan</li>

<p><li> \( p \): annual interest rate, \( p/12: \) monthly rate</li>

<p><li> Let \( x_n \) be the value of the loan at the end of month \( n \)</li>
</ul>
<p>

The fundamental relation from one month to the text:

<p>&nbsp;<br>
$$ x_n = x_{n-1} + {p\over 12\cdot 100}x_{n-1} -
({p\over 12\cdot 100}x_{n-1} + {L\over N})$$
<p>&nbsp;<br>

which simplifies to

<p>&nbsp;<br>
$$ x_n = x_{n-1}  - {L\over N}$$
<p>&nbsp;<br>

<p>
(\( L/N \) makes the equation <em>nonhomogeneous</em>)
</div>
</section>


<section>
<h2 id="___sec11">How to make a living from a fortune with constant consumption </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> We have a fortune \( F \) invested with an annual interest rate of \( p \) percent</li>

<p><li> Every year we plan to consume an amount \( c_n \) (\( n \) counts years)</li>

<p><li> Let \( x_n \) be our fortune at year \( n \)</li>
</ul>
<p>

A fundamental relation from one year to the other is

<p>&nbsp;<br>
$$ x_n = x_{n-1} + {p\over 100}x_{n-1} - c_n $$
<p>&nbsp;<br>

<p>
Simplest possibility: keep \( c_n \) constant, but inflation
demands \( c_n \) to increase...
</div>
</section>


<section>
<h2 id="___sec12">How to make a living from a fortune with inflation-adjusted consumption </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> Assume \( I \) percent inflation per year</li>

<p><li> Start with \( c_0 \) as \( q \) percent of the interest the first year</li>

<p><li> \( c_n \) then develops as money with interest rate \( I \)</li>
</ul>
<p>

\( x_n \) develops with rate \( p \) but with a loss \( c_n \) every year:

<p>&nbsp;<br>
$$
\begin{align*}
x_n &= x_{n-1} + {p\over 100}x_{n-1} - c_{n-1}, \quad x_0=F,\ c_0 = {pq\over 10^4}F\\
c_n &= c_{n-1} + {I\over100}c_{n-1}
\end{align*}
$$
<p>&nbsp;<br>

<p>
This is a coupled system of <em>two</em> difference equations, but the programming
is still simple: we update two arrays, first <code>x[n]</code>, then <code>c[n]</code>, inside the loop
(good exercise!)
</div>
</section>


<section>
<h2 id="___sec13">The mathematics of Fibonacci numbers </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
No programming or math course is complete without an example on Fibonacci numbers:

<p>&nbsp;<br>
$$ x_n = x_{n-1} + x_{n-2},\quad x_0=1,\ x_1=1$$
<p>&nbsp;<br>
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Mathematical classification.</b>
<p>
This is a <em>homogeneous difference equation of second order</em> (second order means three levels: \( n \), \( n-1 \), \( n-2 \)). This classification is important for mathematical solution technique, but not for simulation in a program.
</div>

<p>
<div class="alert alert-block alert-block alert-text-small">
<b></b>
<p>
Fibonacci derived the sequence by modeling rat populations, but the sequence of numbers has a range of peculiar mathematical properties and has therefore attracted much attention from mathematicians.
</div>
</section>


<section>
<h2 id="___sec14">Program for generating Fibonacci numbers </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">int</span><span style="color: #d0d0d0">(sys.argv[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">])</span>
<span style="color: #6ab825; font-weight: bold">from</span> <span style="color: #447fcf; text-decoration: underline">numpy</span> <span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #d0d0d0">zeros</span>
<span style="color: #d0d0d0">x</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">zeros(N+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span> <span style="color: #24909d">int</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">x[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1</span>
<span style="color: #d0d0d0">x[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1</span>
<span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">n</span> <span style="color: #6ab825; font-weight: bold">in</span> <span style="color: #24909d">range</span><span style="color: #d0d0d0">(</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">N+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">):</span>
    <span style="color: #d0d0d0">x[n]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">x[n-</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">]</span>
    <span style="color: #6ab825; font-weight: bold">print</span> <span style="color: #d0d0d0">n,</span> <span style="color: #d0d0d0">x[n]</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec15">Fibonacci numbers can cause overflow in NumPy arrays </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Run the program with \( N=50 \):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #3677a9">2</span> <span style="color: #3677a9">2</span>
<span style="color: #3677a9">3</span> <span style="color: #3677a9">3</span>
<span style="color: #3677a9">4</span> <span style="color: #3677a9">5</span>
<span style="color: #3677a9">5</span> <span style="color: #3677a9">8</span>
<span style="color: #3677a9">6</span> <span style="color: #3677a9">13</span>
<span style="color: #d0d0d0">...</span>
<span style="color: #3677a9">45</span> <span style="color: #3677a9">1836311903</span>
<span style="color: #bbbbbb">Warning</span><span style="color: #d0d0d0">:</span> <span style="color: #d0d0d0">overflow</span> <span style="color: #d0d0d0">encountered</span> <span style="color: #6ab825; font-weight: bold">in</span> <span style="color: #d0d0d0">long_scalars</span>
<span style="color: #3677a9">46</span> <span style="color: #d0d0d0">-</span><span style="color: #3677a9">1323752223</span>
</pre></div>
<p>
Note:

<ul>
 <p><li> Changing <code>int</code> to <code>long</code> or <code>int64</code> for array elements allows \( N\leq 91 \)</li>
 <p><li> Can use <code>float96</code> (though \( x_n \) is integer): \( N \leq 23600 \)</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec16">No overflow when using Python int types </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> Best: use Python scalars of type <code>int</code> - these automatically changes to <code>long</code> when overflow in <code>int</code></li>

<p><li> The <code>long</code> type in Python has arbitrarily many digits (as many as required in a computation!)</li>

<p><li> Note: <code>long</code> for arrays is 64-bit integer (<code>int64</code>), while scalar <code>long</code> in Python is an integer with as &quot;infinitely&quot; many digits</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec17">Program with Python's int type for integers </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The program now avoids arrays and makes use of three <code>int</code> objects (which automatically changes to <code>long</code> when needed):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">sys</span>
<span style="color: #d0d0d0">N</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">int</span><span style="color: #d0d0d0">(sys.argv[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">])</span>
<span style="color: #d0d0d0">xnm1</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1</span>                           <span style="color: #999999; font-style: italic"># &quot;x_n minus 1&quot;</span>
<span style="color: #d0d0d0">xnm2</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">1</span>                           <span style="color: #999999; font-style: italic"># &quot;x_n minus 2&quot;</span>
<span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">2</span>
<span style="color: #6ab825; font-weight: bold">while</span> <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">&lt;=</span> <span style="color: #d0d0d0">N:</span>
    <span style="color: #d0d0d0">xn</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">xnm1</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">xnm2</span>
    <span style="color: #6ab825; font-weight: bold">print</span> <span style="color: #ed9d13">&#39;x_%d = %d&#39;</span> <span style="color: #d0d0d0">%</span> <span style="color: #d0d0d0">(n,</span> <span style="color: #d0d0d0">xn)</span>
    <span style="color: #d0d0d0">xnm2</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">xnm1</span>
    <span style="color: #d0d0d0">xnm1</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">xn</span>
    <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">+=</span> <span style="color: #3677a9">1</span>
</pre></div>
<p>
Run with \( N=200 \):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">x_2</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">2</span>
<span style="color: #d0d0d0">x_3</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">3</span>
<span style="color: #d0d0d0">...</span>
<span style="color: #d0d0d0">x_198</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">173402521172797813159685037284371942044301</span>
<span style="color: #d0d0d0">x_199</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">280571172992510140037611932413038677189525</span>
<span style="color: #d0d0d0">x_200</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">453973694165307953197296969697410619233826</span>
</pre></div>
<p>
Limition: your computer's memory
</div>
</section>


<section>
<h2 id="___sec18">New problem setting: exponential growth with limited environmental resources </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The model for growth of money in a bank has a solution of the type

<p>&nbsp;<br>
$$ x_n = x_0C^n \quad (= x_0e^{n\ln C})$$
<p>&nbsp;<br>

<p>
Note:

<ul>
 <p><li> This is exponential growth in time (\( n \))</li>
 <p><li> Populations of humans, animals, and cells also exhibit the same type of growth as long as there are unlimited resources (space and food)</li>
 <p><li> Most environments can only support a maximum number \( M \) of individuals</li>
 <p><li> How can we model this limitation?</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec19">Modeling growth in an environment with limited resources </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Initially, when there are enough resources, the growth is exponential:

<p>&nbsp;<br>
$$ x_n = x_{n-1} + {r\over 100}x_{n-1}$$
<p>&nbsp;<br>

<p>
The growth rate \( r \) must decay to zero as \( x_n \) approaches \( M \). The simplest
variation of \( r(n) \) is a linear:

<p>&nbsp;<br>
$$   r(n) = \varrho \left(1 - {x_n\over M}\right) $$
<p>&nbsp;<br>

<p>
Observe: \( r(n)\approx \varrho \) for small \( n \) when \( x_n\ll M \), and
\( r(n) \rightarrow 0 \) as \( x_n\rightarrow M \) and \( n \) is big
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Logistic growth model:</b>
<p>&nbsp;<br>
$$ x_n = x_{n-1} + {\varrho\over 100} x_{n-1}\left(1 - {x_{n-1}\over M}\right)$$
<p>&nbsp;<br>

(This is a <em>nonlinear</em> difference equation)
</div>
</section>


<section>
<h2 id="___sec20">The evolution of logistic growth </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
In a program it is easy to introduce logistic instead of exponential growth, just replace

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">x[n]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">p/</span><span style="color: #3677a9">100.0</span><span style="color: #d0d0d0">)*x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span>
</pre></div>
<p>
by

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">x[n]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">(rho/</span><span style="color: #3677a9">100.0</span><span style="color: #d0d0d0">)*x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]*(</span><span style="color: #3677a9">1</span> <span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]/</span><span style="color: #24909d">float</span><span style="color: #d0d0d0">(M))</span>
</pre></div>

</div>

<p>
<center><p><img src="fig-diffeq/logistic_growth1.png" align="bottom" width=400></p></center>
</section>


<section>
<h2 id="___sec21">The factorial as a difference equation </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The factorial \( n! \) is defined as

<p>&nbsp;<br>
$$ n(n-1)(n-2)\cdots 1,\quad 0!=1$$
<p>&nbsp;<br>

<p>
The following difference equation has \( x_n=n! \) as solution and can be used to compute the factorial:

<p>&nbsp;<br>
$$ x_n = nx_{n-1},\quad x_0 = 1 $$
<p>&nbsp;<br>
</div>
</section>


<section>
<h2 id="___sec22">Difference equations must have an initial condition </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>
 <p><li> In mathematics, it is much stressed that a difference equation for
   \( x_n \) must have an initial condition \( x_0 \)</li>
 <p><li> The initial condition is obvious when programming: otherwise we cannot
   start the program (\( x_0 \) is needed to compute \( x_n \))</li>
 <p><li> However: if you forget <code>x[0] = x0</code> in the program, you get \( x_0=0 \)
   (because <code>x = zeroes(N+1)</code>),
   which (usually) gives unintended results!</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec23">Have you ever though about how \( \sin x \) is really calculated? </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>
 <p><li> How can you <em>calculate</em> \( \sin x \), \( \ln x \), \( e^x \) without a calculator
   or program?</li>
 <p><li> These functions were originally defined to have some desired mathematical
   properties, but without an algorithm for how to evaluate function values</li>
 <p><li> Idea: approximate \( \sin x \), etc. by polynomials, since they are easy
   to calculate (sum, multiplication), but how??</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec24">Would you expect these fantastic mathematical results? </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Amazing result by Gregory, 1667:</b>
<p>&nbsp;<br>
$$ \sin x = \sum_{k=0}^\infty (-1)^k\frac{x^{2k+1}}{(2k+1)!}$$
<p>&nbsp;<br>
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Even more amazing result by Taylor, 1715:</b>
<p>&nbsp;<br>
$$ f(x) = \sum_{k=0}^\infty \frac{1}{k!}(\frac{d^k}{dx^k} f(0))x^k $$
<p>&nbsp;<br>

For &quot;any&quot; \( f(x) \), if we can differentiate, add, and multiply \( x^k \),
we can evaluate \( f \) at any \( x \) (!!!)
</div>
</section>


<section>
<h2 id="___sec25">Taylor polynomials </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Practical applications works with a truncated sum:</b>
<p>&nbsp;<br>
$$ f(x) \approx \sum_{k=0}^{{\color{red} N}}
\frac{1}{k!}(\frac{d^k}{dx^k} f(0))x^k $$
<p>&nbsp;<br>

<p>
\( N=1 \) is <em>very</em> popular and has been essential in developing
physics and technology
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Example:</b>
<p>&nbsp;<br>
$$
\begin{align*}
e^x &= \sum_{k=0}^\infty \frac{x^k}{k!}\\
&\approx 1 + x + \frac{1}{2}x^2 + \frac{1}{6}x^3\\
&\approx 1 + x
\end{align*}
$$
<p>&nbsp;<br>
</div>
</section>


<section>
<h2 id="___sec26">Taylor polynomials around an arbitrary point </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The previous Taylor polynomials are most accurate around \( x=0 \). Can
make the polynomials accurate around any point \( x=a \):

<p>&nbsp;<br>
$$ f(x) \approx \sum_{k=0}^N \frac{1}{k!}(\frac{d^k}{dx^k} f(a))(x-a)^k $$
<p>&nbsp;<br>
</div>
</section>


<section>
<h2 id="diffeq:Taylor:exp:1">Taylor polynomial as one difference equation</h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The Taylor series for \( e^x \) around \( x=0 \) reads

<p>&nbsp;<br>
$$  e^x= \sum_{n=0}^\infty {x^n\over n!} $$
<p>&nbsp;<br>

<p>
Define

<p>&nbsp;<br>
$$ e_{n}=\sum_{k=0}^{n-1} \frac{x^k}{k!} =
\sum_{k=0}^{n-2} \frac{x^k}{k!} + \frac{x^{n-1}}{(n-1)!}$$
<p>&nbsp;<br>

<p>
We can formulate the sum in \( e_n \) as the following difference equation:

<p>&nbsp;<br>
$$ e_n = e_{n-1} + \frac{x^{n-1}}{(n-1)!},\quad e_0=0 $$
<p>&nbsp;<br>
</div>
</section>


<section>
<h2 id="___sec28">More efficient computation: the Taylor polynomial as two difference equations </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Observe:

<p>&nbsp;<br>
$$ \frac{x^n}{n!} = \frac{x^{n-1}}{(n-1)!}\cdot \frac{x}{n} $$
<p>&nbsp;<br>

<p>
Let \( a_n = x^n/n! \). Then we can efficiently compute \( a_n \) via

<p>&nbsp;<br>
$$ a_n = a_{n-1}\frac{x}{n},\quad a_0 = 1$$
<p>&nbsp;<br>

<p>
Now we can update each term via the \( a_n \) equation and sum the terms via
the \( e_n \) equation:

<p>&nbsp;<br>
$$
\begin{align*}
e_n &= e_{n-1} + a_{n-1},\quad e_0 = 0,\ a_0 = 1\\
a_n &= \frac{x}{n} a_{n-1}
\end{align*}
$$
<p>&nbsp;<br>

<p>
See the book for more details
</div>
</section>


<section>
<h2 id="___sec29">Nonlinear algebraic equations </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Generic form of any (algebraic) equation in \( x \):</b>
<p>
\[ f(x)=0 \]
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Examples that can be solved by hand:</b>
<p>
          \[ ax + b = 0 \]
          \[ ax^2 + bx + c = 0 \]
          \[ \sin x + \cos x = 1 \]
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> Simple numerical algorithms can solve &quot;any&quot; equation \( f(x)=0 \)</li>

<p><li> Safest: Bisection</li>

<p><li> Fastest: Newton's method</li>

<p><li> Don't like \( f'(x) \) in Newton's method? Use the Secant method</li>

<p><li> Secant and Newton are difference equations!</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec30">Newton's method for finding zeros; illustration </h2>

<p>
<center><p><img src="fig-diffeq/comic_root.png" align="bottom" width=800></p></center>
</section>


<section>
<h2 id="___sec31">Newton's method for finding zeros; mathematics </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Newton's method.</b>
<p>
Simpson (1740) came up with the following general
method for solving \( f(x)=0 \) (based on ideas by Newton):

<p>&nbsp;<br>
$$
x_n = x_{n-1} - {f(x_{n-1})\over f'(x_{n-1})},\quad x_0 \hbox{ given}
$$
<p>&nbsp;<br>

<p>
Note:

<ul>

<p><li> This is a (nonlinear!) difference equation</li>

<p><li> As \( n\rightarrow\infty \), we hope that \( x_n\rightarrow x_s \), where \( x_s \) solves \( f(x_s)=0 \)</li>

<p><li> How to choose \( N \) when what we want is \( x_N \) close to \( x_s \)?</li>

<p><li> Need a slightly different program: simulate until \( f(x)\leq \epsilon \), where \( \epsilon \) is a small tolerance</li>

<p><li> Caution: Newton's method may (easily) diverge, so \( f(x)\leq\epsilon \) may
    never occur!</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec32">A program for Newton's method </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Quick implementation:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">def</span> <span style="color: #447fcf">Newton</span><span style="color: #d0d0d0">(f,</span> <span style="color: #d0d0d0">x,</span> <span style="color: #d0d0d0">dfdx,</span> <span style="color: #d0d0d0">epsilon=</span><span style="color: #3677a9">1.0E-7</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">max_n=</span><span style="color: #3677a9">100</span><span style="color: #d0d0d0">):</span>
    <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span>
    <span style="color: #6ab825; font-weight: bold">while</span> <span style="color: #24909d">abs</span><span style="color: #d0d0d0">(f(x))</span> <span style="color: #d0d0d0">&gt;</span> <span style="color: #d0d0d0">epsilon</span> <span style="color: #6ab825; font-weight: bold">and</span> <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">&lt;=</span> <span style="color: #d0d0d0">max_n:</span>
        <span style="color: #d0d0d0">x</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x</span> <span style="color: #d0d0d0">-</span> <span style="color: #d0d0d0">f(x)/dfdx(x)</span>
        <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">+=</span> <span style="color: #3677a9">1</span>
    <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">x,</span> <span style="color: #d0d0d0">n,</span> <span style="color: #d0d0d0">f(x)</span>
</pre></div>
<p>
Note:

<ul>

<p><li> \( f(x) \) is evaluated twice in each pass of the loop - only one evaluation is strictly necessary (can store the value in a variable and reuse it)</li>

<p><li> <code>f(x)/dfdx(x)</code> can give integer division</li>

<p><li> It could be handy to store the <code>x</code> and <code>f(x)</code> values in each iteration (for plotting or printing a convergence table)</li>
</ul>
</div>
</section>


<section>
<h2 id="___sec33">An improved function for Newton's method </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Only one \( f(x) \) call in each iteration, optional storage of \( (x,f(x)) \) values during the iterations, and ensured float division:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">def</span> <span style="color: #447fcf">Newton</span><span style="color: #d0d0d0">(f,</span> <span style="color: #d0d0d0">x,</span> <span style="color: #d0d0d0">dfdx,</span> <span style="color: #d0d0d0">epsilon=</span><span style="color: #3677a9">1.0E-7</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">max_n=</span><span style="color: #3677a9">100</span><span style="color: #d0d0d0">,</span>
           <span style="color: #d0d0d0">store=</span><span style="color: #24909d">False</span><span style="color: #d0d0d0">):</span>
    <span style="color: #d0d0d0">f_value</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">f(x)</span>
    <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span>
    <span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">store:</span> <span style="color: #d0d0d0">info</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">[(x,</span> <span style="color: #d0d0d0">f_value)]</span>
    <span style="color: #6ab825; font-weight: bold">while</span> <span style="color: #24909d">abs</span><span style="color: #d0d0d0">(f_value)</span> <span style="color: #d0d0d0">&gt;</span> <span style="color: #d0d0d0">epsilon</span> <span style="color: #6ab825; font-weight: bold">and</span> <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">&lt;=</span> <span style="color: #d0d0d0">max_n:</span>
        <span style="color: #d0d0d0">x</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x</span> <span style="color: #d0d0d0">-</span> <span style="color: #24909d">float</span><span style="color: #d0d0d0">(f_value)/dfdx(x)</span>
        <span style="color: #d0d0d0">n</span> <span style="color: #d0d0d0">+=</span> <span style="color: #3677a9">1</span>
        <span style="color: #d0d0d0">f_value</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">f(x)</span>
        <span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">store:</span> <span style="color: #d0d0d0">info.append((x,</span> <span style="color: #d0d0d0">f_value))</span>
    <span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">store:</span>
        <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">x,</span> <span style="color: #d0d0d0">info</span>
    <span style="color: #6ab825; font-weight: bold">else</span><span style="color: #d0d0d0">:</span>
        <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">x,</span> <span style="color: #d0d0d0">n,</span> <span style="color: #d0d0d0">f_value</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec34">Application of Newton's method </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
$$ e^{-0.1x^2}\sin ({\pi\over 2}x) =0\]

Solutions: $x=0, \pm 2, \pm 4, \pm 6, \ldots$
$$
</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Main program:</b>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">from</span> <span style="color: #447fcf; text-decoration: underline">math</span> <span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #d0d0d0">sin,</span> <span style="color: #d0d0d0">cos,</span> <span style="color: #d0d0d0">exp,</span> <span style="color: #d0d0d0">pi</span>
<span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">sys</span>

<span style="color: #6ab825; font-weight: bold">def</span> <span style="color: #447fcf">g</span><span style="color: #d0d0d0">(x):</span>
    <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">exp(-</span><span style="color: #3677a9">0.1</span><span style="color: #d0d0d0">*x**</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">)*sin(pi/</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">*x)</span>

<span style="color: #6ab825; font-weight: bold">def</span> <span style="color: #447fcf">dg</span><span style="color: #d0d0d0">(x):</span>
    <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">-</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">*</span><span style="color: #3677a9">0.1</span><span style="color: #d0d0d0">*x*exp(-</span><span style="color: #3677a9">0.1</span><span style="color: #d0d0d0">*x**</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">)*sin(pi/</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">*x)</span> <span style="color: #d0d0d0">+</span> \
           <span style="color: #d0d0d0">pi/</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">*exp(-</span><span style="color: #3677a9">0.1</span><span style="color: #d0d0d0">*x**</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">)*cos(pi/</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">*x)</span>

<span style="color: #d0d0d0">x0</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">float</span><span style="color: #d0d0d0">(sys.argv[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">])</span>
<span style="color: #d0d0d0">x,</span> <span style="color: #d0d0d0">info</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">Newton(g,</span> <span style="color: #d0d0d0">x0,</span> <span style="color: #d0d0d0">dg,</span> <span style="color: #d0d0d0">store=</span><span style="color: #24909d">True</span><span style="color: #d0d0d0">)</span>
<span style="color: #6ab825; font-weight: bold">print</span> <span style="color: #ed9d13">&#39;Computed zero:&#39;</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">x</span>

<span style="color: #999999; font-style: italic"># Print the evolution of the difference equation</span>
<span style="color: #999999; font-style: italic"># (i.e., the search for the root)</span>
<span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">i</span> <span style="color: #6ab825; font-weight: bold">in</span> <span style="color: #24909d">range</span><span style="color: #d0d0d0">(</span><span style="color: #24909d">len</span><span style="color: #d0d0d0">(info)):</span>
    <span style="color: #6ab825; font-weight: bold">print</span> <span style="color: #ed9d13">&#39;Iteration %3d: f(%g)=%g&#39;</span> <span style="color: #d0d0d0">%</span> <span style="color: #d0d0d0">(i,</span> <span style="color: #d0d0d0">info[i][</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">],</span> <span style="color: #d0d0d0">info[i][</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">])</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec35">Results from this test problem </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
\( x_0=1.7 \) gives quick convergence towards the closest root \( x=0 \):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">zero:</span> <span style="color: #3677a9">1.999999999768449</span>
<span style="color: #d0d0d0">Iteration</span>  <span style="color: #3677a9">0</span><span style="color: #d0d0d0">:</span> <span style="color: #d0d0d0">f(</span><span style="color: #3677a9">1.7</span><span style="color: #d0d0d0">)=</span><span style="color: #3677a9">0.340044</span>
<span style="color: #d0d0d0">Iteration</span>  <span style="color: #3677a9">1</span><span style="color: #d0d0d0">:</span> <span style="color: #d0d0d0">f(</span><span style="color: #3677a9">1.99215</span><span style="color: #d0d0d0">)=</span><span style="color: #3677a9">0.00828786</span>
<span style="color: #d0d0d0">Iteration</span>  <span style="color: #3677a9">2</span><span style="color: #d0d0d0">:</span> <span style="color: #d0d0d0">f(</span><span style="color: #3677a9">1.99998</span><span style="color: #d0d0d0">)=</span><span style="color: #3677a9">2.53347e-05</span>
<span style="color: #d0d0d0">Iteration</span>  <span style="color: #3677a9">3</span><span style="color: #d0d0d0">:</span> <span style="color: #d0d0d0">f(</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">)=</span><span style="color: #3677a9">2.43808e-10</span>
</pre></div>
<p>
Start value \( x_0=3 \) (closest root \( x=2 \) or \( x=4 \)):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">zero:</span> <span style="color: #3677a9">42.49723316011362</span>
<span style="color: #d0d0d0">Iteration</span>  <span style="color: #3677a9">0</span><span style="color: #d0d0d0">:</span> <span style="color: #d0d0d0">f(</span><span style="color: #3677a9">3</span><span style="color: #d0d0d0">)=-</span><span style="color: #3677a9">0.40657</span>
<span style="color: #d0d0d0">Iteration</span>  <span style="color: #3677a9">1</span><span style="color: #d0d0d0">:</span> <span style="color: #d0d0d0">f(</span><span style="color: #3677a9">4.66667</span><span style="color: #d0d0d0">)=</span><span style="color: #3677a9">0.0981146</span>
<span style="color: #d0d0d0">Iteration</span>  <span style="color: #3677a9">2</span><span style="color: #d0d0d0">:</span> <span style="color: #d0d0d0">f(</span><span style="color: #3677a9">42.4972</span><span style="color: #d0d0d0">)=-</span><span style="color: #3677a9">2.59037e-79</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec36">What happened here?? </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Try the demo program <code>src/diffeq/Newton_movie.py</code> with \( x_0=3 \),
\( x\in [-2,50] \) for plotting and numerical approximation of \( f'(x) \):

<p>

<!-- code=text (!bc sys) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">Terminal&gt; python Newton_movie.py &quot;exp(-0.1*x**2)*sin(pi/2*x)&quot; \
          numeric 3 -2 50
</pre></div>

</div>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Lesson learned:</b>
<p>
Newton's method may work fine or give wrong results! You need to understand the method to interpret the results!
</div>
</section>


<section>
<h2 id="___sec37">First step: we're moving to the right (\( x=4 \)?) </h2>

<p>
<center><p><img src="fig-diffeq/Newton_demo_divergence_0000.png" align="bottom" width=600></p></center>
</section>


<section>
<h2 id="___sec38">Second step: oops, too much to the right... </h2>

<p>
<center><p><img src="fig-diffeq/Newton_demo_divergence_0001.png" align="bottom" width=600></p></center>
</section>


<section>
<h2 id="___sec39">Third step: disaster since we're &quot;done&quot; (\( f(x)\approx 0 \)) </h2>

<p>
<center><p><img src="fig-diffeq/Newton_demo_divergence_0002.png" align="bottom" width=600></p></center>
</section>


<section>
<h2 id="___sec40">Programming with sound </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Tones are sine waves:</b>
<p>
A tone <b>A</b> (440 Hz) is a sine wave with frequency 440 Hz:

<p>&nbsp;<br>
$$ s(t) = A\sin\left( 2\pi f t\right),\quad f = 440 $$
<p>&nbsp;<br>

<p>
On a computer we represent \( s(t) \) by a discrete set of points on the function curve (exactly as we do when we plot \( s(t) \)).
CD quality needs 44100 samples per second.
</div>
</section>


<section>
<h2 id="___sec41">Making a sound file with single tone (part 1) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> \( r \): sampling rate (samples per second, default 44100)</li>

<p><li> \( f \): frequency of the tone</li>

<p><li> \( m \): duration of the tone (seconds)</li>
</ul>
<p>

Sampled sine function for this tone:

<p>&nbsp;<br>
$$ s_n =
A\sin\left( 2\pi f {n\over r}\right),
\quad n=0,1,\ldots, m\cdot r
$$
<p>&nbsp;<br>

<p>
Code (we use descriptive names: <code>frequency</code> \( f \), <code>length</code> \( m \), <code>amplitude</code> \( A \), <code>sample_rate</code> \( r \)):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">numpy</span>
<span style="color: #6ab825; font-weight: bold">def</span> <span style="color: #447fcf">note</span><span style="color: #d0d0d0">(frequency,</span> <span style="color: #d0d0d0">length,</span> <span style="color: #d0d0d0">amplitude=</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span>
         <span style="color: #d0d0d0">sample_rate=</span><span style="color: #3677a9">44100</span><span style="color: #d0d0d0">):</span>
    <span style="color: #d0d0d0">time_points</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">numpy.linspace(</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">length,</span>
                                 <span style="color: #d0d0d0">length*sample_rate)</span>
    <span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">numpy.sin(</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">*numpy.pi*frequency*time_points)</span>
    <span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">amplitude*data</span>
    <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">data</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec42">Making a sound file with single tone (part 2) </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> We have <code>data</code> as an array with <code>float</code> and unit amplitude</li>

<p><li> Sound data in a file should have 2-byte integers (<code>int16</code>) as data elements and amplitudes up to \( 2^{15}-1 \) (max value for <code>int16</code> data)</li>
</ul>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">note(</span><span style="color: #3677a9">440</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">2</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data.astype(numpy.int16)</span>
<span style="color: #d0d0d0">max_amplitude</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">2</span><span style="color: #d0d0d0">**</span><span style="color: #3677a9">15</span> <span style="color: #d0d0d0">-</span> <span style="color: #3677a9">1</span>
<span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">max_amplitude*data</span>
<span style="color: #6ab825; font-weight: bold">import</span> <span style="color: #447fcf; text-decoration: underline">scitools.sound</span>
<span style="color: #d0d0d0">scitools.sound.write(data,</span> <span style="color: #ed9d13">&#39;Atone.wav&#39;</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">scitools.sound.play(</span><span style="color: #ed9d13">&#39;Atone.wav&#39;</span><span style="color: #d0d0d0">)</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec43">Reading sound from file </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> Let us read a sound file and add echo</li>

<p><li> Sound = array <code>s[n]</code></li>

<p><li> Echo means to add a delay of the sound</li>
</ul>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #999999; font-style: italic"># echo: e[n] = beta*s[n] + (1-beta)*s[n-b]</span>

<span style="color: #6ab825; font-weight: bold">def</span> <span style="color: #447fcf">add_echo</span><span style="color: #d0d0d0">(data,</span> <span style="color: #d0d0d0">beta=</span><span style="color: #3677a9">0.8</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">delay=</span><span style="color: #3677a9">0.002</span><span style="color: #d0d0d0">,</span>
             <span style="color: #d0d0d0">sample_rate=</span><span style="color: #3677a9">44100</span><span style="color: #d0d0d0">):</span>
    <span style="color: #d0d0d0">newdata</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data.copy()</span>
    <span style="color: #d0d0d0">shift</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">int</span><span style="color: #d0d0d0">(delay*sample_rate)</span>  <span style="color: #999999; font-style: italic"># b (math symbol)</span>
    <span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">i</span> <span style="color: #6ab825; font-weight: bold">in</span> <span style="color: #24909d">xrange</span><span style="color: #d0d0d0">(shift,</span> <span style="color: #24909d">len</span><span style="color: #d0d0d0">(data)):</span>
        <span style="color: #d0d0d0">newdata[i]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">beta*data[i]</span> <span style="color: #d0d0d0">+</span> <span style="color: #d0d0d0">(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">-beta)*data[i-shift]</span>
    <span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #d0d0d0">newdata</span>
</pre></div>
<p>
Load data, add echo and play:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">scitools.sound.read(filename)</span>
<span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data.astype(</span><span style="color: #24909d">float</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">add_echo(data,</span> <span style="color: #d0d0d0">beta=</span><span style="color: #3677a9">0.6</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">data.astype(int16)</span>
<span style="color: #d0d0d0">scitools.sound.play(data)</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec44">Playing many notes </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> Each note is an array of samples from a sine with a frequency corresponding to the note</li>

<p><li> Assume we have several note arrays <code>data1</code>, <code>data2</code>, ...:</li>
</ul>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #999999; font-style: italic"># put data1, data2, ... after each other in a new array:</span>
<span style="color: #d0d0d0">data</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">numpy.concatenate((data1,</span> <span style="color: #d0d0d0">data2,</span> <span style="color: #d0d0d0">data3,</span> <span style="color: #d0d0d0">...))</span>
</pre></div>
<p>
The start of "Nothing Else Matters" (Metallica):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">E1</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">note(</span><span style="color: #3677a9">164.81</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">.</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">G</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">note(</span><span style="color: #3677a9">392</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">.</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">B</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">note(</span><span style="color: #3677a9">493.88</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">.</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">E2</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">note(</span><span style="color: #3677a9">659.26</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">.</span><span style="color: #3677a9">5</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">intro</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">numpy.concatenate((E1,</span> <span style="color: #d0d0d0">G,</span> <span style="color: #d0d0d0">B,</span> <span style="color: #d0d0d0">E2,</span> <span style="color: #d0d0d0">B,</span> <span style="color: #d0d0d0">G))</span>
<span style="color: #d0d0d0">...</span>
<span style="color: #d0d0d0">song</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">numpy.concatenate((intro,</span> <span style="color: #d0d0d0">intro,</span> <span style="color: #d0d0d0">...))</span>
<span style="color: #d0d0d0">scitools.sound.play(song)</span>
<span style="color: #d0d0d0">scitools.sound.write(song,</span> <span style="color: #ed9d13">&#39;tmp.wav&#39;</span><span style="color: #d0d0d0">)</span>
</pre></div>

</div>
</section>


<section>
<h2 id="___sec45">Summary of difference equations </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> Sequence: \( x_0 \), \( x_1 \), \( x_2 \), \( \ldots \), \( x_n \), \( \ldots \), \( x_N \)</li>

<p><li> Difference equation: relation between \( x_n \), \( x_{n-1} \) and maybe \( x_{n-2} \) (or more terms in the "past")  + known start value \( x_0 \) (and more values \( x_1 \), ... if more levels enter the equation)</li>
</ul>
<p>

Solution of difference equations by simulation:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #d0d0d0">index_set</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">&lt;array</span> <span style="color: #d0d0d0">of</span> <span style="color: #d0d0d0">n-values:</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span> <span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span> <span style="color: #d0d0d0">...,</span> <span style="color: #d0d0d0">N&gt;</span>
<span style="color: #d0d0d0">x</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">zeros(N+</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span>
<span style="color: #d0d0d0">x[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">x0</span>
<span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">n</span> <span style="color: #6ab825; font-weight: bold">in</span> <span style="color: #d0d0d0">index_set[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">:]:</span>
    <span style="color: #d0d0d0">x[n]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">&lt;formula</span> <span style="color: #d0d0d0">involving</span> <span style="color: #d0d0d0">x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]&gt;</span>
</pre></div>
<p>
Can have (simple) systems of difference equations:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%"><span style="color: #6ab825; font-weight: bold">for</span> <span style="color: #d0d0d0">n</span> <span style="color: #6ab825; font-weight: bold">in</span> <span style="color: #d0d0d0">index_set[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">:]:</span>
    <span style="color: #d0d0d0">x[n]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">&lt;formula</span> <span style="color: #d0d0d0">involving</span> <span style="color: #d0d0d0">x[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]&gt;</span>
    <span style="color: #d0d0d0">y[n]</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">&lt;formula</span> <span style="color: #d0d0d0">involving</span> <span style="color: #d0d0d0">y[n-</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">]</span> <span style="color: #6ab825; font-weight: bold">and</span> <span style="color: #d0d0d0">x[n]&gt;</span>
</pre></div>
<p>
Taylor series and numerical methods such as Newton's method can be formulated as difference equations, often resulting in a good way of programming the formulas
</div>
</section>


<section>
<h2 id="___sec46">Summarizing example: music of sequences </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>

<p><li> Given a \( x_0 \), \( x_1 \), \( x_2 \), \( \ldots \), \( x_n \), \( \ldots \), \( x_N \)</li>

<p><li> Can we listen to this sequence as "music"?</li>

<p><li> Yes, we just transform the \( x_n \) values to suitable frequencies and use the functions in <code>scitools.sound</code> to generate tones</li>
</ul>
<p>

We will study two sequences:

<p>&nbsp;<br>
$$ x_n = e^{-4n/N}\sin(8\pi n/N)$$
<p>&nbsp;<br>

and

<p>&nbsp;<br>
$$ x_n = x_{n-1} + q x_{n-1}\left(1 - x_{n-1}\right),\quad x = x_0 $$
<p>&nbsp;<br>

<p>
The first has values in \( [-1,1] \), the other from \( x_0=0.01 \) up to around 1

<p>
Transformation from "unit" \( x_n \) to frequencies:

<p>&nbsp;<br>
$$ y_n = 440 + 200 x_n $$
<p>&nbsp;<br>

(first sequence then gives tones between 240 Hz and 640 Hz)


</div>
</section>


<section>
<h2 id="___sec47">Module file: soundeq.py </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<ul>
 <p><li> Three functions: two for generating sequences, one for the sound</li>
 <p><li> Look at <code>files/soundeq.py</code> for complete code</li>
</ul>
<p>

Try it out in these examples:

<p>

<!-- code=text (!bc sys) typeset with pygments style "native" -->
<div class="highlight" style="background: #202020"><pre style="font-size: 110%; font-size: 80%; line-height: 125%">Terminal&gt; python soundseq.py oscillations 40
Terminal&gt; python soundseq.py logistic 100
</pre></div>
<p>
Try to change the frequency range from 200 to 400.
</div>
</section>



</div> <!-- class="slides" -->
</div> <!-- class="reveal" -->

<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.min.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

    // Display navigation controls in the bottom right corner
    controls: true,

    // Display progress bar (below the horiz. slider)
    progress: true,

    // Display the page number of the current slide
    slideNumber: true,

    // Push each slide change to the browser history
    history: false,

    // Enable keyboard shortcuts for navigation
    keyboard: true,

    // Enable the slide overview mode
    overview: true,

    // Vertical centering of slides
    //center: true,
    center: false,

    // Enables touch navigation on devices with touch input
    touch: true,

    // Loop the presentation
    loop: false,

    // Change the presentation direction to be RTL
    rtl: false,

    // Turns fragments on and off globally
    fragments: true,

    // Flags if the presentation is running in an embedded mode,
    // i.e. contained within a limited portion of the screen
    embedded: false,

    // Number of milliseconds between automatically proceeding to the
    // next slide, disabled when set to 0, this value can be overwritten
    // by using a data-autoslide attribute on your slides
    autoSlide: 0,

    // Stop auto-sliding after user input
    autoSlideStoppable: true,

    // Enable slide navigation via mouse wheel
    mouseWheel: false,

    // Hides the address bar on mobile devices
    hideAddressBar: true,

    // Opens links in an iframe preview overlay
    previewLinks: false,

    // Transition style
    transition: 'default', // default/cube/page/concave/zoom/linear/fade/none

    // Transition speed
    transitionSpeed: 'default', // default/fast/slow

    // Transition style for full page slide backgrounds
    backgroundTransition: 'default', // default/none/slide/concave/convex/zoom

    // Number of slides away from the current that are visible
    viewDistance: 3,

    // Parallax background image
    //parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

    // Parallax background size
    //parallaxBackgroundSize: '' // CSS syntax, e.g. "2100px 900px"

    theme: Reveal.getQueryHash().theme, // available themes are in reveal.js/css/theme
    transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/none

});

Reveal.initialize({
    dependencies: [
        // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
        { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },

        // Interpret Markdown in <section> elements
        { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },

        // Syntax highlight for <code> elements
        { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },

        // Zoom in and out with Alt+click
        { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },

        // Speaker notes
        { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },

        // Remote control your reveal.js presentation using a touch device
        //{ src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } },

        // MathJax
        //{ src: 'reveal.js/plugin/math/math.js', async: true }
    ]
});

Reveal.initialize({

    // The "normal" size of the presentation, aspect ratio will be preserved
    // when the presentation is scaled to fit different resolutions. Can be
    // specified using percentage units.
    width: 1170,  // original: 960,
    height: 700,

    // Factor of the display size that should remain empty around the content
    margin: 0.1,

    // Bounds for smallest/largest possible scale to apply to content
    minScale: 0.2,
    maxScale: 1.0

});
</script>

<!-- begin footer logo
<div style="position: absolute; bottom: 0px; left: 0; margin-left: 0px">
<img src="somelogo.png">
</div>
     end footer logo -->



</body>
</html>
